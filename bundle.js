!function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=48)}([function(t,e,n){"use strict";function i(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}n.d(e,"a",function(){return i});var r=n(2),o=n(5),a=n(14);Object.assign(i.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t=new a.a;return function(e){return!1===(e&&e.isEuler)&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(t.setFromEuler(e))}}(),applyAxisAngle:function(){var t=new a.a;return function(e,n){return this.applyQuaternion(t.setFromAxisAngle(e,n))}}(),applyMatrix3:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;this.x=r[0]*e+r[4]*n+r[8]*i+r[12],this.y=r[1]*e+r[5]*n+r[9]*i+r[13],this.z=r[2]*e+r[6]*n+r[10]*i+r[14];var o=r[3]*e+r[7]*n+r[11]*i+r[15];return this.divideScalar(o)},applyQuaternion:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,o=t.y,a=t.z,s=t.w,l=s*e+o*i-a*n,u=s*n+a*e-r*i,h=s*i+r*n-o*e,c=-r*e-o*n-a*i;return this.x=l*s+c*-r+u*-a-h*-o,this.y=u*s+c*-o+h*-r-l*-a,this.z=h*s+c*-a+l*-o-u*-r,this},project:function(){var t=new o.a;return function(e){return t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyMatrix4(t)}}(),unproject:function(){var t=new o.a;return function(e){return t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyMatrix4(t)}}(),transformDirection:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i,this.y=r[1]*e+r[5]*n+r[9]*i,this.z=r[2]*e+r[6]*n+r[10]*i,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t=new i,e=new i;return function(n,i){return t.set(n,n,n),e.set(i,i,i),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,n))/n)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){if(void 0!==e)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e);var n=this.x,i=this.y,r=this.z;return this.x=i*t.z-r*t.y,this.y=r*t.x-n*t.z,this.z=n*t.y-i*t.x,this},crossVectors:function(t,e){var n=t.x,i=t.y,r=t.z,o=e.x,a=e.y,s=e.z;return this.x=i*s-r*a,this.y=r*o-n*s,this.z=n*a-i*o,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:function(){var t=new i;return function(e){return t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t=new i;return function(e){return this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(r.a.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i},distanceToManhattan:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromCylindrical:function(t){return this.x=t.radius*Math.sin(t.theta),this.y=t.y,this.z=t.radius*Math.cos(t.theta),this},setFromMatrixPosition:function(t){return this.setFromMatrixColumn(t,3)},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}})},function(t,e,n){"use strict";n.d(e,"n",function(){return i}),n.d(e,"_55",function(){return r}),n.d(e,"_49",function(){return o}),n.d(e,"_56",function(){return a}),n.d(e,"u",function(){return s}),n.d(e,"_21",function(){return l}),n.d(e,"_34",function(){return u}),n.d(e,"d",function(){return h}),n.d(e,"l",function(){return c}),n.d(e,"m",function(){return d}),n.d(e,"p",function(){return f}),n.d(e,"e",function(){return p}),n.d(e,"f",function(){return m}),n.d(e,"a",function(){return v}),n.d(e,"_50",function(){return g}),n.d(e,"c",function(){return y}),n.d(e,"_51",function(){return _}),n.d(e,"_52",function(){return x}),n.d(e,"_53",function(){return b}),n.d(e,"_54",function(){return w}),n.d(e,"i",function(){return E}),n.d(e,"U",function(){return P}),n.d(e,"V",function(){return M}),n.d(e,"_14",function(){return S}),n.d(e,"_15",function(){return T}),n.d(e,"W",function(){return C}),n.d(e,"X",function(){return L}),n.d(e,"Y",function(){return A}),n.d(e,"Z",function(){return I}),n.d(e,"g",function(){return N}),n.d(e,"h",function(){return R}),n.d(e,"_0",function(){return D}),n.d(e,"_1",function(){return O}),n.d(e,"_2",function(){return U}),n.d(e,"_3",function(){return F}),n.d(e,"_4",function(){return B}),n.d(e,"_42",function(){return z}),n.d(e,"_43",function(){return X}),n.d(e,"_44",function(){return k}),n.d(e,"j",function(){return G}),n.d(e,"_45",function(){return V}),n.d(e,"_46",function(){return Y}),n.d(e,"_47",function(){return H}),n.d(e,"_48",function(){return W}),n.d(e,"b",function(){return j}),n.d(e,"_39",function(){return q}),n.d(e,"_40",function(){return J}),n.d(e,"_41",function(){return Z}),n.d(e,"o",function(){return Q}),n.d(e,"_31",function(){return K}),n.d(e,"_32",function(){return $}),n.d(e,"_33",function(){return tt}),n.d(e,"_18",function(){return et}),n.d(e,"_19",function(){return nt}),n.d(e,"_35",function(){return it}),n.d(e,"_36",function(){return rt}),n.d(e,"_37",function(){return ot}),n.d(e,"_38",function(){return at}),n.d(e,"_24",function(){return st}),n.d(e,"_25",function(){return lt}),n.d(e,"x",function(){return ut}),n.d(e,"y",function(){return ht}),n.d(e,"z",function(){return ct}),n.d(e,"A",function(){return dt}),n.d(e,"B",function(){return ft}),n.d(e,"C",function(){return pt}),n.d(e,"D",function(){return mt}),n.d(e,"E",function(){return vt}),n.d(e,"F",function(){return gt}),n.d(e,"v",function(){return yt}),n.d(e,"J",function(){return _t}),n.d(e,"K",function(){return xt}),n.d(e,"L",function(){return bt}),n.d(e,"M",function(){return wt}),n.d(e,"N",function(){return Et}),n.d(e,"t",function(){return Pt}),n.d(e,"w",function(){return Mt}),n.d(e,"G",function(){return St}),n.d(e,"H",function(){return Tt}),n.d(e,"I",function(){return Ct}),n.d(e,"_16",function(){return Lt}),n.d(e,"O",function(){return At}),n.d(e,"P",function(){return It}),n.d(e,"s",function(){return Nt}),n.d(e,"Q",function(){return Rt}),n.d(e,"R",function(){return Dt}),n.d(e,"S",function(){return Ot}),n.d(e,"T",function(){return Ut}),n.d(e,"_5",function(){return Ft}),n.d(e,"_6",function(){return Bt}),n.d(e,"_7",function(){return zt}),n.d(e,"_8",function(){return Xt}),n.d(e,"_9",function(){return kt}),n.d(e,"_10",function(){return Gt}),n.d(e,"_11",function(){return Vt}),n.d(e,"_12",function(){return Yt}),n.d(e,"_13",function(){return Ht}),n.d(e,"k",function(){return Wt}),n.d(e,"q",function(){return jt}),n.d(e,"r",function(){return qt}),n.d(e,"_17",function(){return Jt}),n.d(e,"_26",function(){return Zt}),n.d(e,"_23",function(){return Qt}),n.d(e,"_27",function(){return Kt}),n.d(e,"_28",function(){return $t}),n.d(e,"_29",function(){return te}),n.d(e,"_30",function(){return ee}),n.d(e,"_22",function(){return ne}),n.d(e,"_20",function(){return ie});var i="85",r=0,o=1,a=2,s=0,l=1,u=2,h=0,c=1,d=2,f=1,p=2,m=0,v=2,g=0,y=1,_=2,x=3,b=4,w=5,E=100,P=101,M=102,S=103,T=104,C=200,L=201,A=202,I=203,N=204,R=205,D=206,O=207,U=208,F=209,B=210,z=0,X=1,k=2,G=3,V=4,Y=5,H=6,W=7,j=0,q=1,J=2,Z=0,Q=1,K=2,$=3,tt=4,et=300,nt=301,it=302,rt=303,ot=304,at=305,st=306,lt=307,ut=1e3,ht=1001,ct=1002,dt=1003,ft=1004,pt=1005,mt=1006,vt=1007,gt=1008,yt=1009,_t=1010,xt=1011,bt=1012,wt=1013,Et=1014,Pt=1015,Mt=1016,St=1017,Tt=1018,Ct=1019,Lt=1020,At=1021,It=1022,Nt=1023,Rt=1024,Dt=1025,Ot=1026,Ut=1027,Ft=2001,Bt=2002,zt=2003,Xt=2004,kt=2100,Gt=2101,Vt=2102,Yt=2103,Ht=2151,Wt=0,jt=1,qt=2,Jt=3e3,Zt=3001,Qt=3007,Kt=3002,$t=3004,te=3005,ee=3006,ne=3200,ie=3201},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=new Array(36),i=0;return function(){for(var r=0;r<36;r++)8===r||13===r||18===r||23===r?n[r]="-":14===r?n[r]="4":(i<=2&&(i=33554432+16777216*Math.random()|0),t=15&i,i>>=4,n[r]=e[19===r?3&t|8:t]);return n.join("")}}(),clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*i.DEG2RAD},radToDeg:function(t){return t*i.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},nearestPowerOfTwo:function(t){return Math.pow(2,Math.round(Math.log(t)/Math.LN2))},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}}},function(t,e,n){"use strict";function i(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}n.d(e,"a",function(){return i});var r=n(2),o={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object.assign(i.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(){function t(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}return function(e,n,i){if(e=r.a.euclideanModulo(e,1),n=r.a.clamp(n,0,1),i=r.a.clamp(i,0,1),0===n)this.r=this.g=this.b=i;else{var o=i<=.5?i*(1+n):i+n-i*n,a=2*i-o;this.r=t(a,o,e+1/3),this.g=t(a,o,e),this.b=t(a,o,e-1/3)}return this}}(),setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var i,r=n[1],a=n[2];switch(r){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,e(i[5]),this;if(i=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,e(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var s=parseFloat(i[1])/360,l=parseInt(i[2],10)/100,u=parseInt(i[3],10)/100;return e(i[5]),this.setHSL(s,l,u)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var h=n[1],c=h.length;if(3===c)return this.r=parseInt(h.charAt(0)+h.charAt(0),16)/255,this.g=parseInt(h.charAt(1)+h.charAt(1),16)/255,this.b=parseInt(h.charAt(2)+h.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(h.charAt(0)+h.charAt(1),16)/255,this.g=parseInt(h.charAt(2)+h.charAt(3),16)/255,this.b=parseInt(h.charAt(4)+h.charAt(5),16)/255,this}if(t&&t.length>0){var h=o[t];void 0!==h?this.setHex(h):console.warn("THREE.Color: Unknown color "+t)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(){var t=this.r,e=this.g,n=this.b;return this.r=t*t,this.g=e*e,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){var e,n,i=t||{h:0,s:0,l:0},r=this.r,o=this.g,a=this.b,s=Math.max(r,o,a),l=Math.min(r,o,a),u=(l+s)/2;if(l===s)e=0,n=0;else{var h=s-l;switch(n=u<=.5?h/(s+l):h/(2-s-l),s){case r:e=(o-a)/h+(o<a?6:0);break;case o:e=(a-r)/h+2;break;case a:e=(r-o)/h+4}e/=6}return i.h=e,i.s=n,i.l=u,i},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){var i=this.getHSL();return i.h+=t,i.s+=e,i.l+=n,this.setHSL(i.h,i.s,i.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}})},function(t,e,n){"use strict";function i(t,e){this.x=t||0,this.y=e||0}n.d(e,"a",function(){return i}),Object.defineProperties(i.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(i.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(){var t=new i,e=new i;return function(n,i){return t.set(n,n),e.set(i,i),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,n))/n)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},distanceToManhattan:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,o=this.y-t.y;return this.x=r*n-o*i+t.x,this.y=r*i+o*n+t.y,this}})},function(t,e,n){"use strict";function i(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}n.d(e,"a",function(){return i});var r=n(0);Object.assign(i.prototype,{isMatrix4:!0,set:function(t,e,n,i,r,o,a,s,l,u,h,c,d,f,p,m){var v=this.elements;return v[0]=t,v[4]=e,v[8]=n,v[12]=i,v[1]=r,v[5]=o,v[9]=a,v[13]=s,v[2]=l,v[6]=u,v[10]=h,v[14]=c,v[3]=d,v[7]=f,v[11]=p,v[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new i).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(){var t=new r.a;return function(e){var n=this.elements,i=e.elements,r=1/t.setFromMatrixColumn(e,0).length(),o=1/t.setFromMatrixColumn(e,1).length(),a=1/t.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[4]=i[4]*o,n[5]=i[5]*o,n[6]=i[6]*o,n[8]=i[8]*a,n[9]=i[9]*a,n[10]=i[10]*a,this}}(),makeRotationFromEuler:function(t){!1===(t&&t.isEuler)&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,i=t.y,r=t.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(i),l=Math.sin(i),u=Math.cos(r),h=Math.sin(r);if("XYZ"===t.order){var c=o*u,d=o*h,f=a*u,p=a*h;e[0]=s*u,e[4]=-s*h,e[8]=l,e[1]=d+f*l,e[5]=c-p*l,e[9]=-a*s,e[2]=p-c*l,e[6]=f+d*l,e[10]=o*s}else if("YXZ"===t.order){var m=s*u,v=s*h,g=l*u,y=l*h;e[0]=m+y*a,e[4]=g*a-v,e[8]=o*l,e[1]=o*h,e[5]=o*u,e[9]=-a,e[2]=v*a-g,e[6]=y+m*a,e[10]=o*s}else if("ZXY"===t.order){var m=s*u,v=s*h,g=l*u,y=l*h;e[0]=m-y*a,e[4]=-o*h,e[8]=g+v*a,e[1]=v+g*a,e[5]=o*u,e[9]=y-m*a,e[2]=-o*l,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){var c=o*u,d=o*h,f=a*u,p=a*h;e[0]=s*u,e[4]=f*l-d,e[8]=c*l+p,e[1]=s*h,e[5]=p*l+c,e[9]=d*l-f,e[2]=-l,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){var _=o*s,x=o*l,b=a*s,w=a*l;e[0]=s*u,e[4]=w-_*h,e[8]=b*h+x,e[1]=h,e[5]=o*u,e[9]=-a*u,e[2]=-l*u,e[6]=x*h+b,e[10]=_-w*h}else if("XZY"===t.order){var _=o*s,x=o*l,b=a*s,w=a*l;e[0]=s*u,e[4]=-h,e[8]=l*u,e[1]=_*h+w,e[5]=o*u,e[9]=x*h-b,e[2]=b*h-x,e[6]=a*u,e[10]=w*h+_}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,n=t._x,i=t._y,r=t._z,o=t._w,a=n+n,s=i+i,l=r+r,u=n*a,h=n*s,c=n*l,d=i*s,f=i*l,p=r*l,m=o*a,v=o*s,g=o*l;return e[0]=1-(d+p),e[4]=h-g,e[8]=c+v,e[1]=h+g,e[5]=1-(u+p),e[9]=f-m,e[2]=c-v,e[6]=f+m,e[10]=1-(u+d),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t=new r.a,e=new r.a,n=new r.a;return function(i,r,o){var a=this.elements;return n.subVectors(i,r),0===n.lengthSq()&&(n.z=1),n.normalize(),t.crossVectors(o,n),0===t.lengthSq()&&(n.z+=1e-4,t.crossVectors(o,n)),t.normalize(),e.crossVectors(n,t),a[0]=t.x,a[4]=e.x,a[8]=n.x,a[1]=t.y,a[5]=e.y,a[9]=n.y,a[2]=t.z,a[6]=e.z,a[10]=n.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,i=e.elements,r=this.elements,o=n[0],a=n[4],s=n[8],l=n[12],u=n[1],h=n[5],c=n[9],d=n[13],f=n[2],p=n[6],m=n[10],v=n[14],g=n[3],y=n[7],_=n[11],x=n[15],b=i[0],w=i[4],E=i[8],P=i[12],M=i[1],S=i[5],T=i[9],C=i[13],L=i[2],A=i[6],I=i[10],N=i[14],R=i[3],D=i[7],O=i[11],U=i[15];return r[0]=o*b+a*M+s*L+l*R,r[4]=o*w+a*S+s*A+l*D,r[8]=o*E+a*T+s*I+l*O,r[12]=o*P+a*C+s*N+l*U,r[1]=u*b+h*M+c*L+d*R,r[5]=u*w+h*S+c*A+d*D,r[9]=u*E+h*T+c*I+d*O,r[13]=u*P+h*C+c*N+d*U,r[2]=f*b+p*M+m*L+v*R,r[6]=f*w+p*S+m*A+v*D,r[10]=f*E+p*T+m*I+v*O,r[14]=f*P+p*C+m*N+v*U,r[3]=g*b+y*M+_*L+x*R,r[7]=g*w+y*S+_*A+x*D,r[11]=g*E+y*T+_*I+x*O,r[15]=g*P+y*C+_*N+x*U,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:function(){var t=new r.a;return function(e){for(var n=0,i=e.count;n<i;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix4(this),e.setXYZ(n,t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],o=t[1],a=t[5],s=t[9],l=t[13],u=t[2],h=t[6],c=t[10],d=t[14];return t[3]*(+r*s*h-i*l*h-r*a*c+n*l*c+i*a*d-n*s*d)+t[7]*(+e*s*d-e*l*c+r*o*c-i*o*d+i*l*u-r*s*u)+t[11]*(+e*l*h-e*a*d-r*o*h+n*o*d+r*a*u-n*l*u)+t[15]*(-i*a*u-e*s*h+e*a*c+i*o*h-n*o*c+n*s*u)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var n=this.elements,i=t.elements,r=i[0],o=i[1],a=i[2],s=i[3],l=i[4],u=i[5],h=i[6],c=i[7],d=i[8],f=i[9],p=i[10],m=i[11],v=i[12],g=i[13],y=i[14],_=i[15],x=f*y*c-g*p*c+g*h*m-u*y*m-f*h*_+u*p*_,b=v*p*c-d*y*c-v*h*m+l*y*m+d*h*_-l*p*_,w=d*g*c-v*f*c+v*u*m-l*g*m-d*u*_+l*f*_,E=v*f*h-d*g*h-v*u*p+l*g*p+d*u*y-l*f*y,P=r*x+o*b+a*w+s*E;if(0===P){var M="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(!0===e)throw new Error(M);return console.warn(M),this.identity()}var S=1/P;return n[0]=x*S,n[1]=(g*p*s-f*y*s-g*a*m+o*y*m+f*a*_-o*p*_)*S,n[2]=(u*y*s-g*h*s+g*a*c-o*y*c-u*a*_+o*h*_)*S,n[3]=(f*h*s-u*p*s-f*a*c+o*p*c+u*a*m-o*h*m)*S,n[4]=b*S,n[5]=(d*y*s-v*p*s+v*a*m-r*y*m-d*a*_+r*p*_)*S,n[6]=(v*h*s-l*y*s-v*a*c+r*y*c+l*a*_-r*h*_)*S,n[7]=(l*p*s-d*h*s+d*a*c-r*p*c-l*a*m+r*h*m)*S,n[8]=w*S,n[9]=(v*f*s-d*g*s-v*o*m+r*g*m+d*o*_-r*f*_)*S,n[10]=(l*g*s-v*u*s+v*o*c-r*g*c-l*o*_+r*u*_)*S,n[11]=(d*u*s-l*f*s-d*o*c+r*f*c+l*o*m-r*u*m)*S,n[12]=E*S,n[13]=(d*g*a-v*f*a+v*o*p-r*g*p-d*o*y+r*f*y)*S,n[14]=(v*u*a-l*g*a-v*o*h+r*g*h+l*o*y-r*u*y)*S,n[15]=(l*f*a-d*u*a+d*o*h-r*f*h-l*o*p+r*u*p)*S,this},scale:function(t){var e=this.elements,n=t.x,i=t.y,r=t.z;return e[0]*=n,e[4]*=i,e[8]*=r,e[1]*=n,e[5]*=i,e[9]*=r,e[2]*=n,e[6]*=i,e[10]*=r,e[3]*=n,e[7]*=i,e[11]*=r,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=1-n,o=t.x,a=t.y,s=t.z,l=r*o,u=r*a;return this.set(l*o+n,l*a-i*s,l*s+i*a,0,l*a+i*s,u*a+n,u*s-i*o,0,l*s-i*a,u*s+i*o,r*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){return this.makeRotationFromQuaternion(e),this.scale(n),this.setPosition(t),this},decompose:function(){var t=new r.a,e=new i;return function(n,i,r){var o=this.elements,a=t.set(o[0],o[1],o[2]).length(),s=t.set(o[4],o[5],o[6]).length(),l=t.set(o[8],o[9],o[10]).length();this.determinant()<0&&(a=-a),n.x=o[12],n.y=o[13],n.z=o[14],e.copy(this);var u=1/a,h=1/s,c=1/l;return e.elements[0]*=u,e.elements[1]*=u,e.elements[2]*=u,e.elements[4]*=h,e.elements[5]*=h,e.elements[6]*=h,e.elements[8]*=c,e.elements[9]*=c,e.elements[10]*=c,i.setFromRotationMatrix(e),r.x=a,r.y=s,r.z=l,this}}(),makePerspective:function(t,e,n,i,r,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*r/(e-t),l=2*r/(n-i),u=(e+t)/(e-t),h=(n+i)/(n-i),c=-(o+r)/(o-r),d=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=l,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=c,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,e,n,i,r,o){var a=this.elements,s=1/(e-t),l=1/(n-i),u=1/(o-r),h=(e+t)*s,c=(n+i)*l,d=(o+r)*u;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-c,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,i=0;i<16;i++)if(e[i]!==n[i])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}})},function(t,e,n){"use strict";function i(){function t(){f.setFromEuler(s,!1)}function e(){s.setFromQuaternion(f,void 0,!1)}Object.defineProperty(this,"id",{value:d++}),this.uuid=c.a.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=i.DefaultUp.clone();var n=new o.a,s=new l.a,f=new r.a,p=new o.a(1,1,1);s.onChange(t),f.onChange(e),Object.defineProperties(this,{position:{enumerable:!0,value:n},rotation:{enumerable:!0,value:s},quaternion:{enumerable:!0,value:f},scale:{enumerable:!0,value:p},modelViewMatrix:{value:new a.a},normalMatrix:{value:new h.a}}),this.matrix=new a.a,this.matrixWorld=new a.a,this.matrixAutoUpdate=i.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new u.a,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={},this.onBeforeRender=function(){},this.onAfterRender=function(){}}n.d(e,"a",function(){return i});var r=n(14),o=n(0),a=n(5),s=n(8),l=n(185),u=n(175),h=n(13),c=n(2),d=0;i.DefaultUp=new o.a(0,1,0),i.DefaultMatrixAutoUpdate=!0,Object.assign(i.prototype,s.a.prototype,{isObject3D:!0,applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new r.a;return function(e,n){return t.setFromAxisAngle(e,n),this.quaternion.multiply(t),this}}(),rotateX:function(){var t=new o.a(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new o.a(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new o.a(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new o.a;return function(e,n){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(n)),this}}(),translateX:function(){var t=new o.a(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new o.a(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new o.a(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new a.a;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new a.a;return function(e){this.isCamera?t.lookAt(this.position,e,this.up):t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);var n=this.children.indexOf(t);-1!==n&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(n,1))},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,i=this.children.length;n<i;n++){var r=this.children[n],o=r.getObjectByProperty(t,e);if(void 0!==o)return o}},getWorldPosition:function(t){var e=t||new o.a;return this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new o.a,e=new o.a;return function(n){var i=n||new r.a;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,i,e),i}}(),getWorldRotation:function(){var t=new r.a;return function(e){var n=e||new l.a;return this.getWorldQuaternion(t),n.setFromQuaternion(t,this.rotation.order,!1)}}(),getWorldScale:function(){var t=new o.a,e=new r.a;return function(n){var i=n||new o.a;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,i),i}}(),getWorldDirection:function(){var t=new r.a;return function(e){var n=e||new o.a;return this.getWorldQuaternion(t),n.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].updateMatrixWorld(t)},toJSON:function(t){function e(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}function n(t){var e=[];for(var n in t){var i=t[n];delete i.metadata,e.push(i)}return e}var i=void 0===t||""===t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var o={};if(o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),"{}"!==JSON.stringify(this.userData)&&(o.userData=this.userData),!0===this.castShadow&&(o.castShadow=!0),!0===this.receiveShadow&&(o.receiveShadow=!0),!1===this.visible&&(o.visible=!1),o.matrix=this.matrix.toArray(),void 0!==this.geometry&&(o.geometry=e(t.geometries,this.geometry)),void 0!==this.material)if(Array.isArray(this.material)){for(var a=[],s=0,l=this.material.length;s<l;s++)a.push(e(t.materials,this.material[s]));o.material=a}else o.material=e(t.materials,this.material);if(this.children.length>0){o.children=[];for(var s=0;s<this.children.length;s++)o.children.push(this.children[s].toJSON(t).object)}if(i){var u=n(t.geometries),h=n(t.materials),c=n(t.textures),d=n(t.images);u.length>0&&(r.geometries=u),h.length>0&&(r.materials=h),c.length>0&&(r.textures=c),d.length>0&&(r.images=d)}return r.object=o,r},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var i=t.children[n];this.add(i.clone())}return this}})},function(t,e,n){"use strict";function i(){Object.defineProperty(this,"id",{value:n.i(m.a)()}),this.uuid=f.a.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}n.d(e,"a",function(){return i});var r=n(0),o=n(19),a=n(8),s=n(12),l=n(10),u=n(174),h=n(6),c=n(5),d=n(13),f=n(2),p=n(41),m=n(18);i.MaxIndex=65535,Object.assign(i.prototype,a.a.prototype,{isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(n.i(p.a)(t)>65535?s.b:s.c)(t,1):this.index=t},addAttribute:function(t,e){return!1===(e&&e.isBufferAttribute)&&!1===(e&&e.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(t,new s.d(arguments[1],arguments[2]))):"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(e)):(this.attributes[t]=e,this)},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToBufferAttribute(e),e.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){(new d.a).getNormalMatrix(t).applyToBufferAttribute(n),n.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t=new c.a;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new c.a;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new c.a;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new c.a;return function(e,n,i){return t.makeTranslation(e,n,i),this.applyMatrix(t),this}}(),scale:function(){var t=new c.a;return function(e,n,i){return t.makeScale(e,n,i),this.applyMatrix(t),this}}(),lookAt:function(){var t=new h.a;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var n=new s.a(3*e.vertices.length,3),i=new s.a(3*e.colors.length,3);if(this.addAttribute("position",n.copyVector3sArray(e.vertices)),this.addAttribute("color",i.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var r=new s.a(e.lineDistances.length,1);this.addAttribute("lineDistance",r.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},updateFromObject:function(t){var e=t.geometry;if(t.isMesh){var n=e.__directGeometry;if(!0===e.elementsNeedUpdate&&(n=void 0,e.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(e);n.verticesNeedUpdate=e.verticesNeedUpdate,n.normalsNeedUpdate=e.normalsNeedUpdate,n.colorsNeedUpdate=e.colorsNeedUpdate,n.uvsNeedUpdate=e.uvsNeedUpdate,n.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=n}var i;return!0===e.verticesNeedUpdate&&(i=this.attributes.position,void 0!==i&&(i.copyVector3sArray(e.vertices),i.needsUpdate=!0),e.verticesNeedUpdate=!1),!0===e.normalsNeedUpdate&&(i=this.attributes.normal,void 0!==i&&(i.copyVector3sArray(e.normals),i.needsUpdate=!0),e.normalsNeedUpdate=!1),!0===e.colorsNeedUpdate&&(i=this.attributes.color,void 0!==i&&(i.copyColorsArray(e.colors),i.needsUpdate=!0),e.colorsNeedUpdate=!1),e.uvsNeedUpdate&&(i=this.attributes.uv,void 0!==i&&(i.copyVector2sArray(e.uvs),i.needsUpdate=!0),e.uvsNeedUpdate=!1),e.lineDistancesNeedUpdate&&(i=this.attributes.lineDistance,void 0!==i&&(i.copyArray(e.lineDistances),i.needsUpdate=!0),e.lineDistancesNeedUpdate=!1),e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new u.a).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new s.d(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var i=new Float32Array(3*t.normals.length);this.addAttribute("normal",new s.d(i,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var r=new Float32Array(3*t.colors.length);this.addAttribute("color",new s.d(r,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var o=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new s.d(o,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var a=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new s.d(a,2).copyVector2sArray(t.uvs2))}if(t.indices.length>0){var l=n.i(p.a)(t.indices)>65535?Uint32Array:Uint16Array,u=new l(3*t.indices.length);this.setIndex(new s.d(u,1).copyIndicesArray(t.indices))}this.groups=t.groups;for(var h in t.morphTargets){for(var c=[],d=t.morphTargets[h],f=0,m=d.length;f<m;f++){var v=d[f],g=new s.a(3*v.length,3);c.push(g.copyVector3sArray(v))}this.morphAttributes[h]=c}if(t.skinIndices.length>0){var y=new s.a(4*t.skinIndices.length,4);this.addAttribute("skinIndex",y.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var _=new s.a(4*t.skinWeights.length,4);this.addAttribute("skinWeight",_.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new o.a);var t=this.attributes.position;void 0!==t?this.boundingBox.setFromBufferAttribute(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var t=new o.a,e=new r.a;return function(){null===this.boundingSphere&&(this.boundingSphere=new l.a);var n=this.attributes.position;if(n){var i=this.boundingSphere.center;t.setFromBufferAttribute(n),t.getCenter(i);for(var r=0,o=0,a=n.count;o<a;o++)e.x=n.getX(o),e.y=n.getY(o),e.z=n.getZ(o),r=Math.max(r,i.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,n=this.groups;if(e.position){var i=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new s.d(new Float32Array(i.length),3));else for(var o=e.normal.array,a=0,l=o.length;a<l;a++)o[a]=0;var u,h,c,d=e.normal.array,f=new r.a,p=new r.a,m=new r.a,v=new r.a,g=new r.a;if(t){var y=t.array;0===n.length&&this.addGroup(0,y.length);for(var _=0,x=n.length;_<x;++_)for(var b=n[_],w=b.start,E=b.count,a=w,l=w+E;a<l;a+=3)u=3*y[a+0],h=3*y[a+1],c=3*y[a+2],f.fromArray(i,u),p.fromArray(i,h),m.fromArray(i,c),v.subVectors(m,p),g.subVectors(f,p),v.cross(g),d[u]+=v.x,d[u+1]+=v.y,d[u+2]+=v.z,d[h]+=v.x,d[h+1]+=v.y,d[h+2]+=v.z,d[c]+=v.x,d[c+1]+=v.y,d[c+2]+=v.z}else for(var a=0,l=i.length;a<l;a+=9)f.fromArray(i,a),p.fromArray(i,a+3),m.fromArray(i,a+6),v.subVectors(m,p),g.subVectors(f,p),v.cross(g),d[a]=v.x,d[a+1]=v.y,d[a+2]=v.z,d[a+3]=v.x,d[a+4]=v.y,d[a+5]=v.z,d[a+6]=v.x,d[a+7]=v.y,d[a+8]=v.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(!1===(t&&t.isBufferGeometry))return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0);var n=this.attributes;for(var i in n)if(void 0!==t.attributes[i])for(var r=n[i],o=r.array,a=t.attributes[i],s=a.array,l=a.itemSize,u=0,h=l*e;u<s.length;u++,h++)o[h]=s[u];return this},normalizeNormals:function(){for(var t,e,n,i,r=this.attributes.normal,o=0,a=r.count;o<a;o++)t=r.getX(o),e=r.getY(o),n=r.getZ(o),i=1/Math.sqrt(t*t+e*e+n*n),r.setXYZ(o,t*i,e*i,n*i)},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new i,e=this.index.array,n=this.attributes;for(var r in n){for(var o=n[r],a=o.array,l=o.itemSize,u=new a.constructor(e.length*l),h=0,c=0,d=0,f=e.length;d<f;d++){h=e[d]*l;for(var p=0;p<l;p++)u[c++]=a[h++]}t.addAttribute(r,new s.d(u,l))}return t},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var i=this.index;if(null!==i){var r=Array.prototype.slice.call(i.array);t.data.index={type:i.array.constructor.name,array:r}}var o=this.attributes;for(var n in o){var a=o[n],r=Array.prototype.slice.call(a.array);t.data.attributes[n]={itemSize:a.itemSize,type:a.array.constructor.name,array:r,normalized:a.normalized}}var s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));var l=this.boundingSphere;return null!==l&&(t.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),t},clone:function(){return(new i).copy(this)},copy:function(t){var e,n,i;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var r=t.index;null!==r&&this.setIndex(r.clone());var o=t.attributes;for(e in o){var a=o[e];this.addAttribute(e,a.clone())}var s=t.morphAttributes;for(e in s){var l=[],u=s[e];for(n=0,i=u.length;n<i;n++)l.push(u[n].clone());this.morphAttributes[e]=l}var h=t.groups;for(n=0,i=h.length;n<i;n++){var c=h[n];this.addGroup(c.start,c.count,c.materialIndex)}var d=t.boundingBox;null!==d&&(this.boundingBox=d.clone());var f=t.boundingSphere;return null!==f&&(this.boundingSphere=f.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}})},function(t,e,n){"use strict";function i(){}n.d(e,"a",function(){return i}),Object.assign(i.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners,i=n[t];if(void 0!==i){var r=i.indexOf(e);-1!==r&&i.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners,n=e[t.type];if(void 0!==n){t.target=this;var i=[],r=0,o=n.length;for(r=0;r<o;r++)i[r]=n[r];for(r=0;r<o;r++)i[r].call(this,t)}}}})},function(t,e,n){"use strict";function i(){Object.defineProperty(this,"id",{value:s++}),this.uuid=a.a.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=o.c,this.side=o.d,this.shading=o.e,this.vertexColors=o.f,this.opacity=1,this.transparent=!1,this.blendSrc=o.g,this.blendDst=o.h,this.blendEquation=o.i,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=o.j,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.needsUpdate=!0}n.d(e,"a",function(){return i});var r=n(8),o=n(1),a=n(2),s=0;Object.assign(i.prototype,r.a.prototype,{isMaterial:!0,setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0!==n){var i=this[e];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]="overdraw"===e?Number(n):n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){function e(t){var e=[];for(var n in t){var i=t[n];delete i.metadata,e.push(i)}return e}var n=void 0===t;n&&(t={textures:{},images:{}});var i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearCoat&&(i.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(i.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(t).uuid,i.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(i.size=this.size),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==o.c&&(i.blending=this.blending),this.shading!==o.e&&(i.shading=this.shading),this.side!==o.d&&(i.side=this.side),this.vertexColors!==o.f&&(i.vertexColors=this.vertexColors),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),i.skinning=this.skinning,i.morphTargets=this.morphTargets,i.dithering=this.dithering,n){var r=e(t.textures),a=e(t.images);r.length>0&&(i.textures=r),a.length>0&&(i.images=a)}return i},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.shading=t.shading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var e=t.clippingPlanes,n=null;if(null!==e){var i=e.length;n=new Array(i);for(var r=0;r!==i;++r)n[r]=e[r].clone()}return this.clippingPlanes=n,this},dispose:function(){this.dispatchEvent({type:"dispose"})}})},function(t,e,n){"use strict";function i(t,e){this.center=void 0!==t?t:new o.a,this.radius=void 0!==e?e:0}n.d(e,"a",function(){return i});var r=n(19),o=n(0);Object.assign(i.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new r.a;return function(e,n){var i=this.center;void 0!==n?i.copy(n):t.setFromPoints(e).getCenter(i);for(var r=0,o=0,a=e.length;o<a;o++)r=Math.max(r,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(this.center.dot(t.normal)-t.constant)<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t),i=e||new o.a;return i.copy(t),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i},getBoundingBox:function(t){var e=t||new r.a;return e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}})},function(t,e,n){"use strict";function i(t,e,n,i){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==i?i:1}n.d(e,"a",function(){return i}),Object.assign(i.prototype,{isVector4:!0,set:function(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*i+o[12]*r,this.y=o[1]*e+o[5]*n+o[9]*i+o[13]*r,this.z=o[2]*e+o[6]*n+o[10]*i+o[14]*r,this.w=o[3]*e+o[7]*n+o[11]*i+o[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,i,r,o=t.elements,a=o[0],s=o[4],l=o[8],u=o[1],h=o[5],c=o[9],d=o[2],f=o[6],p=o[10];if(Math.abs(s-u)<.01&&Math.abs(l-d)<.01&&Math.abs(c-f)<.01){if(Math.abs(s+u)<.1&&Math.abs(l+d)<.1&&Math.abs(c+f)<.1&&Math.abs(a+h+p-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var m=(a+1)/2,v=(h+1)/2,g=(p+1)/2,y=(s+u)/4,_=(l+d)/4,x=(c+f)/4;return m>v&&m>g?m<.01?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(m),i=y/n,r=_/n):v>g?v<.01?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(v),n=y/i,r=x/i):g<.01?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(g),n=_/r,i=x/r),this.set(n,i,r,e),this}var b=Math.sqrt((f-c)*(f-c)+(l-d)*(l-d)+(u-s)*(u-s));return Math.abs(b)<.001&&(b=1),this.x=(f-c)/b,this.y=(l-d)/b,this.z=(u-s)/b,this.w=Math.acos((a+h+p-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t=new i,e=new i;return function(n,i){return t.set(n,n,n,n),e.set(i,i,i,i),this.clamp(t,e)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}})},function(t,e,n){"use strict";function i(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=g.a.generateUUID(),this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function r(t,e){i.call(this,new Int8Array(t),e)}function o(t,e){i.call(this,new Uint8Array(t),e)}function a(t,e){i.call(this,new Uint8ClampedArray(t),e)}function s(t,e){i.call(this,new Int16Array(t),e)}function l(t,e){i.call(this,new Uint16Array(t),e)}function u(t,e){i.call(this,new Int32Array(t),e)}function h(t,e){i.call(this,new Uint32Array(t),e)}function c(t,e){i.call(this,new Float32Array(t),e)}function d(t,e){i.call(this,new Float64Array(t),e)}n.d(e,"a",function(){return c}),n.d(e,"b",function(){return h}),n.d(e,"c",function(){return l}),n.d(e,"d",function(){return i});var f=n(11),p=n(0),m=n(4),v=n(3),g=n(2);Object.defineProperty(i.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(i.prototype,{isBufferAttribute:!0,setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.itemSize:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),o=new v.a),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyIndicesArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];e[n++]=o.a,e[n++]=o.b,e[n++]=o.c}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),o=new m.a),e[n++]=o.x,e[n++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),o=new p.a),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),o=new f.a),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),r.prototype=Object.create(i.prototype),r.prototype.constructor=r,o.prototype=Object.create(i.prototype),o.prototype.constructor=o,a.prototype=Object.create(i.prototype),a.prototype.constructor=a,s.prototype=Object.create(i.prototype),s.prototype.constructor=s,l.prototype=Object.create(i.prototype),l.prototype.constructor=l,u.prototype=Object.create(i.prototype),u.prototype.constructor=u,h.prototype=Object.create(i.prototype),h.prototype.constructor=h,c.prototype=Object.create(i.prototype),c.prototype.constructor=c,d.prototype=Object.create(i.prototype),d.prototype.constructor=d},function(t,e,n){"use strict";function i(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}n.d(e,"a",function(){return i});var r=n(0);Object.assign(i.prototype,{isMatrix3:!0,set:function(t,e,n,i,r,o,a,s,l){var u=this.elements;return u[0]=t,u[1]=i,u[2]=a,u[3]=e,u[4]=r,u[5]=s,u[6]=n,u[7]=o,u[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToBufferAttribute:function(){var t=new r.a;return function(e){for(var n=0,i=e.count;n<i;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix3(this),e.setXYZ(n,t.x,t.y,t.z);return e}}(),multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,i=e.elements,r=this.elements,o=n[0],a=n[3],s=n[6],l=n[1],u=n[4],h=n[7],c=n[2],d=n[5],f=n[8],p=i[0],m=i[3],v=i[6],g=i[1],y=i[4],_=i[7],x=i[2],b=i[5],w=i[8];return r[0]=o*p+a*g+s*x,r[3]=o*m+a*y+s*b,r[6]=o*v+a*_+s*w,r[1]=l*p+u*g+h*x,r[4]=l*m+u*y+h*b,r[7]=l*v+u*_+h*w,r[2]=c*p+d*g+f*x,r[5]=c*m+d*y+f*b,r[8]=c*v+d*_+f*w,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],u=t[8];return e*o*u-e*a*l-n*r*u+n*a*s+i*r*l-i*o*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var n=t.elements,i=this.elements,r=n[0],o=n[1],a=n[2],s=n[3],l=n[4],u=n[5],h=n[6],c=n[7],d=n[8],f=d*l-u*c,p=u*h-d*s,m=c*s-l*h,v=r*f+o*p+a*m;if(0===v){var g="THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0";if(!0===e)throw new Error(g);return console.warn(g),this.identity()}var y=1/v;return i[0]=f*y,i[1]=(a*c-d*o)*y,i[2]=(u*o-a*l)*y,i[3]=p*y,i[4]=(d*r-a*h)*y,i[5]=(a*s-u*r)*y,i[6]=m*y,i[7]=(o*h-c*r)*y,i[8]=(l*r-o*s)*y,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},equals:function(t){for(var e=this.elements,n=t.elements,i=0;i<9;i++)if(e[i]!==n[i])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}})},function(t,e,n){"use strict";function i(t,e,n,i){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==i?i:1}n.d(e,"a",function(){return i});var r=n(0);Object.assign(i,{slerp:function(t,e,n,i){return n.copy(t).slerp(e,i)},slerpFlat:function(t,e,n,i,r,o,a){var s=n[i+0],l=n[i+1],u=n[i+2],h=n[i+3],c=r[o+0],d=r[o+1],f=r[o+2],p=r[o+3];if(h!==p||s!==c||l!==d||u!==f){var m=1-a,v=s*c+l*d+u*f+h*p,g=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){var _=Math.sqrt(y),x=Math.atan2(_,v*g);m=Math.sin(m*x)/_,a=Math.sin(a*x)/_}var b=a*g;if(s=s*m+c*b,l=l*m+d*b,u=u*m+f*b,h=h*m+p*b,m===1-a){var w=1/Math.sqrt(s*s+l*l+u*u+h*h);s*=w,l*=w,u*=w,h*=w}}t[e]=s,t[e+1]=l,t[e+2]=u,t[e+3]=h}}),Object.defineProperties(i.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback()}}}),Object.assign(i.prototype,{set:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(!1===(t&&t.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,i=t._y,r=t._z,o=t.order,a=Math.cos,s=Math.sin,l=a(n/2),u=a(i/2),h=a(r/2),c=s(n/2),d=s(i/2),f=s(r/2);return"XYZ"===o?(this._x=c*u*h+l*d*f,this._y=l*d*h-c*u*f,this._z=l*u*f+c*d*h,this._w=l*u*h-c*d*f):"YXZ"===o?(this._x=c*u*h+l*d*f,this._y=l*d*h-c*u*f,this._z=l*u*f-c*d*h,this._w=l*u*h+c*d*f):"ZXY"===o?(this._x=c*u*h-l*d*f,this._y=l*d*h+c*u*f,this._z=l*u*f+c*d*h,this._w=l*u*h-c*d*f):"ZYX"===o?(this._x=c*u*h-l*d*f,this._y=l*d*h+c*u*f,this._z=l*u*f-c*d*h,this._w=l*u*h+c*d*f):"YZX"===o?(this._x=c*u*h+l*d*f,this._y=l*d*h+c*u*f,this._z=l*u*f-c*d*h,this._w=l*u*h-c*d*f):"XZY"===o&&(this._x=c*u*h-l*d*f,this._y=l*d*h-c*u*f,this._z=l*u*f+c*d*h,this._w=l*u*h+c*d*f),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,i=n[0],r=n[4],o=n[8],a=n[1],s=n[5],l=n[9],u=n[2],h=n[6],c=n[10],d=i+s+c;return d>0?(e=.5/Math.sqrt(d+1),this._w=.25/e,this._x=(h-l)*e,this._y=(o-u)*e,this._z=(a-r)*e):i>s&&i>c?(e=2*Math.sqrt(1+i-s-c),this._w=(h-l)/e,this._x=.25*e,this._y=(r+a)/e,this._z=(o+u)/e):s>c?(e=2*Math.sqrt(1+s-i-c),this._w=(o-u)/e,this._x=(r+a)/e,this._y=.25*e,this._z=(l+h)/e):(e=2*Math.sqrt(1+c-i-s),this._w=(a-r)/e,this._x=(o+u)/e,this._y=(l+h)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e=new r.a;return function(n,i){return void 0===e&&(e=new r.a),t=n.dot(i)+1,t<1e-6?(t=0,Math.abs(n.x)>Math.abs(n.z)?e.set(-n.y,n.x,0):e.set(0,-n.z,n.y)):e.crossVectors(n,i),this._x=e.x,this._y=e.y,this._z=e.z,this._w=t,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,i=t._y,r=t._z,o=t._w,a=e._x,s=e._y,l=e._z,u=e._w;return this._x=n*u+o*a+i*l-r*s,this._y=i*u+o*s+r*a-n*l,this._z=r*u+o*l+n*s-i*a,this._w=o*u-n*a-i*s-r*l,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,i=this._y,r=this._z,o=this._w,a=o*t._w+n*t._x+i*t._y+r*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=i,this._z=r,this;var s=Math.sqrt(1-a*a);if(Math.abs(s)<.001)return this._w=.5*(o+this._w),this._x=.5*(n+this._x),this._y=.5*(i+this._y),this._z=.5*(r+this._z),this;var l=Math.atan2(s,a),u=Math.sin((1-e)*l)/s,h=Math.sin(e*l)/s;return this._w=o*u+this._w*h,this._x=n*u+this._x*h,this._y=i*u+this._y*h,this._z=r*u+this._z*h,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}})},function(t,e,n){"use strict";function i(t,e,n,r,u,h,c,d,f,p){Object.defineProperty(this,"id",{value:l++}),this.uuid=a.a.generateUUID(),this.name="",this.image=void 0!==t?t:i.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:i.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:o.y,this.wrapT=void 0!==r?r:o.y,this.magFilter=void 0!==u?u:o.D,this.minFilter=void 0!==h?h:o.F,this.anisotropy=void 0!==f?f:1,this.format=void 0!==c?c:o.s,this.type=void 0!==d?d:o.v,this.offset=new s.a(0,0),this.repeat=new s.a(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==p?p:o._17,this.version=0,this.onUpdate=null}n.d(e,"a",function(){return i});var r=n(8),o=n(1),a=n(2),s=n(4),l=0;i.DEFAULT_IMAGE=void 0,i.DEFAULT_MAPPING=o._18,Object.defineProperty(i.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(i.prototype,r.a.prototype,{constructor:i,isTexture:!0,clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){if(void 0!==t.textures[this.uuid])return t.textures[this.uuid];var e={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var n=this.image;void 0===n.uuid&&(n.uuid=a.a.generateUUID()),void 0===t.images[n.uuid]&&(t.images[n.uuid]={uuid:n.uuid,url:function(t){var e;return void 0!==t.toDataURL?e=t:(e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0,t.width,t.height)),e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}(n)}),e.image=n.uuid}return t.textures[this.uuid]=e,e},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping===o._18){if(t.multiply(this.repeat),t.add(this.offset),t.x<0||t.x>1)switch(this.wrapS){case o.x:t.x=t.x-Math.floor(t.x);break;case o.y:t.x=t.x<0?0:1;break;case o.z:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case o.x:t.y=t.y-Math.floor(t.y);break;case o.y:t.y=t.y<0?0:1;break;case o.z:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}})},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i={merge:function(t){for(var e={},n=0;n<t.length;n++){var i=this.clone(t[n]);for(var r in i)e[r]=i[r]}return e},clone:function(t){var e={};for(var n in t){e[n]={};for(var i in t[n]){var r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}}},function(t,e,n){"use strict";function i(t,e,n,i){r.a.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}n.d(e,"a",function(){return i});var r=n(26),o=n(6),a=n(2);i.prototype=Object.assign(Object.create(r.a.prototype),{constructor:i,isPerspectiveCamera:!0,copy:function(t){return r.a.prototype.copy.call(this,t),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*a.a.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*a.a.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*a.a.RAD2DEG*Math.atan(Math.tan(.5*a.a.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,i,r,o){this.aspect=t/e,this.view={fullWidth:t,fullHeight:e,offsetX:n,offsetY:i,width:r,height:o},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*a.a.DEG2RAD*this.fov)/this.zoom,n=2*e,i=this.aspect*n,r=-.5*i,o=this.view;if(null!==o){var s=o.fullWidth,l=o.fullHeight;r+=o.offsetX*i/s,e-=o.offsetY*n/l,i*=o.width/s,n*=o.height/l}var u=this.filmOffset;0!==u&&(r+=t*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,e,e-n,t,this.far)},toJSON:function(t){var e=o.a.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}})},function(t,e,n){"use strict";function i(){return v++}function r(){Object.defineProperty(this,"id",{value:i()}),this.uuid=m.a.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}n.d(e,"a",function(){return i}),n.d(e,"b",function(){return r});var o=n(8),a=n(27),s=n(13),l=n(10),u=n(19),h=n(0),c=n(5),d=n(4),f=n(3),p=n(6),m=n(2),v=0;Object.assign(r.prototype,o.a.prototype,{isGeometry:!0,applyMatrix:function(t){for(var e=(new s.a).getNormalMatrix(t),n=0,i=this.vertices.length;n<i;n++){this.vertices[n].applyMatrix4(t)}for(var n=0,i=this.faces.length;n<i;n++){var r=this.faces[n];r.normal.applyMatrix3(e).normalize();for(var o=0,a=r.vertexNormals.length;o<a;o++)r.vertexNormals[o].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var t=new c.a;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new c.a;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new c.a;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new c.a;return function(e,n,i){return t.makeTranslation(e,n,i),this.applyMatrix(t),this}}(),scale:function(){var t=new c.a;return function(e,n,i){return t.makeScale(e,n,i),this.applyMatrix(t),this}}(),lookAt:function(){var t=new p.a;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){function e(t,e,i,r){var o=void 0!==s?[p[t].clone(),p[e].clone(),p[i].clone()]:[],h=void 0!==l?[n.colors[t].clone(),n.colors[e].clone(),n.colors[i].clone()]:[],d=new a.a(t,e,i,o,h,r);n.faces.push(d),void 0!==u&&n.faceVertexUvs[0].push([m[t].clone(),m[e].clone(),m[i].clone()]),void 0!==c&&n.faceVertexUvs[1].push([v[t].clone(),v[e].clone(),v[i].clone()])}var n=this,i=null!==t.index?t.index.array:void 0,r=t.attributes,o=r.position.array,s=void 0!==r.normal?r.normal.array:void 0,l=void 0!==r.color?r.color.array:void 0,u=void 0!==r.uv?r.uv.array:void 0,c=void 0!==r.uv2?r.uv2.array:void 0;void 0!==c&&(this.faceVertexUvs[1]=[]);for(var p=[],m=[],v=[],g=0,y=0;g<o.length;g+=3,y+=2)n.vertices.push(new h.a(o[g],o[g+1],o[g+2])),void 0!==s&&p.push(new h.a(s[g],s[g+1],s[g+2])),void 0!==l&&n.colors.push(new f.a(l[g],l[g+1],l[g+2])),void 0!==u&&m.push(new d.a(u[y],u[y+1])),void 0!==c&&v.push(new d.a(c[y],c[y+1]));var _=t.groups;if(_.length>0)for(var g=0;g<_.length;g++)for(var x=_[g],b=x.start,w=x.count,y=b,E=b+w;y<E;y+=3)void 0!==i?e(i[y],i[y+1],i[y+2],x.materialIndex):e(y,y+1,y+2,x.materialIndex);else if(void 0!==i)for(var g=0;g<i.length;g+=3)e(i[g],i[g+1],i[g+2]);else for(var g=0;g<o.length/3;g+=3)e(g,g+1,g+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,n=0===e?1:1/e,i=new c.a;return i.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix(i),this},computeFaceNormals:function(){for(var t=new h.a,e=new h.a,n=0,i=this.faces.length;n<i;n++){var r=this.faces[n],o=this.vertices[r.a],a=this.vertices[r.b],s=this.vertices[r.c];t.subVectors(s,a),e.subVectors(o,a),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);var e,n,i,r,o,a;for(a=new Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)a[e]=new h.a;if(t){var s,l,u,c=new h.a,d=new h.a;for(i=0,r=this.faces.length;i<r;i++)o=this.faces[i],s=this.vertices[o.a],l=this.vertices[o.b],u=this.vertices[o.c],c.subVectors(u,l),d.subVectors(s,l),c.cross(d),a[o.a].add(c),a[o.b].add(c),a[o.c].add(c)}else for(this.computeFaceNormals(),i=0,r=this.faces.length;i<r;i++)o=this.faces[i],a[o.a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(e=0,n=this.vertices.length;e<n;e++)a[e].normalize();for(i=0,r=this.faces.length;i<r;i++){o=this.faces[i];var f=o.vertexNormals;3===f.length?(f[0].copy(a[o.a]),f[1].copy(a[o.b]),f[2].copy(a[o.c])):(f[0]=a[o.a].clone(),f[1]=a[o.b].clone(),f[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,n;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){n=this.faces[t];var i=n.vertexNormals;3===i.length?(i[0].copy(n.normal),i[1].copy(n.normal),i[2].copy(n.normal)):(i[0]=n.normal.clone(),i[1]=n.normal.clone(),i[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n,i,o;for(n=0,i=this.faces.length;n<i;n++)for(o=this.faces[n],o.__originalFaceNormal?o.__originalFaceNormal.copy(o.normal):o.__originalFaceNormal=o.normal.clone(),o.__originalVertexNormals||(o.__originalVertexNormals=[]),t=0,e=o.vertexNormals.length;t<e;t++)o.__originalVertexNormals[t]?o.__originalVertexNormals[t].copy(o.vertexNormals[t]):o.__originalVertexNormals[t]=o.vertexNormals[t].clone();var a=new r;for(a.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var s,l,u=this.morphNormals[t].faceNormals,c=this.morphNormals[t].vertexNormals;for(n=0,i=this.faces.length;n<i;n++)s=new h.a,l={a:new h.a,b:new h.a,c:new h.a},u.push(s),c.push(l)}var d=this.morphNormals[t];a.vertices=this.morphTargets[t].vertices,a.computeFaceNormals(),a.computeVertexNormals();var s,l;for(n=0,i=this.faces.length;n<i;n++)o=this.faces[n],s=d.faceNormals[n],l=d.vertexNormals[n],s.copy(o.normal),l.a.copy(o.vertexNormals[0]),l.b.copy(o.vertexNormals[1]),l.c.copy(o.vertexNormals[2])}for(n=0,i=this.faces.length;n<i;n++)o=this.faces[n],o.normal=o.__originalFaceNormal,o.vertexNormals=o.__originalVertexNormals},computeLineDistances:function(){for(var t=0,e=this.vertices,n=0,i=e.length;n<i;n++)n>0&&(t+=e[n].distanceTo(e[n-1])),this.lineDistances[n]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new u.a),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new l.a),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(!1===(t&&t.isGeometry))return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);var i,r=this.vertices.length,o=this.vertices,l=t.vertices,u=this.faces,h=t.faces,c=this.faceVertexUvs[0],d=t.faceVertexUvs[0],f=this.colors,p=t.colors;void 0===n&&(n=0),void 0!==e&&(i=(new s.a).getNormalMatrix(e));for(var m=0,v=l.length;m<v;m++){var g=l[m],y=g.clone();void 0!==e&&y.applyMatrix4(e),o.push(y)}for(var m=0,v=p.length;m<v;m++)f.push(p[m].clone());for(m=0,v=h.length;m<v;m++){var _,x,b,w=h[m],E=w.vertexNormals,P=w.vertexColors;_=new a.a(w.a+r,w.b+r,w.c+r),_.normal.copy(w.normal),void 0!==i&&_.normal.applyMatrix3(i).normalize();for(var M=0,S=E.length;M<S;M++)x=E[M].clone(),void 0!==i&&x.applyMatrix3(i).normalize(),_.vertexNormals.push(x);_.color.copy(w.color);for(var M=0,S=P.length;M<S;M++)b=P[M],_.vertexColors.push(b.clone());_.materialIndex=w.materialIndex+n,u.push(_)}for(m=0,v=d.length;m<v;m++){var T=d[m],C=[];if(void 0!==T){for(var M=0,S=T.length;M<S;M++)C.push(T[M].clone());c.push(C)}}},mergeMesh:function(t){if(!1===(t&&t.isMesh))return void console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t);t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)},mergeVertices:function(){var t,e,n,i,r,o,a,s,l={},u=[],h=[],c=Math.pow(10,4);for(n=0,i=this.vertices.length;n<i;n++)t=this.vertices[n],e=Math.round(t.x*c)+"_"+Math.round(t.y*c)+"_"+Math.round(t.z*c),void 0===l[e]?(l[e]=n,u.push(this.vertices[n]),h[n]=u.length-1):h[n]=h[l[e]];var d=[];for(n=0,i=this.faces.length;n<i;n++){r=this.faces[n],r.a=h[r.a],r.b=h[r.b],r.c=h[r.c],o=[r.a,r.b,r.c];for(var f=0;f<3;f++)if(o[f]===o[(f+1)%3]){d.push(n);break}}for(n=d.length-1;n>=0;n--){var p=d[n];for(this.faces.splice(p,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(p,1)}var m=this.vertices.length-u.length;return this.vertices=u,m},sortFacesByMaterialIndex:function(){function t(t,e){return t.materialIndex-e.materialIndex}for(var e=this.faces,n=e.length,i=0;i<n;i++)e[i]._id=i;e.sort(t);var r,o,a=this.faceVertexUvs[0],s=this.faceVertexUvs[1];a&&a.length===n&&(r=[]),s&&s.length===n&&(o=[]);for(var i=0;i<n;i++){var l=e[i]._id;r&&r.push(a[l]),o&&o.push(s[l])}r&&(this.faceVertexUvs[0]=r),o&&(this.faceVertexUvs[1]=o)},toJSON:function(){function t(t,e,n){return n?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==d[e]?d[e]:(d[e]=c.length/3,c.push(t.x,t.y,t.z),d[e])}function n(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==p[e]?p[e]:(p[e]=f.length,f.push(t.getHex()),p[e])}function i(t){var e=t.x.toString()+t.y.toString();return void 0!==v[e]?v[e]:(v[e]=m.length/2,m.push(t.x,t.y),v[e])}var r={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),void 0!==this.parameters){var o=this.parameters;for(var a in o)void 0!==o[a]&&(r[a]=o[a]);return r}for(var s=[],l=0;l<this.vertices.length;l++){var u=this.vertices[l];s.push(u.x,u.y,u.z)}for(var h=[],c=[],d={},f=[],p={},m=[],v={},l=0;l<this.faces.length;l++){var g=this.faces[l],y=void 0!==this.faceVertexUvs[0][l],_=g.normal.length()>0,x=g.vertexNormals.length>0,b=1!==g.color.r||1!==g.color.g||1!==g.color.b,w=g.vertexColors.length>0,E=0;if(E=t(E,0,0),E=t(E,1,!0),E=t(E,2,!1),E=t(E,3,y),E=t(E,4,_),E=t(E,5,x),E=t(E,6,b),E=t(E,7,w),h.push(E),h.push(g.a,g.b,g.c),h.push(g.materialIndex),y){var P=this.faceVertexUvs[0][l];h.push(i(P[0]),i(P[1]),i(P[2]))}if(_&&h.push(e(g.normal)),x){var M=g.vertexNormals;h.push(e(M[0]),e(M[1]),e(M[2]))}if(b&&h.push(n(g.color)),w){var S=g.vertexColors;h.push(n(S[0]),n(S[1]),n(S[2]))}}return r.data={},r.data.vertices=s,r.data.normals=c,f.length>0&&(r.data.colors=f),m.length>0&&(r.data.uvs=[m]),r.data.faces=h,r},clone:function(){return(new r).copy(this)},copy:function(t){var e,n,i,r,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var s=t.vertices;for(e=0,n=s.length;e<n;e++)this.vertices.push(s[e].clone());var l=t.colors;for(e=0,n=l.length;e<n;e++)this.colors.push(l[e].clone());var u=t.faces;for(e=0,n=u.length;e<n;e++)this.faces.push(u[e].clone());for(e=0,n=t.faceVertexUvs.length;e<n;e++){var h=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),i=0,r=h.length;i<r;i++){var c=h[i],d=[];for(o=0,a=c.length;o<a;o++){var f=c[o];d.push(f.clone())}this.faceVertexUvs[e].push(d)}}var p=t.morphTargets;for(e=0,n=p.length;e<n;e++){var m={};if(m.name=p[e].name,void 0!==p[e].vertices)for(m.vertices=[],i=0,r=p[e].vertices.length;i<r;i++)m.vertices.push(p[e].vertices[i].clone());if(void 0!==p[e].normals)for(m.normals=[],i=0,r=p[e].normals.length;i<r;i++)m.normals.push(p[e].normals[i].clone());this.morphTargets.push(m)}var v=t.morphNormals;for(e=0,n=v.length;e<n;e++){var g={};if(void 0!==v[e].vertexNormals)for(g.vertexNormals=[],i=0,r=v[e].vertexNormals.length;i<r;i++){var y=v[e].vertexNormals[i],_={};_.a=y.a.clone(),_.b=y.b.clone(),_.c=y.c.clone(),g.vertexNormals.push(_)}if(void 0!==v[e].faceNormals)for(g.faceNormals=[],i=0,r=v[e].faceNormals.length;i<r;i++)g.faceNormals.push(v[e].faceNormals[i].clone());this.morphNormals.push(g)}var x=t.skinWeights;for(e=0,n=x.length;e<n;e++)this.skinWeights.push(x[e].clone());var b=t.skinIndices;for(e=0,n=b.length;e<n;e++)this.skinIndices.push(b[e].clone());var w=t.lineDistances;for(e=0,n=w.length;e<n;e++)this.lineDistances.push(w[e]);var E=t.boundingBox;null!==E&&(this.boundingBox=E.clone());var P=t.boundingSphere;return null!==P&&(this.boundingSphere=P.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}})},function(t,e,n){"use strict";function i(t,e){this.min=void 0!==t?t:new r.a(1/0,1/0,1/0),this.max=void 0!==e?e:new r.a(-1/0,-1/0,-1/0)}n.d(e,"a",function(){return i});var r=n(0),o=n(10);Object.assign(i.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,a=-1/0,s=0,l=t.length;s<l;s+=3){var u=t[s],h=t[s+1],c=t[s+2];u<e&&(e=u),h<n&&(n=h),c<i&&(i=c),u>r&&(r=u),h>o&&(o=h),c>a&&(a=c)}return this.min.set(e,n,i),this.max.set(r,o,a),this},setFromBufferAttribute:function(t){for(var e=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,a=-1/0,s=0,l=t.count;s<l;s++){var u=t.getX(s),h=t.getY(s),c=t.getZ(s);u<e&&(e=u),h<n&&(n=h),c<i&&(i=c),u>r&&(r=u),h>o&&(o=h),c>a&&(a=c)}return this.min.set(e,n,i),this.max.set(r,o,a),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new r.a;return function(e,n){var i=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}}(),setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){var e=t||new r.a;return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){var e=t||new r.a;return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(){var t=new r.a;return function(e){var n=this;return e.updateMatrixWorld(!0),e.traverse(function(e){var i,r,o=e.geometry;if(void 0!==o)if(o.isGeometry){var a=o.vertices;for(i=0,r=a.length;i<r;i++)t.copy(a[i]),t.applyMatrix4(e.matrixWorld),n.expandByPoint(t)}else if(o.isBufferGeometry){var s=o.attributes.position;if(void 0!==s)for(i=0,r=s.count;i<r;i++)t.fromBufferAttribute(s,i).applyMatrix4(e.matrixWorld),n.expandByPoint(t)}}),this}}(),containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return(e||new r.a).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(){var t=new r.a;return function(e){return this.clampPoint(e.center,t),t.distanceToSquared(e.center)<=e.radius*e.radius}}(),intersectsPlane:function(t){var e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=t.constant&&n>=t.constant},clampPoint:function(t,e){return(e||new r.a).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new r.a;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),getBoundingSphere:function(){var t=new r.a;return function(e){var n=e||new o.a;return this.getCenter(n.center),n.radius=.5*this.getSize(t).length(),n}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new r.a,new r.a,new r.a,new r.a,new r.a,new r.a,new r.a,new r.a];return function(e){return this.isEmpty()?this:(t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(t),this)}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}})},function(t,e,n){"use strict";function i(t,e){this.normal=void 0!==t?t:new o.a(1,0,0),this.constant=void 0!==e?e:0}n.d(e,"a",function(){return i});var r=n(13),o=n(0);Object.assign(i.prototype,{set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new o.a,e=new o.a;return function(n,i,r){var o=t.subVectors(r,i).cross(e.subVectors(n,i)).normalize();return this.setFromNormalAndCoplanarPoint(o,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return this.orthoPoint(t,e).sub(t).negate()},orthoPoint:function(t,e){var n=this.distanceToPoint(t);return(e||new o.a).copy(this.normal).multiplyScalar(n)},intersectLine:function(){var t=new o.a;return function(e,n){var i=n||new o.a,r=e.delta(t),a=this.normal.dot(r);if(0!==a){var s=-(e.start.dot(this.normal)+this.constant)/a;if(!(s<0||s>1))return i.copy(r).multiplyScalar(s).add(e.start)}else if(0===this.distanceToPoint(e.start))return i.copy(e.start)}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return(t||new o.a).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new o.a,e=new r.a;return function(n,i){var r=this.coplanarPoint(t).applyMatrix4(n),o=i||e.getNormalMatrix(n),a=this.normal.applyMatrix3(o).normalize();return this.constant=-r.dot(a),this}}(),translate:function(t){return this.constant=this.constant-t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}})},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"RC4Rand",function(){return o}),n.d(e,"RandomFarm",function(){return a}),n.d(e,"rand",function(){return s});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;i(this,t),this.s=new Array(256).fill(0).map(function(t,e){return e}),this.i=0,this.j=0,e&&this.mix(e)}return r(t,[{key:"mix",value:function(t){t=""+t;for(var e=0,n=0;n<this.s.length;n++){var i=255&t.charCodeAt(n%t.length);e+=this.s[n]+i,e%=256,this._swap(n,e)}}},{key:"_swap",value:function(t,e){var n=this.s[e],i=this.s[t];this.s[t]=n,this.s[e]=i}},{key:"nextByte",value:function(){return this.i=(this.i+1)%256,this.j=(this.j+this.s[this.i])%256,this._swap(this.i,this.j),this.s[(this.s[this.i]+this.s[this.j])%256]}},{key:"nextFloat",value:function(){for(var t=0,e=0;e<7;e++)t=256*t+this.nextByte();return t/(Math.pow(2,56)-1)}},{key:"uniform",value:function(t,e){if(e<t){var n=t;t=e,e=n}return t+this.nextFloat()*(e-t)}},{key:"uniformInt",value:function(t,e){return Math.floor(this.uniform(t,e))}}]),t}(),a=function(){function t(e){i(this,t),this.seed=e}return r(t,[{key:"get",value:function(t){return new o(this.seed+"+"+t)}}]),t}(),s=function(t,e){return t+Math.random()*(e-t)}},function(t,e,n){var i=n(23),r=i.Symbol;t.exports=r},function(t,e,n){var i=n(54),r="object"==typeof self&&self&&self.Object===Object&&self,o=i||r||Function("return this")();t.exports=o},function(t,e){function n(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}t.exports=n},function(t,e,n){var i;!function(r,o){void 0!==(i=function(){return o(r,r.document)}.call(e,n,e,t))&&(t.exports=i)}("undefined"!=typeof window?window:this,function(t,e){function n(t,e,n,i){return n+i.replace(_.regex.dots," .")}function i(t){for(var e=t.slice(0),n=e.length;n--;)Array.isArray(e[n])&&(e[n]=i(e[n]));return e}function r(t,e){return t instanceof e}function o(t,e){return(t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector).call(t,e)}function a(t){return t.toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase()})}function s(t){return t.charAt(0).toUpperCase()+t.slice(1)}function l(t){return 4==t.length?["#",t.substring(1,2),t.substring(1,2),t.substring(2,3),t.substring(2,3),t.substring(3,4),t.substring(3,4)].join(""):t}function u(t){var e=t.toString(16);return 1==e.length?"0"+e:e}function h(t,e,n){if(null==e||null==n){var i=t.bbox();null==e?e=i.width/i.height*n:null==n&&(n=i.height/i.width*e)}return{width:e,height:n}}function c(t,e,n){return{x:e*t.a+n*t.c+0,y:e*t.b+n*t.d+0}}function d(t){return{a:t[0],b:t[1],c:t[2],d:t[3],e:t[4],f:t[5]}}function f(t){return t instanceof _.Matrix||(t=new _.Matrix(t)),t}function p(t,e){t.cx=null==t.cx?e.bbox().cx:t.cx,t.cy=null==t.cy?e.bbox().cy:t.cy}function m(t){for(var e=0,n=t.length,i="";e<n;e++)i+=t[e][0],null!=t[e][1]&&(i+=t[e][1],null!=t[e][2]&&(i+=" ",i+=t[e][2],null!=t[e][3]&&(i+=" ",i+=t[e][3],i+=" ",i+=t[e][4],null!=t[e][5]&&(i+=" ",i+=t[e][5],i+=" ",i+=t[e][6],null!=t[e][7]&&(i+=" ",i+=t[e][7])))));return i+" "}function v(e){for(var n=e.childNodes.length-1;n>=0;n--)e.childNodes[n]instanceof t.SVGElement&&v(e.childNodes[n]);return _.adopt(e).id(_.eid(e.nodeName))}function g(t){return null==t.x&&(t.x=0,t.y=0,t.width=0,t.height=0),t.w=t.width,t.h=t.height,t.x2=t.x+t.width,t.y2=t.y+t.height,t.cx=t.x+t.width/2,t.cy=t.y+t.height/2,t}function y(t){var e=t.toString().match(_.regex.reference);if(e)return e[1]}var _=this.SVG=function(t){if(_.supported)return t=new _.Doc(t),_.parser.draw||_.prepare(),t};if(_.ns="http://www.w3.org/2000/svg",_.xmlns="http://www.w3.org/2000/xmlns/",_.xlink="http://www.w3.org/1999/xlink",_.svgjs="http://svgjs.com/svgjs",_.supported=function(){return!!e.createElementNS&&!!e.createElementNS(_.ns,"svg").createSVGRect}(),!_.supported)return!1;_.did=1e3,_.eid=function(t){return"Svgjs"+s(t)+_.did++},_.create=function(t){var n=e.createElementNS(this.ns,t);return n.setAttribute("id",this.eid(t)),n},_.extend=function(){var t,e,n,i;for(t=[].slice.call(arguments),e=t.pop(),i=t.length-1;i>=0;i--)if(t[i])for(n in e)t[i].prototype[n]=e[n];_.Set&&_.Set.inherit&&_.Set.inherit()},_.invent=function(t){var e="function"==typeof t.create?t.create:function(){this.constructor.call(this,_.create(t.create))};return t.inherit&&(e.prototype=new t.inherit),t.extend&&_.extend(e,t.extend),t.construct&&_.extend(t.parent||_.Container,t.construct),e},_.adopt=function(e){if(!e)return null;if(e.instance)return e.instance;var n;return n="svg"==e.nodeName?e.parentNode instanceof t.SVGElement?new _.Nested:new _.Doc:"linearGradient"==e.nodeName?new _.Gradient("linear"):"radialGradient"==e.nodeName?new _.Gradient("radial"):_[s(e.nodeName)]?new(_[s(e.nodeName)]):new _.Element(e),n.type=e.nodeName,n.node=e,e.instance=n,n instanceof _.Doc&&n.namespace().defs(),n.setData(JSON.parse(e.getAttribute("svgjs:data"))||{}),n},_.prepare=function(){var t=e.getElementsByTagName("body")[0],n=(t?new _.Doc(t):_.adopt(e.documentElement).nested()).size(2,0);_.parser={body:t||e.documentElement,draw:n.style("opacity:0;position:absolute;left:-100%;top:-100%;overflow:hidden").node,poly:n.polyline().node,path:n.path().node,native:_.create("svg")}},_.parser={native:_.create("svg")},e.addEventListener("DOMContentLoaded",function(){_.parser.draw||_.prepare()},!1),_.regex={numberAndUnit:/^([+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?)([a-z%]*)$/i,hex:/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,rgb:/rgb\((\d+),(\d+),(\d+)\)/,reference:/#([a-z0-9\-_]+)/i,transforms:/\)\s*,?\s*/,whitespace:/\s/g,isHex:/^#[a-f0-9]{3,6}$/i,isRgb:/^rgb\(/,isCss:/[^:]+:[^;]+;?/,isBlank:/^(\s+)?$/,isNumber:/^[+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,isPercent:/^-?[\d\.]+%$/,isImage:/\.(jpg|jpeg|png|gif|svg)(\?[^=]+.*)?/i,delimiter:/[\s,]+/,hyphen:/([^e])\-/gi,pathLetters:/[MLHVCSQTAZ]/gi,isPathLetter:/[MLHVCSQTAZ]/i,numbersWithDots:/((\d?\.\d+(?:e[+-]?\d+)?)((?:\.\d+(?:e[+-]?\d+)?)+))+/gi,dots:/\./g},_.utils={map:function(t,e){var n,i=t.length,r=[];for(n=0;n<i;n++)r.push(e(t[n]));return r},filter:function(t,e){var n,i=t.length,r=[];for(n=0;n<i;n++)e(t[n])&&r.push(t[n]);return r},radians:function(t){return t%360*Math.PI/180},degrees:function(t){return 180*t/Math.PI%360},filterSVGElements:function(e){return this.filter(e,function(e){return e instanceof t.SVGElement})}},_.defaults={attrs:{"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","font-size":16,"font-family":"Helvetica, Arial, sans-serif","text-anchor":"start"}},_.Color=function(t){var e;this.r=0,this.g=0,this.b=0,t&&("string"==typeof t?_.regex.isRgb.test(t)?(e=_.regex.rgb.exec(t.replace(_.regex.whitespace,"")),this.r=parseInt(e[1]),this.g=parseInt(e[2]),this.b=parseInt(e[3])):_.regex.isHex.test(t)&&(e=_.regex.hex.exec(l(t)),this.r=parseInt(e[1],16),this.g=parseInt(e[2],16),this.b=parseInt(e[3],16)):"object"==typeof t&&(this.r=t.r,this.g=t.g,this.b=t.b))},_.extend(_.Color,{toString:function(){return this.toHex()},toHex:function(){return"#"+u(this.r)+u(this.g)+u(this.b)},toRgb:function(){return"rgb("+[this.r,this.g,this.b].join()+")"},brightness:function(){return this.r/255*.3+this.g/255*.59+this.b/255*.11},morph:function(t){return this.destination=new _.Color(t),this},at:function(t){return this.destination?(t=t<0?0:t>1?1:t,new _.Color({r:~~(this.r+(this.destination.r-this.r)*t),g:~~(this.g+(this.destination.g-this.g)*t),b:~~(this.b+(this.destination.b-this.b)*t)})):this}}),_.Color.test=function(t){return t+="",_.regex.isHex.test(t)||_.regex.isRgb.test(t)},_.Color.isRgb=function(t){return t&&"number"==typeof t.r&&"number"==typeof t.g&&"number"==typeof t.b},_.Color.isColor=function(t){return _.Color.isRgb(t)||_.Color.test(t)},_.Array=function(t,e){t=(t||[]).valueOf(),0==t.length&&e&&(t=e.valueOf()),this.value=this.parse(t)},_.extend(_.Array,{morph:function(t){if(this.destination=this.parse(t),this.value.length!=this.destination.length){for(var e=this.value[this.value.length-1],n=this.destination[this.destination.length-1];this.value.length>this.destination.length;)this.destination.push(n);for(;this.value.length<this.destination.length;)this.value.push(e)}return this},settle:function(){for(var t=0,e=this.value.length,n=[];t<e;t++)-1==n.indexOf(this.value[t])&&n.push(this.value[t]);return this.value=n},at:function(t){if(!this.destination)return this;for(var e=0,n=this.value.length,i=[];e<n;e++)i.push(this.value[e]+(this.destination[e]-this.value[e])*t);return new _.Array(i)},toString:function(){return this.value.join(" ")},valueOf:function(){return this.value},parse:function(t){return t=t.valueOf(),Array.isArray(t)?t:this.split(t)},split:function(t){return t.trim().split(_.regex.delimiter).map(parseFloat)},reverse:function(){return this.value.reverse(),this},clone:function(){var t=new this.constructor;return t.value=i(this.value),t}}),_.PointArray=function(t,e){_.Array.call(this,t,e||[[0,0]])},_.PointArray.prototype=new _.Array,_.PointArray.prototype.constructor=_.PointArray,_.extend(_.PointArray,{toString:function(){for(var t=0,e=this.value.length,n=[];t<e;t++)n.push(this.value[t].join(","));return n.join(" ")},toLine:function(){return{x1:this.value[0][0],y1:this.value[0][1],x2:this.value[1][0],y2:this.value[1][1]}},at:function(t){if(!this.destination)return this;for(var e=0,n=this.value.length,i=[];e<n;e++)i.push([this.value[e][0]+(this.destination[e][0]-this.value[e][0])*t,this.value[e][1]+(this.destination[e][1]-this.value[e][1])*t]);return new _.PointArray(i)},parse:function(t){var e=[];if(t=t.valueOf(),Array.isArray(t)){if(Array.isArray(t[0]))return t}else t=t.trim().split(_.regex.delimiter).map(parseFloat);t.length%2!=0&&t.pop();for(var n=0,i=t.length;n<i;n+=2)e.push([t[n],t[n+1]]);return e},move:function(t,e){var n=this.bbox();if(t-=n.x,e-=n.y,!isNaN(t)&&!isNaN(e))for(var i=this.value.length-1;i>=0;i--)this.value[i]=[this.value[i][0]+t,this.value[i][1]+e];return this},size:function(t,e){var n,i=this.bbox();for(n=this.value.length-1;n>=0;n--)i.width&&(this.value[n][0]=(this.value[n][0]-i.x)*t/i.width+i.x),i.height&&(this.value[n][1]=(this.value[n][1]-i.y)*e/i.height+i.y);return this},bbox:function(){return _.parser.poly.setAttribute("points",this.toString()),_.parser.poly.getBBox()}});for(var x={M:function(t,e,n){return e.x=n.x=t[0],e.y=n.y=t[1],["M",e.x,e.y]},L:function(t,e){return e.x=t[0],e.y=t[1],["L",t[0],t[1]]},H:function(t,e){return e.x=t[0],["H",t[0]]},V:function(t,e){return e.y=t[0],["V",t[0]]},C:function(t,e){return e.x=t[4],e.y=t[5],["C",t[0],t[1],t[2],t[3],t[4],t[5]]},S:function(t,e){return e.x=t[2],e.y=t[3],["S",t[0],t[1],t[2],t[3]]},Q:function(t,e){return e.x=t[2],e.y=t[3],["Q",t[0],t[1],t[2],t[3]]},T:function(t,e){return e.x=t[0],e.y=t[1],["T",t[0],t[1]]},Z:function(t,e,n){return e.x=n.x,e.y=n.y,["Z"]},A:function(t,e){return e.x=t[5],e.y=t[6],["A",t[0],t[1],t[2],t[3],t[4],t[5],t[6]]}},b="mlhvqtcsaz".split(""),w=0,E=b.length;w<E;++w)x[b[w]]=function(t){return function(e,n,i){if("H"==t)e[0]=e[0]+n.x;else if("V"==t)e[0]=e[0]+n.y;else if("A"==t)e[5]=e[5]+n.x,e[6]=e[6]+n.y;else for(var r=0,o=e.length;r<o;++r)e[r]=e[r]+(r%2?n.y:n.x);return x[t](e,n,i)}}(b[w].toUpperCase());_.PathArray=function(t,e){_.Array.call(this,t,e||[["M",0,0]])},_.PathArray.prototype=new _.Array,_.PathArray.prototype.constructor=_.PathArray,_.extend(_.PathArray,{toString:function(){return m(this.value)},move:function(t,e){var n=this.bbox();if(t-=n.x,e-=n.y,!isNaN(t)&&!isNaN(e))for(var i,r=this.value.length-1;r>=0;r--)i=this.value[r][0],"M"==i||"L"==i||"T"==i?(this.value[r][1]+=t,this.value[r][2]+=e):"H"==i?this.value[r][1]+=t:"V"==i?this.value[r][1]+=e:"C"==i||"S"==i||"Q"==i?(this.value[r][1]+=t,this.value[r][2]+=e,this.value[r][3]+=t,this.value[r][4]+=e,"C"==i&&(this.value[r][5]+=t,this.value[r][6]+=e)):"A"==i&&(this.value[r][6]+=t,this.value[r][7]+=e);return this},size:function(t,e){var n,i,r=this.bbox();for(n=this.value.length-1;n>=0;n--)i=this.value[n][0],"M"==i||"L"==i||"T"==i?(this.value[n][1]=(this.value[n][1]-r.x)*t/r.width+r.x,this.value[n][2]=(this.value[n][2]-r.y)*e/r.height+r.y):"H"==i?this.value[n][1]=(this.value[n][1]-r.x)*t/r.width+r.x:"V"==i?this.value[n][1]=(this.value[n][1]-r.y)*e/r.height+r.y:"C"==i||"S"==i||"Q"==i?(this.value[n][1]=(this.value[n][1]-r.x)*t/r.width+r.x,this.value[n][2]=(this.value[n][2]-r.y)*e/r.height+r.y,this.value[n][3]=(this.value[n][3]-r.x)*t/r.width+r.x,this.value[n][4]=(this.value[n][4]-r.y)*e/r.height+r.y,"C"==i&&(this.value[n][5]=(this.value[n][5]-r.x)*t/r.width+r.x,this.value[n][6]=(this.value[n][6]-r.y)*e/r.height+r.y)):"A"==i&&(this.value[n][1]=this.value[n][1]*t/r.width,this.value[n][2]=this.value[n][2]*e/r.height,this.value[n][6]=(this.value[n][6]-r.x)*t/r.width+r.x,this.value[n][7]=(this.value[n][7]-r.y)*e/r.height+r.y);return this},equalCommands:function(t){var e,n,i;for(t=new _.PathArray(t),i=this.value.length===t.value.length,e=0,n=this.value.length;i&&e<n;e++)i=this.value[e][0]===t.value[e][0];return i},morph:function(t){return t=new _.PathArray(t),this.equalCommands(t)?this.destination=t:this.destination=null,this},at:function(t){if(!this.destination)return this;var e,n,i,r,o=this.value,a=this.destination.value,s=[],l=new _.PathArray;for(e=0,n=o.length;e<n;e++){for(s[e]=[o[e][0]],i=1,r=o[e].length;i<r;i++)s[e][i]=o[e][i]+(a[e][i]-o[e][i])*t;"A"===s[e][0]&&(s[e][4]=+(0!=s[e][4]),s[e][5]=+(0!=s[e][5]))}return l.value=s,l},parse:function(t){if(t instanceof _.PathArray)return t.valueOf();var e,i,r={M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7,Z:0};t="string"==typeof t?t.replace(_.regex.numbersWithDots,n).replace(_.regex.pathLetters," $& ").replace(_.regex.hyphen,"$1 -").trim().split(_.regex.delimiter):t.reduce(function(t,e){return[].concat.call(t,e)},[]);var i=[],o=new _.Point,a=new _.Point,s=0,l=t.length;do{_.regex.isPathLetter.test(t[s])?(e=t[s],++s):"M"==e?e="L":"m"==e&&(e="l"),i.push(x[e].call(null,t.slice(s,s+=r[e.toUpperCase()]).map(parseFloat),o,a))}while(l>s);return i},bbox:function(){return _.parser.path.setAttribute("d",this.toString()),_.parser.path.getBBox()}}),_.Number=_.invent({create:function(t,e){this.value=0,this.unit=e||"","number"==typeof t?this.value=isNaN(t)?0:isFinite(t)?t:t<0?-3.4e38:3.4e38:"string"==typeof t?(e=t.match(_.regex.numberAndUnit))&&(this.value=parseFloat(e[1]),"%"==e[5]?this.value/=100:"s"==e[5]&&(this.value*=1e3),this.unit=e[5]):t instanceof _.Number&&(this.value=t.valueOf(),this.unit=t.unit)},extend:{toString:function(){return("%"==this.unit?~~(1e8*this.value)/1e6:"s"==this.unit?this.value/1e3:this.value)+this.unit},toJSON:function(){return this.toString()},valueOf:function(){return this.value},plus:function(t){return t=new _.Number(t),new _.Number(this+t,this.unit||t.unit)},minus:function(t){return t=new _.Number(t),new _.Number(this-t,this.unit||t.unit)},times:function(t){return t=new _.Number(t),new _.Number(this*t,this.unit||t.unit)},divide:function(t){return t=new _.Number(t),new _.Number(this/t,this.unit||t.unit)},to:function(t){var e=new _.Number(this);return"string"==typeof t&&(e.unit=t),e},morph:function(t){return this.destination=new _.Number(t),t.relative&&(this.destination.value+=this.value),this},at:function(t){return this.destination?new _.Number(this.destination).minus(this).times(t).plus(this):this}}}),_.Element=_.invent({create:function(t){this._stroke=_.defaults.attrs.stroke,this._event=null,this.dom={},(this.node=t)&&(this.type=t.nodeName,this.node.instance=this,this._stroke=t.getAttribute("stroke")||this._stroke)},extend:{x:function(t){return this.attr("x",t)},y:function(t){return this.attr("y",t)},cx:function(t){return null==t?this.x()+this.width()/2:this.x(t-this.width()/2)},cy:function(t){return null==t?this.y()+this.height()/2:this.y(t-this.height()/2)},move:function(t,e){return this.x(t).y(e)},center:function(t,e){return this.cx(t).cy(e)},width:function(t){return this.attr("width",t)},height:function(t){return this.attr("height",t)},size:function(t,e){var n=h(this,t,e);return this.width(new _.Number(n.width)).height(new _.Number(n.height))},clone:function(t,e){this.writeDataToDom();var n=v(this.node.cloneNode(!0));return t?t.add(n):this.after(n),n},remove:function(){return this.parent()&&this.parent().removeElement(this),this},replace:function(t){return this.after(t).remove(),t},addTo:function(t){return t.put(this)},putIn:function(t){return t.add(this)},id:function(t){return this.attr("id",t)},inside:function(t,e){var n=this.bbox();return t>n.x&&e>n.y&&t<n.x+n.width&&e<n.y+n.height},show:function(){return this.style("display","")},hide:function(){return this.style("display","none")},visible:function(){return"none"!=this.style("display")},toString:function(){return this.attr("id")},classes:function(){var t=this.attr("class");return null==t?[]:t.trim().split(_.regex.delimiter)},hasClass:function(t){return-1!=this.classes().indexOf(t)},addClass:function(t){if(!this.hasClass(t)){var e=this.classes();e.push(t),this.attr("class",e.join(" "))}return this},removeClass:function(t){return this.hasClass(t)&&this.attr("class",this.classes().filter(function(e){return e!=t}).join(" ")),this},toggleClass:function(t){return this.hasClass(t)?this.removeClass(t):this.addClass(t)},reference:function(t){return _.get(this.attr(t))},parent:function(e){var n=this;if(!n.node.parentNode)return null;if(n=_.adopt(n.node.parentNode),!e)return n;for(;n&&n.node instanceof t.SVGElement;){if("string"==typeof e?n.matches(e):n instanceof e)return n;n=_.adopt(n.node.parentNode)}},doc:function(){return this instanceof _.Doc?this:this.parent(_.Doc)},parents:function(t){var e=[],n=this;do{if(!(n=n.parent(t))||!n.node)break;e.push(n)}while(n.parent);return e},matches:function(t){return o(this.node,t)},native:function(){return this.node},svg:function(t){var n=e.createElement("svg");if(!(t&&this instanceof _.Parent))return n.appendChild(t=e.createElement("svg")),this.writeDataToDom(),t.appendChild(this.node.cloneNode(!0)),n.innerHTML.replace(/^<svg>/,"").replace(/<\/svg>$/,"");n.innerHTML="<svg>"+t.replace(/\n/,"").replace(/<(\w+)([^<]+?)\/>/g,"<$1$2></$1>")+"</svg>";for(var i=0,r=n.firstChild.childNodes.length;i<r;i++)this.node.appendChild(n.firstChild.firstChild);return this},writeDataToDom:function(){if(this.each||this.lines){(this.each?this:this.lines()).each(function(){this.writeDataToDom()})}return this.node.removeAttribute("svgjs:data"),Object.keys(this.dom).length&&this.node.setAttribute("svgjs:data",JSON.stringify(this.dom)),this},setData:function(t){return this.dom=t,this},is:function(t){return r(this,t)}}}),_.easing={"-":function(t){return t},"<>":function(t){return-Math.cos(t*Math.PI)/2+.5},">":function(t){return Math.sin(t*Math.PI/2)},"<":function(t){return 1-Math.cos(t*Math.PI/2)}},_.morph=function(t){return function(e,n){return new _.MorphObj(e,n).at(t)}},_.Situation=_.invent({create:function(t){this.init=!1,this.reversed=!1,this.reversing=!1,this.duration=new _.Number(t.duration).valueOf(),this.delay=new _.Number(t.delay).valueOf(),this.start=+new Date+this.delay,this.finish=this.start+this.duration,this.ease=t.ease,this.loop=0,this.loops=!1,this.animations={},this.attrs={},this.styles={},this.transforms=[],this.once={}}}),_.FX=_.invent({create:function(t){this._target=t,this.situations=[],this.active=!1,this.situation=null,this.paused=!1,this.lastPos=0,this.pos=0,this.absPos=0,this._speed=1},extend:{animate:function(t,e,n){"object"==typeof t&&(e=t.ease,n=t.delay,t=t.duration);var i=new _.Situation({duration:t||1e3,delay:n||0,ease:_.easing[e||"-"]||e});return this.queue(i),this},delay:function(t){var e=new _.Situation({duration:t,delay:0,ease:_.easing["-"]});return this.queue(e)},target:function(t){return t&&t instanceof _.Element?(this._target=t,this):this._target},timeToAbsPos:function(t){return(t-this.situation.start)/(this.situation.duration/this._speed)},absPosToTime:function(t){return this.situation.duration/this._speed*t+this.situation.start},startAnimFrame:function(){this.stopAnimFrame(),this.animationFrame=t.requestAnimationFrame(function(){this.step()}.bind(this))},stopAnimFrame:function(){t.cancelAnimationFrame(this.animationFrame)},start:function(){return!this.active&&this.situation&&(this.active=!0,this.startCurrent()),this},startCurrent:function(){return this.situation.start=+new Date+this.situation.delay/this._speed,this.situation.finish=this.situation.start+this.situation.duration/this._speed,this.initAnimations().step()},queue:function(t){return("function"==typeof t||t instanceof _.Situation)&&this.situations.push(t),this.situation||(this.situation=this.situations.shift()),this},dequeue:function(){return this.stop(),this.situation=this.situations.shift(),this.situation&&(this.situation instanceof _.Situation?this.start():this.situation.call(this)),this},initAnimations:function(){var t,e,n=this.situation;if(n.init)return this;for(t in n.animations)e=this.target()[t](),n.animations[t]instanceof _.Number&&(e=new _.Number(e)),n.animations[t]=e.morph(n.animations[t]);for(t in n.attrs)n.attrs[t]=new _.MorphObj(this.target().attr(t),n.attrs[t]);for(t in n.styles)n.styles[t]=new _.MorphObj(this.target().style(t),n.styles[t]);return n.initialTransformation=this.target().matrixify(),n.init=!0,this},clearQueue:function(){return this.situations=[],this},clearCurrent:function(){return this.situation=null,this},stop:function(t,e){var n=this.active;return this.active=!1,e&&this.clearQueue(),t&&this.situation&&(!n&&this.startCurrent(),this.atEnd()),this.stopAnimFrame(),this.clearCurrent()},reset:function(){if(this.situation){var t=this.situation;this.stop(),this.situation=t,this.atStart()}return this},finish:function(){for(this.stop(!0,!1);this.dequeue().situation&&this.stop(!0,!1););return this.clearQueue().clearCurrent(),this},atStart:function(){return this.at(0,!0)},atEnd:function(){return!0===this.situation.loops&&(this.situation.loops=this.situation.loop+1),"number"==typeof this.situation.loops?this.at(this.situation.loops,!0):this.at(1,!0)},at:function(t,e){var n=this.situation.duration/this._speed;return this.absPos=t,e||(this.situation.reversed&&(this.absPos=1-this.absPos),this.absPos+=this.situation.loop),this.situation.start=+new Date-this.absPos*n,this.situation.finish=this.situation.start+n,this.step(!0)},speed:function(t){return 0===t?this.pause():t?(this._speed=t,this.at(this.absPos,!0)):this._speed},loop:function(t,e){var n=this.last();return n.loops=null==t||t,n.loop=0,e&&(n.reversing=!0),this},pause:function(){return this.paused=!0,this.stopAnimFrame(),this},play:function(){return this.paused?(this.paused=!1,this.at(this.absPos,!0)):this},reverse:function(t){var e=this.last();return e.reversed=void 0===t?!e.reversed:t,this},progress:function(t){return t?this.situation.ease(this.pos):this.pos},after:function(t){var e=this.last(),n=function n(i){i.detail.situation==e&&(t.call(this,e),this.off("finished.fx",n))};return this.target().on("finished.fx",n),this._callStart()},during:function(t){var e=this.last(),n=function(n){n.detail.situation==e&&t.call(this,n.detail.pos,_.morph(n.detail.pos),n.detail.eased,e)};return this.target().off("during.fx",n).on("during.fx",n),this.after(function(){this.off("during.fx",n)}),this._callStart()},afterAll:function(t){var e=function e(n){t.call(this),this.off("allfinished.fx",e)};return this.target().off("allfinished.fx",e).on("allfinished.fx",e),this._callStart()},duringAll:function(t){var e=function(e){t.call(this,e.detail.pos,_.morph(e.detail.pos),e.detail.eased,e.detail.situation)};return this.target().off("during.fx",e).on("during.fx",e),this.afterAll(function(){this.off("during.fx",e)}),this._callStart()},last:function(){return this.situations.length?this.situations[this.situations.length-1]:this.situation},add:function(t,e,n){return this.last()[n||"animations"][t]=e,this._callStart()},step:function(t){if(t||(this.absPos=this.timeToAbsPos(+new Date)),!1!==this.situation.loops){var e,n,i;e=Math.max(this.absPos,0),n=Math.floor(e),!0===this.situation.loops||n<this.situation.loops?(this.pos=e-n,i=this.situation.loop,this.situation.loop=n):(this.absPos=this.situation.loops,this.pos=1,i=this.situation.loop-1,this.situation.loop=this.situation.loops),this.situation.reversing&&(this.situation.reversed=this.situation.reversed!=Boolean((this.situation.loop-i)%2))}else this.absPos=Math.min(this.absPos,1),this.pos=this.absPos;this.pos<0&&(this.pos=0),this.situation.reversed&&(this.pos=1-this.pos);var r=this.situation.ease(this.pos);for(var o in this.situation.once)o>this.lastPos&&o<=r&&(this.situation.once[o].call(this.target(),this.pos,r),delete this.situation.once[o]);return this.active&&this.target().fire("during",{pos:this.pos,eased:r,fx:this,situation:this.situation}),this.situation?(this.eachAt(),1==this.pos&&!this.situation.reversed||this.situation.reversed&&0==this.pos?(this.stopAnimFrame(),this.target().fire("finished",{fx:this,situation:this.situation}),this.situations.length||(this.target().fire("allfinished"),this.target().off(".fx"),this.active=!1),this.active?this.dequeue():this.clearCurrent()):!this.paused&&this.active&&this.startAnimFrame(),this.lastPos=r,this):this},eachAt:function(){var t,e,n,i=this,r=this.target(),o=this.situation;for(t in o.animations)n=[].concat(o.animations[t]).map(function(t){return"string"!=typeof t&&t.at?t.at(o.ease(i.pos),i.pos):t}),r[t].apply(r,n);for(t in o.attrs)n=[t].concat(o.attrs[t]).map(function(t){return"string"!=typeof t&&t.at?t.at(o.ease(i.pos),i.pos):t}),r.attr.apply(r,n);for(t in o.styles)n=[t].concat(o.styles[t]).map(function(t){return"string"!=typeof t&&t.at?t.at(o.ease(i.pos),i.pos):t}),r.style.apply(r,n);if(o.transforms.length){for(n=o.initialTransformation,t=0,e=o.transforms.length;t<e;t++){var a=o.transforms[t];a instanceof _.Matrix?n=a.relative?n.multiply((new _.Matrix).morph(a).at(o.ease(this.pos))):n.morph(a).at(o.ease(this.pos)):(a.relative||a.undo(n.extract()),n=n.multiply(a.at(o.ease(this.pos))))}r.matrix(n)}return this},once:function(t,e,n){return n||(t=this.situation.ease(t)),this.situation.once[t]=e,this},_callStart:function(){return setTimeout(function(){this.start()}.bind(this),0),this}},parent:_.Element,construct:{animate:function(t,e,n){return(this.fx||(this.fx=new _.FX(this))).animate(t,e,n)},delay:function(t){return(this.fx||(this.fx=new _.FX(this))).delay(t)},stop:function(t,e){return this.fx&&this.fx.stop(t,e),this},finish:function(){return this.fx&&this.fx.finish(),this},pause:function(){return this.fx&&this.fx.pause(),this},play:function(){return this.fx&&this.fx.play(),this},speed:function(t){if(this.fx){if(null==t)return this.fx.speed();this.fx.speed(t)}return this}}}),_.MorphObj=_.invent({create:function(t,e){return _.Color.isColor(e)?new _.Color(t).morph(e):_.regex.numberAndUnit.test(e)?new _.Number(t).morph(e):(this.value=t,void(this.destination=e))},extend:{at:function(t,e){return e<1?this.value:this.destination},valueOf:function(){return this.value}}}),_.extend(_.FX,{attr:function(t,e,n){if("object"==typeof t)for(var i in t)this.attr(i,t[i]);else this.add(t,e,"attrs");return this},style:function(t,e){if("object"==typeof t)for(var n in t)this.style(n,t[n]);else this.add(t,e,"styles");return this},x:function(t,e){if(this.target()instanceof _.G)return this.transform({x:t},e),this;var n=new _.Number(t);return n.relative=e,this.add("x",n)},y:function(t,e){if(this.target()instanceof _.G)return this.transform({y:t},e),this;var n=new _.Number(t);return n.relative=e,this.add("y",n)},cx:function(t){return this.add("cx",new _.Number(t))},cy:function(t){return this.add("cy",new _.Number(t))},move:function(t,e){return this.x(t).y(e)},center:function(t,e){return this.cx(t).cy(e)},size:function(t,e){if(this.target()instanceof _.Text)this.attr("font-size",t);else{var n;t&&e||(n=this.target().bbox()),t||(t=n.width/n.height*e),e||(e=n.height/n.width*t),this.add("width",new _.Number(t)).add("height",new _.Number(e))}return this},plot:function(){return this.add("plot",arguments.length>1?[].slice.call(arguments):arguments[0])},leading:function(t){return this.target().leading?this.add("leading",new _.Number(t)):this},viewbox:function(t,e,n,i){return this.target()instanceof _.Container&&this.add("viewbox",new _.ViewBox(t,e,n,i)),this},update:function(t){if(this.target()instanceof _.Stop){if("number"==typeof t||t instanceof _.Number)return this.update({offset:arguments[0],color:arguments[1],opacity:arguments[2]});null!=t.opacity&&this.attr("stop-opacity",t.opacity),null!=t.color&&this.attr("stop-color",t.color),null!=t.offset&&this.attr("offset",t.offset)}return this}}),_.Box=_.invent({create:function(t,e,n,i){if(!("object"!=typeof t||t instanceof _.Element))return _.Box.call(this,null!=t.left?t.left:t.x,null!=t.top?t.top:t.y,t.width,t.height);4==arguments.length&&(this.x=t,this.y=e,this.width=n,this.height=i),g(this)},extend:{merge:function(t){var e=new this.constructor;return e.x=Math.min(this.x,t.x),e.y=Math.min(this.y,t.y),e.width=Math.max(this.x+this.width,t.x+t.width)-e.x,e.height=Math.max(this.y+this.height,t.y+t.height)-e.y,g(e)},transform:function(t){var e,n=1/0,i=-1/0,r=1/0,o=-1/0;return[new _.Point(this.x,this.y),new _.Point(this.x2,this.y),new _.Point(this.x,this.y2),new _.Point(this.x2,this.y2)].forEach(function(e){e=e.transform(t),n=Math.min(n,e.x),i=Math.max(i,e.x),r=Math.min(r,e.y),o=Math.max(o,e.y)}),e=new this.constructor,e.x=n,e.width=i-n,e.y=r,e.height=o-r,g(e),e}}}),_.BBox=_.invent({create:function(t){if(_.Box.apply(this,[].slice.call(arguments)),t instanceof _.Element){var n;try{if(e.documentElement.contains){if(!e.documentElement.contains(t.node))throw new Exception("Element not in the dom")}else{for(var i=t.node;i.parentNode;)i=i.parentNode;if(i!=e)throw new Exception("Element not in the dom")}n=t.node.getBBox()}catch(e){if(t instanceof _.Shape){var r=t.clone(_.parser.draw.instance).show();n=r.node.getBBox(),r.remove()}else n={x:t.node.clientLeft,y:t.node.clientTop,width:t.node.clientWidth,height:t.node.clientHeight}}_.Box.call(this,n)}},inherit:_.Box,parent:_.Element,construct:{bbox:function(){return new _.BBox(this)}}}),_.BBox.prototype.constructor=_.BBox,_.extend(_.Element,{tbox:function(){return console.warn("Use of TBox is deprecated and mapped to RBox. Use .rbox() instead."),this.rbox(this.doc())}}),_.RBox=_.invent({create:function(t){_.Box.apply(this,[].slice.call(arguments)),t instanceof _.Element&&_.Box.call(this,t.node.getBoundingClientRect())},inherit:_.Box,parent:_.Element,extend:{addOffset:function(){return this.x+=t.pageXOffset,this.y+=t.pageYOffset,this}},construct:{rbox:function(t){return t?new _.RBox(this).transform(t.screenCTM().inverse()):new _.RBox(this).addOffset()}}}),_.RBox.prototype.constructor=_.RBox,_.Matrix=_.invent({create:function(t){var e,n=d([1,0,0,1,0,0]);for(t=t instanceof _.Element?t.matrixify():"string"==typeof t?d(t.split(_.regex.delimiter).map(parseFloat)):6==arguments.length?d([].slice.call(arguments)):Array.isArray(t)?d(t):"object"==typeof t?t:n,e=M.length-1;e>=0;--e)this[M[e]]=t&&"number"==typeof t[M[e]]?t[M[e]]:n[M[e]]},extend:{extract:function(){var t=c(this,0,1),e=c(this,1,0),n=180/Math.PI*Math.atan2(t.y,t.x)-90;return{x:this.e,y:this.f,transformedX:(this.e*Math.cos(n*Math.PI/180)+this.f*Math.sin(n*Math.PI/180))/Math.sqrt(this.a*this.a+this.b*this.b),transformedY:(this.f*Math.cos(n*Math.PI/180)+this.e*Math.sin(-n*Math.PI/180))/Math.sqrt(this.c*this.c+this.d*this.d),skewX:-n,skewY:180/Math.PI*Math.atan2(e.y,e.x),scaleX:Math.sqrt(this.a*this.a+this.b*this.b),scaleY:Math.sqrt(this.c*this.c+this.d*this.d),rotation:n,a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f,matrix:new _.Matrix(this)}},clone:function(){return new _.Matrix(this)},morph:function(t){return this.destination=new _.Matrix(t),this},at:function(t){return this.destination?new _.Matrix({a:this.a+(this.destination.a-this.a)*t,b:this.b+(this.destination.b-this.b)*t,c:this.c+(this.destination.c-this.c)*t,d:this.d+(this.destination.d-this.d)*t,e:this.e+(this.destination.e-this.e)*t,f:this.f+(this.destination.f-this.f)*t}):this},multiply:function(t){return new _.Matrix(this.native().multiply(f(t).native()))},inverse:function(){return new _.Matrix(this.native().inverse())},translate:function(t,e){return new _.Matrix(this.native().translate(t||0,e||0))},scale:function(t,e,n,i){return 1==arguments.length?e=t:3==arguments.length&&(i=n,n=e,e=t),this.around(n,i,new _.Matrix(t,0,0,e,0,0))},rotate:function(t,e,n){return t=_.utils.radians(t),this.around(e,n,new _.Matrix(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0))},flip:function(t,e){return"x"==t?this.scale(-1,1,e,0):"y"==t?this.scale(1,-1,0,e):this.scale(-1,-1,t,null!=e?e:t)},skew:function(t,e,n,i){return 1==arguments.length?e=t:3==arguments.length&&(i=n,n=e,e=t),t=_.utils.radians(t),e=_.utils.radians(e),this.around(n,i,new _.Matrix(1,Math.tan(e),Math.tan(t),1,0,0))},skewX:function(t,e,n){return this.skew(t,0,e,n)},skewY:function(t,e,n){return this.skew(0,t,e,n)},around:function(t,e,n){return this.multiply(new _.Matrix(1,0,0,1,t||0,e||0)).multiply(n).multiply(new _.Matrix(1,0,0,1,-t||0,-e||0))},native:function(){for(var t=_.parser.native.createSVGMatrix(),e=M.length-1;e>=0;e--)t[M[e]]=this[M[e]];return t},toString:function(){return"matrix("+this.a+","+this.b+","+this.c+","+this.d+","+this.e+","+this.f+")"}},parent:_.Element,construct:{ctm:function(){return new _.Matrix(this.node.getCTM())},screenCTM:function(){if(this instanceof _.Nested){var t=this.rect(1,1),e=t.node.getScreenCTM();return t.remove(),new _.Matrix(e)}return new _.Matrix(this.node.getScreenCTM())}}}),_.Point=_.invent({create:function(t,e){var n,i={x:0,y:0};n=Array.isArray(t)?{x:t[0],y:t[1]}:"object"==typeof t?{x:t.x,y:t.y}:null!=t?{x:t,y:null!=e?e:t}:i,this.x=n.x,this.y=n.y},extend:{clone:function(){return new _.Point(this)},morph:function(t,e){return this.destination=new _.Point(t,e),this},at:function(t){return this.destination?new _.Point({x:this.x+(this.destination.x-this.x)*t,y:this.y+(this.destination.y-this.y)*t}):this},native:function(){var t=_.parser.native.createSVGPoint();return t.x=this.x,t.y=this.y,t},transform:function(t){return new _.Point(this.native().matrixTransform(t.native()))}}}),_.extend(_.Element,{point:function(t,e){return new _.Point(t,e).transform(this.screenCTM().inverse())}}),_.extend(_.Element,{attr:function(t,e,n){if(null==t){for(t={},e=this.node.attributes,n=e.length-1;n>=0;n--)t[e[n].nodeName]=_.regex.isNumber.test(e[n].nodeValue)?parseFloat(e[n].nodeValue):e[n].nodeValue;return t}if("object"==typeof t)for(e in t)this.attr(e,t[e]);else if(null===e)this.node.removeAttribute(t);else{if(null==e)return e=this.node.getAttribute(t),null==e?_.defaults.attrs[t]:_.regex.isNumber.test(e)?parseFloat(e):e;"stroke-width"==t?this.attr("stroke",parseFloat(e)>0?this._stroke:null):"stroke"==t&&(this._stroke=e),"fill"!=t&&"stroke"!=t||(_.regex.isImage.test(e)&&(e=this.doc().defs().image(e,0,0)),e instanceof _.Image&&(e=this.doc().defs().pattern(0,0,function(){this.add(e)}))),"number"==typeof e?e=new _.Number(e):_.Color.isColor(e)?e=new _.Color(e):Array.isArray(e)&&(e=new _.Array(e)),"leading"==t?this.leading&&this.leading(e):"string"==typeof n?this.node.setAttributeNS(n,t,e.toString()):this.node.setAttribute(t,e.toString()),!this.rebuild||"font-size"!=t&&"x"!=t||this.rebuild(t,e)}return this}}),_.extend(_.Element,{transform:function(t,e){var n,i,r=this;if("object"!=typeof t)return n=new _.Matrix(r).extract(),"string"==typeof t?n[t]:n;if(n=new _.Matrix(r),e=!!e||!!t.relative,null!=t.a)n=e?n.multiply(new _.Matrix(t)):new _.Matrix(t);else if(null!=t.rotation)p(t,r),n=e?n.rotate(t.rotation,t.cx,t.cy):n.rotate(t.rotation-n.extract().rotation,t.cx,t.cy);else if(null!=t.scale||null!=t.scaleX||null!=t.scaleY){if(p(t,r),t.scaleX=null!=t.scale?t.scale:null!=t.scaleX?t.scaleX:1,t.scaleY=null!=t.scale?t.scale:null!=t.scaleY?t.scaleY:1,!e){var o=n.extract();t.scaleX=1*t.scaleX/o.scaleX,t.scaleY=1*t.scaleY/o.scaleY}n=n.scale(t.scaleX,t.scaleY,t.cx,t.cy)}else if(null!=t.skew||null!=t.skewX||null!=t.skewY){if(p(t,r),t.skewX=null!=t.skew?t.skew:null!=t.skewX?t.skewX:0,t.skewY=null!=t.skew?t.skew:null!=t.skewY?t.skewY:0,!e){var o=n.extract();n=n.multiply((new _.Matrix).skew(o.skewX,o.skewY,t.cx,t.cy).inverse())}n=n.skew(t.skewX,t.skewY,t.cx,t.cy)}else t.flip?("x"==t.flip||"y"==t.flip?t.offset=null==t.offset?r.bbox()["c"+t.flip]:t.offset:null==t.offset?(i=r.bbox(),t.flip=i.cx,t.offset=i.cy):t.flip=t.offset,n=(new _.Matrix).flip(t.flip,t.offset)):null==t.x&&null==t.y||(e?n=n.translate(t.x,t.y):(null!=t.x&&(n.e=t.x),null!=t.y&&(n.f=t.y)));return this.attr("transform",n)}}),_.extend(_.FX,{transform:function(t,e){var n,i,r=this.target();return"object"!=typeof t?(n=new _.Matrix(r).extract(),"string"==typeof t?n[t]:n):(e=!!e||!!t.relative,null!=t.a?n=new _.Matrix(t):null!=t.rotation?(p(t,r),n=new _.Rotate(t.rotation,t.cx,t.cy)):null!=t.scale||null!=t.scaleX||null!=t.scaleY?(p(t,r),t.scaleX=null!=t.scale?t.scale:null!=t.scaleX?t.scaleX:1,t.scaleY=null!=t.scale?t.scale:null!=t.scaleY?t.scaleY:1,n=new _.Scale(t.scaleX,t.scaleY,t.cx,t.cy)):null!=t.skewX||null!=t.skewY?(p(t,r),t.skewX=null!=t.skewX?t.skewX:0,t.skewY=null!=t.skewY?t.skewY:0,n=new _.Skew(t.skewX,t.skewY,t.cx,t.cy)):t.flip?("x"==t.flip||"y"==t.flip?t.offset=null==t.offset?r.bbox()["c"+t.flip]:t.offset:null==t.offset?(i=r.bbox(),t.flip=i.cx,t.offset=i.cy):t.flip=t.offset,n=(new _.Matrix).flip(t.flip,t.offset)):null==t.x&&null==t.y||(n=new _.Translate(t.x,t.y)),n?(n.relative=e,this.last().transforms.push(n),this._callStart()):this)}}),_.extend(_.Element,{untransform:function(){return this.attr("transform",null)},matrixify:function(){return(this.attr("transform")||"").split(_.regex.transforms).slice(0,-1).map(function(t){var e=t.trim().split("(");return[e[0],e[1].split(_.regex.delimiter).map(function(t){return parseFloat(t)})]}).reduce(function(t,e){return"matrix"==e[0]?t.multiply(d(e[1])):t[e[0]].apply(t,e[1])},new _.Matrix)},toParent:function(t){if(this==t)return this;var e=this.screenCTM(),n=t.screenCTM().inverse();return this.addTo(t).untransform().transform(n.multiply(e)),this},toDoc:function(){return this.toParent(this.doc())}}),_.Transformation=_.invent({create:function(t,e){if(arguments.length>1&&"boolean"!=typeof e)return this.constructor.call(this,[].slice.call(arguments));if(Array.isArray(t))for(var n=0,i=this.arguments.length;n<i;++n)this[this.arguments[n]]=t[n];else if("object"==typeof t)for(var n=0,i=this.arguments.length;n<i;++n)this[this.arguments[n]]=t[this.arguments[n]];this.inversed=!1,!0===e&&(this.inversed=!0)},extend:{arguments:[],method:"",at:function(t){for(var e=[],n=0,i=this.arguments.length;n<i;++n)e.push(this[this.arguments[n]]);var r=this._undo||new _.Matrix;return r=(new _.Matrix).morph(_.Matrix.prototype[this.method].apply(r,e)).at(t),this.inversed?r.inverse():r},undo:function(t){for(var e=0,n=this.arguments.length;e<n;++e)t[this.arguments[e]]=void 0===this[this.arguments[e]]?0:t[this.arguments[e]];return t.cx=this.cx,t.cy=this.cy,this._undo=new(_[s(this.method)])(t,!0).at(1),this}}}),_.Translate=_.invent({parent:_.Matrix,inherit:_.Transformation,create:function(t,e){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["transformedX","transformedY"],method:"translate"}}),_.Rotate=_.invent({parent:_.Matrix,inherit:_.Transformation,create:function(t,e){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["rotation","cx","cy"],method:"rotate",at:function(t){var e=(new _.Matrix).rotate((new _.Number).morph(this.rotation-(this._undo?this._undo.rotation:0)).at(t),this.cx,this.cy);return this.inversed?e.inverse():e},undo:function(t){return this._undo=t,this}}}),_.Scale=_.invent({parent:_.Matrix,inherit:_.Transformation,create:function(t,e){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["scaleX","scaleY","cx","cy"],method:"scale"}}),_.Skew=_.invent({parent:_.Matrix,inherit:_.Transformation,create:function(t,e){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["skewX","skewY","cx","cy"],method:"skew"}}),_.extend(_.Element,{style:function(t,e){if(0==arguments.length)return this.node.style.cssText||"";if(arguments.length<2)if("object"==typeof t)for(e in t)this.style(e,t[e]);else{if(!_.regex.isCss.test(t))return this.node.style[a(t)];for(t=t.split(/\s*;\s*/).filter(function(t){return!!t}).map(function(t){return t.split(/\s*:\s*/)});e=t.pop();)this.style(e[0],e[1])}else this.node.style[a(t)]=null===e||_.regex.isBlank.test(e)?"":e;return this}}),_.Parent=_.invent({create:function(t){this.constructor.call(this,t)},inherit:_.Element,extend:{children:function(){return _.utils.map(_.utils.filterSVGElements(this.node.childNodes),function(t){return _.adopt(t)})},add:function(t,e){return null==e?this.node.appendChild(t.node):t.node!=this.node.childNodes[e]&&this.node.insertBefore(t.node,this.node.childNodes[e]),this},put:function(t,e){return this.add(t,e),t},has:function(t){return this.index(t)>=0},index:function(t){return[].slice.call(this.node.childNodes).indexOf(t.node)},get:function(t){return _.adopt(this.node.childNodes[t])},first:function(){return this.get(0)},last:function(){return this.get(this.node.childNodes.length-1)},each:function(t,e){var n,i,r=this.children();for(n=0,i=r.length;n<i;n++)r[n]instanceof _.Element&&t.apply(r[n],[n,r]),e&&r[n]instanceof _.Container&&r[n].each(t,e);return this},removeElement:function(t){return this.node.removeChild(t.node),this},clear:function(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return delete this._defs,this},defs:function(){return this.doc().defs()}}}),_.extend(_.Parent,{ungroup:function(t,e){return 0===e||this instanceof _.Defs||this.node==_.parser.draw?this:(t=t||(this instanceof _.Doc?this:this.parent(_.Parent)),e=e||1/0,this.each(function(){return this instanceof _.Defs?this:this instanceof _.Parent?this.ungroup(t,e-1):this.toParent(t)}),this.node.firstChild||this.remove(),this)},flatten:function(t,e){return this.ungroup(t,e)}}),_.Container=_.invent({create:function(t){this.constructor.call(this,t)},inherit:_.Parent}),_.ViewBox=_.invent({create:function(t){var e,n,i,r,o,a,s,l=[0,0,0,0],u=1,h=1,c=/[+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?/gi;if(t instanceof _.Element){for(a=t,s=t,o=(t.attr("viewBox")||"").match(c),t.bbox,i=new _.Number(t.width()),r=new _.Number(t.height());"%"==i.unit;)u*=i.value,i=new _.Number(a instanceof _.Doc?a.parent().offsetWidth:a.parent().width()),a=a.parent();for(;"%"==r.unit;)h*=r.value,r=new _.Number(s instanceof _.Doc?s.parent().offsetHeight:s.parent().height()),s=s.parent();this.x=0,this.y=0,this.width=i*u,this.height=r*h,this.zoom=1,o&&(e=parseFloat(o[0]),n=parseFloat(o[1]),i=parseFloat(o[2]),r=parseFloat(o[3]),this.zoom=this.width/this.height>i/r?this.height/r:this.width/i,this.x=e,this.y=n,this.width=i,this.height=r)}else t="string"==typeof t?t.match(c).map(function(t){return parseFloat(t)}):Array.isArray(t)?t:"object"==typeof t?[t.x,t.y,t.width,t.height]:4==arguments.length?[].slice.call(arguments):l,this.x=t[0],this.y=t[1],this.width=t[2],this.height=t[3]},extend:{toString:function(){return this.x+" "+this.y+" "+this.width+" "+this.height},morph:function(t,e,n,i){return this.destination=new _.ViewBox(t,e,n,i),this},at:function(t){return this.destination?new _.ViewBox([this.x+(this.destination.x-this.x)*t,this.y+(this.destination.y-this.y)*t,this.width+(this.destination.width-this.width)*t,this.height+(this.destination.height-this.height)*t]):this}},parent:_.Container,construct:{viewbox:function(t,e,n,i){return 0==arguments.length?new _.ViewBox(this):this.attr("viewBox",new _.ViewBox(t,e,n,i))}}}),["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","touchstart","touchmove","touchleave","touchend","touchcancel"].forEach(function(t){_.Element.prototype[t]=function(e){return _.on(this.node,t,e),this}}),_.listeners=[],_.handlerMap=[],_.listenerId=0,_.on=function(t,e,n,i,r){var o=n.bind(i||t.instance||t),a=(_.handlerMap.indexOf(t)+1||_.handlerMap.push(t))-1,s=e.split(".")[0],l=e.split(".")[1]||"*";_.listeners[a]=_.listeners[a]||{},_.listeners[a][s]=_.listeners[a][s]||{},_.listeners[a][s][l]=_.listeners[a][s][l]||{},n._svgjsListenerId||(n._svgjsListenerId=++_.listenerId),_.listeners[a][s][l][n._svgjsListenerId]=o,t.addEventListener(s,o,r||!1)},_.off=function(t,e,n){var i=_.handlerMap.indexOf(t),r=e&&e.split(".")[0],o=e&&e.split(".")[1],a="";if(-1!=i)if(n){if("function"==typeof n&&(n=n._svgjsListenerId),!n)return;_.listeners[i][r]&&_.listeners[i][r][o||"*"]&&(t.removeEventListener(r,_.listeners[i][r][o||"*"][n],!1),delete _.listeners[i][r][o||"*"][n])}else if(o&&r){if(_.listeners[i][r]&&_.listeners[i][r][o]){for(n in _.listeners[i][r][o])_.off(t,[r,o].join("."),n);delete _.listeners[i][r][o]}}else if(o)for(e in _.listeners[i])for(a in _.listeners[i][e])o===a&&_.off(t,[e,o].join("."));else if(r){if(_.listeners[i][r]){for(a in _.listeners[i][r])_.off(t,[r,a].join("."));delete _.listeners[i][r]}}else{for(e in _.listeners[i])_.off(t,e);delete _.listeners[i],delete _.handlerMap[i]}},_.extend(_.Element,{on:function(t,e,n,i){return _.on(this.node,t,e,n,i),this},off:function(t,e){return _.off(this.node,t,e),this},fire:function(e,n){return e instanceof t.Event?this.node.dispatchEvent(e):this.node.dispatchEvent(e=new t.CustomEvent(e,{detail:n,cancelable:!0})),this._event=e,this},event:function(){return this._event}}),_.Defs=_.invent({create:"defs",inherit:_.Container}),_.G=_.invent({create:"g",inherit:_.Container,extend:{x:function(t){return null==t?this.transform("x"):this.transform({x:t-this.x()},!0)},y:function(t){return null==t?this.transform("y"):this.transform({y:t-this.y()},!0)},cx:function(t){return null==t?this.gbox().cx:this.x(t-this.gbox().width/2)},cy:function(t){return null==t?this.gbox().cy:this.y(t-this.gbox().height/2)},gbox:function(){var t=this.bbox(),e=this.transform();return t.x+=e.x,t.x2+=e.x,t.cx+=e.x,t.y+=e.y,t.y2+=e.y,t.cy+=e.y,t}},construct:{group:function(){return this.put(new _.G)}}}),_.extend(_.Element,{siblings:function(){return this.parent().children()},position:function(){return this.parent().index(this)},next:function(){return this.siblings()[this.position()+1]},previous:function(){return this.siblings()[this.position()-1]},forward:function(){var t=this.position()+1,e=this.parent();return e.removeElement(this).add(this,t),e instanceof _.Doc&&e.node.appendChild(e.defs().node),this},backward:function(){var t=this.position();return t>0&&this.parent().removeElement(this).add(this,t-1),this},front:function(){var t=this.parent();return t.node.appendChild(this.node),t instanceof _.Doc&&t.node.appendChild(t.defs().node),this},back:function(){return this.position()>0&&this.parent().removeElement(this).add(this,0),this},before:function(t){t.remove();var e=this.position();return this.parent().add(t,e),this},after:function(t){t.remove();var e=this.position();return this.parent().add(t,e+1),this}}),_.Mask=_.invent({create:function(){this.constructor.call(this,_.create("mask")),this.targets=[]},inherit:_.Container,extend:{remove:function(){for(var t=this.targets.length-1;t>=0;t--)this.targets[t]&&this.targets[t].unmask();return this.targets=[],this.parent().removeElement(this),this}},construct:{mask:function(){return this.defs().put(new _.Mask)}}}),_.extend(_.Element,{maskWith:function(t){return this.masker=t instanceof _.Mask?t:this.parent().mask().add(t),this.masker.targets.push(this),this.attr("mask",'url("#'+this.masker.attr("id")+'")')},unmask:function(){return delete this.masker,this.attr("mask",null)}}),_.ClipPath=_.invent({create:function(){this.constructor.call(this,_.create("clipPath")),this.targets=[]},inherit:_.Container,extend:{remove:function(){for(var t=this.targets.length-1;t>=0;t--)this.targets[t]&&this.targets[t].unclip();return this.targets=[],this.parent().removeElement(this),this}},construct:{clip:function(){return this.defs().put(new _.ClipPath)}}}),_.extend(_.Element,{clipWith:function(t){return this.clipper=t instanceof _.ClipPath?t:this.parent().clip().add(t),this.clipper.targets.push(this),this.attr("clip-path",'url("#'+this.clipper.attr("id")+'")')},unclip:function(){return delete this.clipper,this.attr("clip-path",null)}}),_.Gradient=_.invent({create:function(t){this.constructor.call(this,_.create(t+"Gradient")),this.type=t},inherit:_.Container,extend:{at:function(t,e,n){return this.put(new _.Stop).update(t,e,n)},update:function(t){return this.clear(),"function"==typeof t&&t.call(this,this),this},fill:function(){return"url(#"+this.id()+")"},toString:function(){return this.fill()},attr:function(t,e,n){return"transform"==t&&(t="gradientTransform"),_.Container.prototype.attr.call(this,t,e,n)}},construct:{gradient:function(t,e){return this.defs().gradient(t,e)}}}),_.extend(_.Gradient,_.FX,{from:function(t,e){return"radial"==(this._target||this).type?this.attr({fx:new _.Number(t),fy:new _.Number(e)}):this.attr({x1:new _.Number(t),y1:new _.Number(e)})},to:function(t,e){return"radial"==(this._target||this).type?this.attr({cx:new _.Number(t),cy:new _.Number(e)}):this.attr({x2:new _.Number(t),y2:new _.Number(e)})}}),_.extend(_.Defs,{gradient:function(t,e){return this.put(new _.Gradient(t)).update(e)}}),_.Stop=_.invent({create:"stop",inherit:_.Element,extend:{update:function(t){return("number"==typeof t||t instanceof _.Number)&&(t={offset:arguments[0],color:arguments[1],opacity:arguments[2]}),null!=t.opacity&&this.attr("stop-opacity",t.opacity),null!=t.color&&this.attr("stop-color",t.color),null!=t.offset&&this.attr("offset",new _.Number(t.offset)),this}}}),_.Pattern=_.invent({create:"pattern",inherit:_.Container,extend:{fill:function(){return"url(#"+this.id()+")"},update:function(t){return this.clear(),"function"==typeof t&&t.call(this,this),this},toString:function(){return this.fill()},attr:function(t,e,n){return"transform"==t&&(t="patternTransform"),_.Container.prototype.attr.call(this,t,e,n)}},construct:{pattern:function(t,e,n){return this.defs().pattern(t,e,n)}}}),_.extend(_.Defs,{pattern:function(t,e,n){return this.put(new _.Pattern).update(n).attr({x:0,y:0,width:t,height:e,patternUnits:"userSpaceOnUse"})}}),_.Doc=_.invent({create:function(t){t&&(t="string"==typeof t?e.getElementById(t):t,"svg"==t.nodeName?this.constructor.call(this,t):(this.constructor.call(this,_.create("svg")),t.appendChild(this.node),this.size("100%","100%")),this.namespace().defs())},inherit:_.Container,extend:{namespace:function(){return this.attr({xmlns:_.ns,version:"1.1"}).attr("xmlns:xlink",_.xlink,_.xmlns).attr("xmlns:svgjs",_.svgjs,_.xmlns)},defs:function(){if(!this._defs){var t;(t=this.node.getElementsByTagName("defs")[0])?this._defs=_.adopt(t):this._defs=new _.Defs,this.node.appendChild(this._defs.node)}return this._defs},parent:function(){return"#document"==this.node.parentNode.nodeName?null:this.node.parentNode},spof:function(t){var e=this.node.getScreenCTM();return e&&this.style("left",-e.e%1+"px").style("top",-e.f%1+"px"),this},remove:function(){return this.parent()&&this.parent().removeChild(this.node),this},clear:function(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return delete this._defs,_.parser.draw.parentNode||this.node.appendChild(_.parser.draw),this}}}),_.Shape=_.invent({create:function(t){this.constructor.call(this,t)},inherit:_.Element}),_.Bare=_.invent({create:function(t,e){if(this.constructor.call(this,_.create(t)),e)for(var n in e.prototype)"function"==typeof e.prototype[n]&&(this[n]=e.prototype[n])},inherit:_.Element,extend:{words:function(t){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return this.node.appendChild(e.createTextNode(t)),this}}}),_.extend(_.Parent,{element:function(t,e){return this.put(new _.Bare(t,e))}}),_.Symbol=_.invent({create:"symbol",inherit:_.Container,construct:{symbol:function(){return this.put(new _.Symbol)}}}),_.Use=_.invent({create:"use",inherit:_.Shape,extend:{element:function(t,e){return this.attr("href",(e||"")+"#"+t,_.xlink)}},construct:{use:function(t,e){return this.put(new _.Use).element(t,e)}}}),_.Rect=_.invent({create:"rect",inherit:_.Shape,construct:{rect:function(t,e){return this.put(new _.Rect).size(t,e)}}}),_.Circle=_.invent({create:"circle",inherit:_.Shape,construct:{circle:function(t){return this.put(new _.Circle).rx(new _.Number(t).divide(2)).move(0,0)}}}),_.extend(_.Circle,_.FX,{rx:function(t){return this.attr("r",t)},ry:function(t){return this.rx(t)}}),_.Ellipse=_.invent({create:"ellipse",inherit:_.Shape,construct:{ellipse:function(t,e){return this.put(new _.Ellipse).size(t,e).move(0,0)}}}),_.extend(_.Ellipse,_.Rect,_.FX,{rx:function(t){return this.attr("rx",t)},ry:function(t){return this.attr("ry",t)}}),_.extend(_.Circle,_.Ellipse,{x:function(t){return null==t?this.cx()-this.rx():this.cx(t+this.rx())},y:function(t){return null==t?this.cy()-this.ry():this.cy(t+this.ry())},cx:function(t){return null==t?this.attr("cx"):this.attr("cx",t)},cy:function(t){return null==t?this.attr("cy"):this.attr("cy",t)},width:function(t){return null==t?2*this.rx():this.rx(new _.Number(t).divide(2))},height:function(t){return null==t?2*this.ry():this.ry(new _.Number(t).divide(2))},size:function(t,e){var n=h(this,t,e);return this.rx(new _.Number(n.width).divide(2)).ry(new _.Number(n.height).divide(2))}}),_.Line=_.invent({create:"line",inherit:_.Shape,extend:{array:function(){return new _.PointArray([[this.attr("x1"),this.attr("y1")],[this.attr("x2"),this.attr("y2")]])},plot:function(t,e,n,i){return null==t?this.array():(t=void 0!==e?{x1:t,y1:e,x2:n,y2:i}:new _.PointArray(t).toLine(),this.attr(t))},move:function(t,e){return this.attr(this.array().move(t,e).toLine())},size:function(t,e){var n=h(this,t,e);return this.attr(this.array().size(n.width,n.height).toLine())}},construct:{line:function(t,e,n,i){return _.Line.prototype.plot.apply(this.put(new _.Line),null!=t?[t,e,n,i]:[0,0,0,0])}}}),_.Polyline=_.invent({create:"polyline",inherit:_.Shape,construct:{polyline:function(t){return this.put(new _.Polyline).plot(t||new _.PointArray)}}}),_.Polygon=_.invent({create:"polygon",inherit:_.Shape,construct:{polygon:function(t){return this.put(new _.Polygon).plot(t||new _.PointArray)}}}),_.extend(_.Polyline,_.Polygon,{array:function(){return this._array||(this._array=new _.PointArray(this.attr("points")))},plot:function(t){return null==t?this.array():this.clear().attr("points","string"==typeof t?t:this._array=new _.PointArray(t))},clear:function(){return delete this._array,this},move:function(t,e){return this.attr("points",this.array().move(t,e))},size:function(t,e){var n=h(this,t,e);return this.attr("points",this.array().size(n.width,n.height))}}),_.extend(_.Line,_.Polyline,_.Polygon,{morphArray:_.PointArray,x:function(t){return null==t?this.bbox().x:this.move(t,this.bbox().y)},y:function(t){return null==t?this.bbox().y:this.move(this.bbox().x,t)},width:function(t){var e=this.bbox();return null==t?e.width:this.size(t,e.height)},height:function(t){var e=this.bbox();return null==t?e.height:this.size(e.width,t)}}),_.Path=_.invent({create:"path",inherit:_.Shape,extend:{morphArray:_.PathArray,array:function(){return this._array||(this._array=new _.PathArray(this.attr("d")))},plot:function(t){return null==t?this.array():this.clear().attr("d","string"==typeof t?t:this._array=new _.PathArray(t))},clear:function(){return delete this._array,this},move:function(t,e){return this.attr("d",this.array().move(t,e))},x:function(t){return null==t?this.bbox().x:this.move(t,this.bbox().y)},y:function(t){return null==t?this.bbox().y:this.move(this.bbox().x,t)},size:function(t,e){var n=h(this,t,e);return this.attr("d",this.array().size(n.width,n.height))},width:function(t){return null==t?this.bbox().width:this.size(t,this.bbox().height)},height:function(t){return null==t?this.bbox().height:this.size(this.bbox().width,t)}},construct:{path:function(t){return this.put(new _.Path).plot(t||new _.PathArray)}}}),_.Image=_.invent({create:"image",inherit:_.Shape,extend:{load:function(e){if(!e)return this;var n=this,i=new t.Image;return _.on(i,"load",function(){var t=n.parent(_.Pattern);null!==t&&(0==n.width()&&0==n.height()&&n.size(i.width,i.height),t&&0==t.width()&&0==t.height()&&t.size(n.width(),n.height()),"function"==typeof n._loaded&&n._loaded.call(n,{width:i.width,height:i.height,ratio:i.width/i.height,url:e}))}),_.on(i,"error",function(t){"function"==typeof n._error&&n._error.call(n,t)}),this.attr("href",i.src=this.src=e,_.xlink)},loaded:function(t){return this._loaded=t,this},error:function(t){return this._error=t,this}},construct:{image:function(t,e,n){return this.put(new _.Image).load(t).size(e||0,n||e||0)}}}),_.Text=_.invent({create:function(){this.constructor.call(this,_.create("text")),this.dom.leading=new _.Number(1.3),this._rebuild=!0,this._build=!1,this.attr("font-family",_.defaults.attrs["font-family"])},inherit:_.Shape,extend:{x:function(t){return null==t?this.attr("x"):this.attr("x",t)},y:function(t){var e=this.attr("y"),n="number"==typeof e?e-this.bbox().y:0;return null==t?"number"==typeof e?e-n:e:this.attr("y","number"==typeof t?t+n:t)},cx:function(t){return null==t?this.bbox().cx:this.x(t-this.bbox().width/2)},cy:function(t){return null==t?this.bbox().cy:this.y(t-this.bbox().height/2)},text:function(t){if(void 0===t){for(var t="",e=this.node.childNodes,n=0,i=e.length;n<i;++n)0!=n&&3!=e[n].nodeType&&1==_.adopt(e[n]).dom.newLined&&(t+="\n"),t+=e[n].textContent;return t}if(this.clear().build(!0),"function"==typeof t)t.call(this,this);else{t=t.split("\n");for(var n=0,r=t.length;n<r;n++)this.tspan(t[n]).newLine()}return this.build(!1).rebuild()},size:function(t){return this.attr("font-size",t).rebuild()},leading:function(t){return null==t?this.dom.leading:(this.dom.leading=new _.Number(t),this.rebuild())},lines:function(){var t=(this.textPath&&this.textPath()||this).node,e=_.utils.map(_.utils.filterSVGElements(t.childNodes),function(t){return _.adopt(t)});return new _.Set(e)},rebuild:function(t){if("boolean"==typeof t&&(this._rebuild=t),this._rebuild){var e=this,n=0,i=this.dom.leading*new _.Number(this.attr("font-size"));this.lines().each(function(){this.dom.newLined&&(e.textPath()||this.attr("x",e.attr("x")),"\n"==this.text()?n+=i:(this.attr("dy",i+n),n=0))}),this.fire("rebuild")}return this},build:function(t){return this._build=!!t,this},setData:function(t){return this.dom=t,this.dom.leading=new _.Number(t.leading||1.3),this}},construct:{text:function(t){return this.put(new _.Text).text(t)},plain:function(t){return this.put(new _.Text).plain(t)}}}),_.Tspan=_.invent({create:"tspan",inherit:_.Shape,extend:{text:function(t){return null==t?this.node.textContent+(this.dom.newLined?"\n":""):("function"==typeof t?t.call(this,this):this.plain(t),this)},dx:function(t){return this.attr("dx",t)},dy:function(t){return this.attr("dy",t)},newLine:function(){var t=this.parent(_.Text);return this.dom.newLined=!0,this.dy(t.dom.leading*t.attr("font-size")).attr("x",t.x())}}}),_.extend(_.Text,_.Tspan,{plain:function(t){return!1===this._build&&this.clear(),this.node.appendChild(e.createTextNode(t)),this},tspan:function(t){var e=(this.textPath&&this.textPath()||this).node,n=new _.Tspan;return!1===this._build&&this.clear(),e.appendChild(n.node),n.text(t)},clear:function(){for(var t=(this.textPath&&this.textPath()||this).node;t.hasChildNodes();)t.removeChild(t.lastChild);return this},length:function(){return this.node.getComputedTextLength()}}),_.TextPath=_.invent({create:"textPath",inherit:_.Parent,parent:_.Text,construct:{path:function(t){for(var e=new _.TextPath,n=this.doc().defs().path(t);this.node.hasChildNodes();)e.node.appendChild(this.node.firstChild);return this.node.appendChild(e.node),e.attr("href","#"+n,_.xlink),this},array:function(){var t=this.track();return t?t.array():null},plot:function(t){var e=this.track(),n=null;return e&&(n=e.plot(t)),null==t?n:this},track:function(){var t=this.textPath();if(t)return t.reference("href")},textPath:function(){if(this.node.firstChild&&"textPath"==this.node.firstChild.nodeName)return _.adopt(this.node.firstChild)}}}),_.Nested=_.invent({create:function(){this.constructor.call(this,_.create("svg")),this.style("overflow","visible")},inherit:_.Container,construct:{nested:function(){return this.put(new _.Nested)}}}),_.A=_.invent({create:"a",inherit:_.Container,extend:{to:function(t){return this.attr("href",t,_.xlink)},show:function(t){return this.attr("show",t,_.xlink)},target:function(t){return this.attr("target",t)}},construct:{link:function(t){return this.put(new _.A).to(t)}}}),_.extend(_.Element,{linkTo:function(t){var e=new _.A;return"function"==typeof t?t.call(e,e):e.to(t),this.parent().put(e).put(this)}}),_.Marker=_.invent({create:"marker",inherit:_.Container,extend:{width:function(t){return this.attr("markerWidth",t)},height:function(t){return this.attr("markerHeight",t)},ref:function(t,e){return this.attr("refX",t).attr("refY",e)},update:function(t){return this.clear(),"function"==typeof t&&t.call(this,this),this},toString:function(){return"url(#"+this.id()+")"}},construct:{marker:function(t,e,n){return this.defs().marker(t,e,n)}}}),_.extend(_.Defs,{marker:function(t,e,n){return this.put(new _.Marker).size(t,e).ref(t/2,e/2).viewbox(0,0,t,e).attr("orient","auto").update(n)}}),_.extend(_.Line,_.Polyline,_.Polygon,_.Path,{marker:function(t,e,n,i){var r=["marker"];return"all"!=t&&r.push(t),r=r.join("-"),t=arguments[1]instanceof _.Marker?arguments[1]:this.doc().marker(e,n,i),this.attr(r,t)}});var P={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(t,e){return"color"==e?t:t+"-"+e}};["fill","stroke"].forEach(function(t){var e,n={};n[t]=function(n){if(void 0===n)return this;if("string"==typeof n||_.Color.isRgb(n)||n&&"function"==typeof n.fill)this.attr(t,n);else for(e=P[t].length-1;e>=0;e--)null!=n[P[t][e]]&&this.attr(P.prefix(t,P[t][e]),n[P[t][e]]);return this},_.extend(_.Element,_.FX,n)}),_.extend(_.Element,_.FX,{rotate:function(t,e,n){return this.transform({rotation:t,cx:e,cy:n})},skew:function(t,e,n,i){return 1==arguments.length||3==arguments.length?this.transform({skew:t,cx:e,cy:n}):this.transform({skewX:t,skewY:e,cx:n,cy:i})},scale:function(t,e,n,i){return 1==arguments.length||3==arguments.length?this.transform({scale:t,cx:e,cy:n}):this.transform({scaleX:t,scaleY:e,cx:n,cy:i})},translate:function(t,e){return this.transform({x:t,y:e})},flip:function(t,e){return e="number"==typeof t?t:e,this.transform({flip:t||"both",offset:e})},matrix:function(t){return this.attr("transform",new _.Matrix(6==arguments.length?[].slice.call(arguments):t))},opacity:function(t){return this.attr("opacity",t)},dx:function(t){return this.x(new _.Number(t).plus(this instanceof _.FX?0:this.x()),!0)},dy:function(t){return this.y(new _.Number(t).plus(this instanceof _.FX?0:this.y()),!0)},dmove:function(t,e){return this.dx(t).dy(e)}}),_.extend(_.Rect,_.Ellipse,_.Circle,_.Gradient,_.FX,{radius:function(t,e){var n=(this._target||this).type;return"radial"==n||"circle"==n?this.attr("r",new _.Number(t)):this.rx(t).ry(null==e?t:e)}}),_.extend(_.Path,{length:function(){return this.node.getTotalLength()},pointAt:function(t){return this.node.getPointAtLength(t)}}),_.extend(_.Parent,_.Text,_.Tspan,_.FX,{font:function(t,e){if("object"==typeof t)for(e in t)this.font(e,t[e]);return"leading"==t?this.leading(e):"anchor"==t?this.attr("text-anchor",e):"size"==t||"family"==t||"weight"==t||"stretch"==t||"variant"==t||"style"==t?this.attr("font-"+t,e):this.attr(t,e)}}),_.Set=_.invent({create:function(t){Array.isArray(t)?this.members=t:this.clear()},extend:{add:function(){var t,e,n=[].slice.call(arguments);for(t=0,e=n.length;t<e;t++)this.members.push(n[t]);return this},remove:function(t){var e=this.index(t);return e>-1&&this.members.splice(e,1),this},each:function(t){for(var e=0,n=this.members.length;e<n;e++)t.apply(this.members[e],[e,this.members]);return this},clear:function(){return this.members=[],this},length:function(){return this.members.length},has:function(t){return this.index(t)>=0},index:function(t){return this.members.indexOf(t)},get:function(t){return this.members[t]},first:function(){return this.get(0)},last:function(){return this.get(this.members.length-1)},valueOf:function(){return this.members},bbox:function(){if(0==this.members.length)return new _.RBox;var t=this.members[0].rbox(this.members[0].doc());return this.each(function(){t=t.merge(this.rbox(this.doc()))}),t}},construct:{set:function(t){return new _.Set(t)}}}),_.FX.Set=_.invent({create:function(t){this.set=t}}),_.Set.inherit=function(){var t,e=[];for(var t in _.Shape.prototype)"function"==typeof _.Shape.prototype[t]&&"function"!=typeof _.Set.prototype[t]&&e.push(t);e.forEach(function(t){_.Set.prototype[t]=function(){for(var e=0,n=this.members.length;e<n;e++)this.members[e]&&"function"==typeof this.members[e][t]&&this.members[e][t].apply(this.members[e],arguments);return"animate"==t?this.fx||(this.fx=new _.FX.Set(this)):this}}),e=[];for(var t in _.FX.prototype)"function"==typeof _.FX.prototype[t]&&"function"!=typeof _.FX.Set.prototype[t]&&e.push(t);e.forEach(function(t){_.FX.Set.prototype[t]=function(){for(var e=0,n=this.set.members.length;e<n;e++)this.set.members[e].fx[t].apply(this.set.members[e].fx,arguments);return this}})},_.extend(_.Element,{data:function(t,e,n){if("object"==typeof t)for(e in t)this.data(e,t[e]);else if(arguments.length<2)try{return JSON.parse(this.attr("data-"+t))}catch(e){return this.attr("data-"+t)}else this.attr("data-"+t,null===e?null:!0===n||"string"==typeof e||"number"==typeof e?e:JSON.stringify(e));return this}}),_.extend(_.Element,{remember:function(t,e){if("object"==typeof arguments[0])for(var e in t)this.remember(e,t[e]);else{if(1==arguments.length)return this.memory()[t];this.memory()[t]=e}return this},forget:function(){if(0==arguments.length)this._memory={};else for(var t=arguments.length-1;t>=0;t--)delete this.memory()[arguments[t]];return this},memory:function(){return this._memory||(this._memory={})}}),_.get=function(t){var n=e.getElementById(y(t)||t);return _.adopt(n)},_.select=function(t,n){return new _.Set(_.utils.map((n||e).querySelectorAll(t),function(t){return _.adopt(t)}))},_.extend(_.Parent,{select:function(t){return _.select(t,this.node)}});var M="abcdef".split("");if("function"!=typeof t.CustomEvent){var S=function(t,n){n=n||{bubbles:!1,cancelable:!1,detail:void 0};var i=e.createEvent("CustomEvent");return i.initCustomEvent(t,n.bubbles,n.cancelable,n.detail),i};S.prototype=t.Event.prototype,t.CustomEvent=S}return function(e){for(var n=0,i=["moz","webkit"],r=0;r<i.length&&!t.requestAnimationFrame;++r)e.requestAnimationFrame=e[i[r]+"RequestAnimationFrame"],e.cancelAnimationFrame=e[i[r]+"CancelAnimationFrame"]||e[i[r]+"CancelRequestAnimationFrame"];e.requestAnimationFrame=e.requestAnimationFrame||function(t){var i=(new Date).getTime(),r=Math.max(0,16-(i-n)),o=e.setTimeout(function(){t(i+r)},r);return n=i+r,o},e.cancelAnimationFrame=e.cancelAnimationFrame||e.clearTimeout}(t),_})},function(t,e,n){"use strict";function i(){a.a.call(this),this.type="Camera",this.matrixWorldInverse=new r.a,this.projectionMatrix=new r.a}n.d(e,"a",function(){return i});var r=n(5),o=n(14),a=n(6),s=n(0);i.prototype=Object.assign(Object.create(a.a.prototype),{constructor:i,isCamera:!0,copy:function(t){return a.a.prototype.copy.call(this,t),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},getWorldDirection:function(){var t=new o.a;return function(e){var n=e||new s.a;return this.getWorldQuaternion(t),n.set(0,0,-1).applyQuaternion(t)}}(),clone:function(){return(new this.constructor).copy(this)}})},function(t,e,n){"use strict";function i(t,e,n,i,a,s){this.a=t,this.b=e,this.c=n,this.normal=i&&i.isVector3?i:new o.a,this.vertexNormals=Array.isArray(i)?i:[],this.color=a&&a.isColor?a:new r.a,this.vertexColors=Array.isArray(a)?a:[],this.materialIndex=void 0!==s?s:0}n.d(e,"a",function(){return i});var r=n(3),o=n(0);Object.assign(i.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(var e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}})},function(t,e,n){"use strict";function i(t,e,n,i){o.b.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new r(t,e,n,i)),this.mergeVertices()}function r(t,e,n,i){a.a.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};var r,o,l=t/2,u=e/2,h=Math.floor(n)||1,c=Math.floor(i)||1,d=h+1,f=c+1,p=t/h,m=e/c,v=[],g=[],y=[],_=[];for(o=0;o<f;o++){var x=o*m-u;for(r=0;r<d;r++){var b=r*p-l;g.push(b,-x,0),y.push(0,0,1),_.push(r/h),_.push(1-o/c)}}for(o=0;o<c;o++)for(r=0;r<h;r++){var w=r+d*o,E=r+d*(o+1),P=r+1+d*(o+1),M=r+1+d*o;v.push(w,E,M),v.push(E,P,M)}this.setIndex(v),this.addAttribute("position",new s.a(g,3)),this.addAttribute("normal",new s.a(y,3)),this.addAttribute("uv",new s.a(_,2))}n.d(e,"a",function(){return i}),n.d(e,"b",function(){return r});var o=n(18),a=n(7),s=n(12);i.prototype=Object.create(o.b.prototype),i.prototype.constructor=i,r.prototype=Object.create(a.a.prototype),r.prototype.constructor=r},function(t,e,n){"use strict";function i(t){r.a.call(this),this.type="LineBasicMaterial",this.color=new o.a(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(t)}n.d(e,"a",function(){return i});var r=n(9),o=n(3);i.prototype=Object.create(r.a.prototype),i.prototype.constructor=i,i.prototype.isLineBasicMaterial=!0,i.prototype.copy=function(t){return r.a.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this}},function(t,e,n){"use strict";function i(t){r.a.call(this),this.type="MeshBasicMaterial",this.color=new a.a(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=o.b,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(t)}n.d(e,"a",function(){return i});var r=n(9),o=n(1),a=n(3);i.prototype=Object.create(r.a.prototype),i.prototype.constructor=i,i.prototype.isMeshBasicMaterial=!0,i.prototype.copy=function(t){return r.a.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this}},function(t,e,n){"use strict";function i(t){r.a.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}n.d(e,"a",function(){return i});var r=n(9),o=n(16);i.prototype=Object.create(r.a.prototype),i.prototype.constructor=i,i.prototype.isShaderMaterial=!0,i.prototype.copy=function(t){return r.a.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=o.a.clone(t.uniforms),this.defines=t.defines,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},i.prototype.toJSON=function(t){var e=r.a.prototype.toJSON.call(this,t);return e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e}},function(t,e,n){"use strict";function i(t,e,n,i,r,o){this.planes=[void 0!==t?t:new a.a,void 0!==e?e:new a.a,void 0!==n?n:new a.a,void 0!==i?i:new a.a,void 0!==r?r:new a.a,void 0!==o?o:new a.a]}n.d(e,"a",function(){return i});var r=n(0),o=n(10),a=n(20);Object.assign(i.prototype,{set:function(t,e,n,i,r,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;n<6;n++)e[n].copy(t.planes[n]);return this},setFromMatrix:function(t){var e=this.planes,n=t.elements,i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],l=n[5],u=n[6],h=n[7],c=n[8],d=n[9],f=n[10],p=n[11],m=n[12],v=n[13],g=n[14],y=n[15];return e[0].setComponents(a-i,h-s,p-c,y-m).normalize(),e[1].setComponents(a+i,h+s,p+c,y+m).normalize(),e[2].setComponents(a+r,h+l,p+d,y+v).normalize(),e[3].setComponents(a-r,h-l,p-d,y-v).normalize(),e[4].setComponents(a-o,h-u,p-f,y-g).normalize(),e[5].setComponents(a+o,h+u,p+f,y+g).normalize(),this},intersectsObject:function(){var t=new o.a;return function(e){var n=e.geometry;return null===n.boundingSphere&&n.computeBoundingSphere(),t.copy(n.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSprite:function(){var t=new o.a;return function(e){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,n=t.center,i=-t.radius,r=0;r<6;r++){if(e[r].distanceToPoint(n)<i)return!1}return!0},intersectsBox:function(){var t=new r.a,e=new r.a;return function(n){for(var i=this.planes,r=0;r<6;r++){var o=i[r];t.x=o.normal.x>0?n.min.x:n.max.x,e.x=o.normal.x>0?n.max.x:n.min.x,t.y=o.normal.y>0?n.min.y:n.max.y,e.y=o.normal.y>0?n.max.y:n.min.y,t.z=o.normal.z>0?n.min.z:n.max.z,e.z=o.normal.z>0?n.max.z:n.min.z;var a=o.distanceToPoint(t),s=o.distanceToPoint(e);if(a<0&&s<0)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}})},function(t,e,n){"use strict";function i(t,e){this.origin=void 0!==t?t:new r.a,this.direction=void 0!==e?e:new r.a}n.d(e,"a",function(){return i});var r=n(0);Object.assign(i.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return(e||new r.a).copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(){var t=new r.a;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){var n=e||new r.a;n.subVectors(t,this.origin);var i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new r.a;return function(e){var n=t.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(n).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new r.a,e=new r.a,n=new r.a;return function(i,r,o,a){t.copy(i).add(r).multiplyScalar(.5),e.copy(r).sub(i).normalize(),n.copy(this.origin).sub(t);var s,l,u,h,c=.5*i.distanceTo(r),d=-this.direction.dot(e),f=n.dot(this.direction),p=-n.dot(e),m=n.lengthSq(),v=Math.abs(1-d*d);if(v>0)if(s=d*p-f,l=d*f-p,h=c*v,s>=0)if(l>=-h)if(l<=h){var g=1/v;s*=g,l*=g,u=s*(s+d*l+2*f)+l*(d*s+l+2*p)+m}else l=c,s=Math.max(0,-(d*l+f)),u=-s*s+l*(l+2*p)+m;else l=-c,s=Math.max(0,-(d*l+f)),u=-s*s+l*(l+2*p)+m;else l<=-h?(s=Math.max(0,-(-d*c+f)),l=s>0?-c:Math.min(Math.max(-c,-p),c),u=-s*s+l*(l+2*p)+m):l<=h?(s=0,l=Math.min(Math.max(-c,-p),c),u=l*(l+2*p)+m):(s=Math.max(0,-(d*c+f)),l=s>0?c:Math.min(Math.max(-c,-p),c),u=-s*s+l*(l+2*p)+m);else l=d>0?-c:c,s=Math.max(0,-(d*l+f)),u=-s*s+l*(l+2*p)+m;return o&&o.copy(this.direction).multiplyScalar(s).add(this.origin),a&&a.copy(e).multiplyScalar(l).add(t),u}}(),intersectSphere:function(){var t=new r.a;return function(e,n){t.subVectors(e.center,this.origin);var i=t.dot(this.direction),r=t.dot(t)-i*i,o=e.radius*e.radius;if(r>o)return null;var a=Math.sqrt(o-r),s=i-a,l=i+a;return s<0&&l<0?null:s<0?this.at(l,n):this.at(s,n)}}(),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var n,i,r,o,a,s,l=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,c=this.origin;return l>=0?(n=(t.min.x-c.x)*l,i=(t.max.x-c.x)*l):(n=(t.max.x-c.x)*l,i=(t.min.x-c.x)*l),u>=0?(r=(t.min.y-c.y)*u,o=(t.max.y-c.y)*u):(r=(t.max.y-c.y)*u,o=(t.min.y-c.y)*u),n>o||r>i?null:((r>n||n!==n)&&(n=r),(o<i||i!==i)&&(i=o),h>=0?(a=(t.min.z-c.z)*h,s=(t.max.z-c.z)*h):(a=(t.max.z-c.z)*h,s=(t.min.z-c.z)*h),n>s||a>i?null:((a>n||n!==n)&&(n=a),(s<i||i!==i)&&(i=s),i<0?null:this.at(n>=0?n:i,e)))},intersectsBox:function(){var t=new r.a;return function(e){return null!==this.intersectBox(e,t)}}(),intersectTriangle:function(){var t=new r.a,e=new r.a,n=new r.a,i=new r.a;return function(r,o,a,s,l){e.subVectors(o,r),n.subVectors(a,r),i.crossVectors(e,n);var u,h=this.direction.dot(i);if(h>0){if(s)return null;u=1}else{if(!(h<0))return null;u=-1,h=-h}t.subVectors(this.origin,r);var c=u*this.direction.dot(n.crossVectors(t,n));if(c<0)return null;var d=u*this.direction.dot(e.cross(t));if(d<0)return null;if(c+d>h)return null;var f=-u*t.dot(i);return f<0?null:this.at(f/h,l)}}(),applyMatrix4:function(t){return this.direction.add(this.origin).applyMatrix4(t),this.origin.applyMatrix4(t),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}})},function(t,e,n){"use strict";function i(t,e){r.a.call(this,t,e),this.type="LineSegments"}n.d(e,"a",function(){return i});var r=n(188);i.prototype=Object.assign(Object.create(r.a.prototype),{constructor:i,isLineSegments:!0})},function(t,e,n){"use strict";function i(t,e){u.a.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new p.a,this.material=void 0!==e?e:new f.a({color:16777215*Math.random()}),this.drawMode=d.k,this.updateMorphTargets()}n.d(e,"a",function(){return i});var r=n(0),o=n(4),a=n(10),s=n(33),l=n(5),u=n(6),h=n(187),c=n(27),d=n(1),f=n(30),p=n(7);i.prototype=Object.assign(Object.create(u.a.prototype),{constructor:i,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return u.a.prototype.copy.call(this,t),this.drawMode=t.drawMode,this},updateMorphTargets:function(){var t=this.geometry.morphTargets;if(void 0!==t&&t.length>0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var e=0,n=t.length;e<n;e++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[t[e].name]=e}},raycast:function(){function t(t,e,n,i,r,o,a){return h.a.barycoordFromPoint(t,e,n,i,E),r.multiplyScalar(E.x),o.multiplyScalar(E.y),a.multiplyScalar(E.z),r.add(o).add(a),r.clone()}function e(t,e,n,i,r,o,a){var s=t.material;if(null===(s.side===d.l?n.intersectTriangle(o,r,i,!0,a):n.intersectTriangle(i,r,o,s.side!==d.m,a)))return null;M.copy(a),M.applyMatrix4(t.matrixWorld);var l=e.ray.origin.distanceTo(M);return l<e.near||l>e.far?null:{distance:l,point:M.clone(),object:t}}function n(n,i,r,o,a,s,l,u){p.fromBufferAttribute(o,s),m.fromBufferAttribute(o,l),v.fromBufferAttribute(o,u);var d=e(n,i,r,p,m,v,P);return d&&(a&&(x.fromBufferAttribute(a,s),b.fromBufferAttribute(a,l),w.fromBufferAttribute(a,u),d.uv=t(P,p,m,v,x,b,w)),d.face=new c.a(s,l,u,h.a.normal(p,m,v)),d.faceIndex=s),d}var i=new l.a,u=new s.a,f=new a.a,p=new r.a,m=new r.a,v=new r.a,g=new r.a,y=new r.a,_=new r.a,x=new o.a,b=new o.a,w=new o.a,E=new r.a,P=new r.a,M=new r.a;return function(r,o){var a=this.geometry,s=this.material,l=this.matrixWorld;if(void 0!==s&&(null===a.boundingSphere&&a.computeBoundingSphere(),f.copy(a.boundingSphere),f.applyMatrix4(l),!1!==r.ray.intersectsSphere(f)&&(i.getInverse(l),u.copy(r.ray).applyMatrix4(i),null===a.boundingBox||!1!==u.intersectsBox(a.boundingBox)))){var h;if(a.isBufferGeometry){var c,d,E,M,S,T=a.index,C=a.attributes.position,L=a.attributes.uv;if(null!==T)for(M=0,S=T.count;M<S;M+=3)c=T.getX(M),d=T.getX(M+1),E=T.getX(M+2),(h=n(this,r,u,C,L,c,d,E))&&(h.faceIndex=Math.floor(M/3),o.push(h));else for(M=0,S=C.count;M<S;M+=3)c=M,d=M+1,E=M+2,(h=n(this,r,u,C,L,c,d,E))&&(h.index=c,o.push(h))}else if(a.isGeometry){var A,I,N,R,D=Array.isArray(s),O=a.vertices,U=a.faces,F=a.faceVertexUvs[0];F.length>0&&(R=F);for(var B=0,z=U.length;B<z;B++){var X=U[B],k=D?s[X.materialIndex]:s;if(void 0!==k){if(A=O[X.a],I=O[X.b],N=O[X.c],!0===k.morphTargets){var G=a.morphTargets,V=this.morphTargetInfluences;p.set(0,0,0),m.set(0,0,0),v.set(0,0,0);for(var Y=0,H=G.length;Y<H;Y++){var W=V[Y];if(0!==W){var j=G[Y].vertices;p.addScaledVector(g.subVectors(j[X.a],A),W),m.addScaledVector(y.subVectors(j[X.b],I),W),v.addScaledVector(_.subVectors(j[X.c],N),W)}}p.add(A),m.add(I),v.add(N),A=p,I=m,N=v}if(h=e(this,r,u,A,I,N,P)){if(R&&R[B]){var q=R[B];x.copy(q[0]),b.copy(q[1]),w.copy(q[2]),h.uv=t(P,A,I,N,x,b,w)}h.face=X,h.faceIndex=B,o.push(h)}}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}})},function(t,e,n){"use strict";n.d(e,"a",function(){return li});var i=n(62),r=n.n(i),o=n(63),a=n.n(o),s=n(64),l=n.n(s),u=n(65),h=n.n(u),c=n(66),d=n.n(c),f=n(67),p=n.n(f),m=n(68),v=n.n(m),g=n(69),y=n.n(g),_=n(70),x=n.n(_),b=n(71),w=n.n(b),E=n(72),P=n.n(E),M=n(73),S=n.n(M),T=n(74),C=n.n(T),L=n(75),A=n.n(L),I=n(76),N=n.n(I),R=n(77),D=n.n(R),O=n(78),U=n.n(O),F=n(79),B=n.n(F),z=n(80),X=n.n(z),k=n(81),G=n.n(k),V=n(82),Y=n.n(V),H=n(83),W=n.n(H),j=n(86),q=n.n(j),J=n(87),Z=n.n(J),Q=n(88),K=n.n(Q),$=n(89),tt=n.n($),et=n(90),nt=n.n(et),it=n(91),rt=n.n(it),ot=n(92),at=n.n(ot),st=n(93),lt=n.n(st),ut=n(97),ht=n.n(ut),ct=n(96),dt=n.n(ct),ft=n(94),pt=n.n(ft),mt=n(95),vt=n.n(mt),gt=n(98),yt=n.n(gt),_t=n(99),xt=n.n(_t),bt=n(100),wt=n.n(bt),Et=n(101),Pt=n.n(Et),Mt=n(102),St=n.n(Mt),Tt=n(103),Ct=n.n(Tt),Lt=n(104),At=n.n(Lt),It=n(105),Nt=n.n(It),Rt=n(106),Dt=n.n(Rt),Ot=n(107),Ut=n.n(Ot),Ft=n(108),Bt=n.n(Ft),zt=n(109),Xt=n.n(zt),kt=n(110),Gt=n.n(kt),Vt=n(111),Yt=n.n(Vt),Ht=n(112),Wt=n.n(Ht),jt=n(113),qt=n.n(jt),Jt=n(114),Zt=n.n(Jt),Qt=n(115),Kt=n.n(Qt),$t=n(116),te=n.n($t),ee=n(117),ne=n.n(ee),ie=n(118),re=n.n(ie),oe=n(119),ae=n.n(oe),se=n(120),le=n.n(se),ue=n(121),he=n.n(ue),ce=n(122),de=n.n(ce),fe=n(123),pe=n.n(fe),me=n(124),ve=n.n(me),ge=n(125),ye=n.n(ge),_e=n(126),xe=n.n(_e),be=n(84),we=n.n(be),Ee=n(85),Pe=n.n(Ee),Me=n(127),Se=n.n(Me),Te=n(128),Ce=n.n(Te),Le=n(129),Ae=n.n(Le),Ie=n(130),Ne=n.n(Ie),Re=n(131),De=n.n(Re),Oe=n(132),Ue=n.n(Oe),Fe=n(133),Be=n.n(Fe),ze=n(134),Xe=n.n(ze),ke=n(135),Ge=n.n(ke),Ve=n(136),Ye=n.n(Ve),He=n(137),We=n.n(He),je=n(138),qe=n.n(je),Je=n(139),Ze=n.n(Je),Qe=n(140),Ke=n.n(Qe),$e=n(144),tn=n.n($e),en=n(145),nn=n.n(en),rn=n(146),on=n.n(rn),an=n(141),sn=n.n(an),ln=n(142),un=n.n(ln),hn=n(143),cn=n.n(hn),dn=n(147),fn=n.n(dn),pn=n(148),mn=n.n(pn),vn=n(149),gn=n.n(vn),yn=n(150),_n=n.n(yn),xn=n(151),bn=n.n(xn),wn=n(152),En=n.n(wn),Pn=n(153),Mn=n.n(Pn),Sn=n(154),Tn=n.n(Sn),Cn=n(155),Ln=n.n(Cn),An=n(156),In=n.n(An),Nn=n(157),Rn=n.n(Nn),Dn=n(158),On=n.n(Dn),Un=n(159),Fn=n.n(Un),Bn=n(160),zn=n.n(Bn),Xn=n(161),kn=n.n(Xn),Gn=n(162),Vn=n.n(Gn),Yn=n(163),Hn=n.n(Yn),Wn=n(164),jn=n.n(Wn),qn=n(165),Jn=n.n(qn),Zn=n(166),Qn=n.n(Zn),Kn=n(167),$n=n.n(Kn),ti=n(168),ei=n.n(ti),ni=n(169),ii=n.n(ni),ri=n(170),oi=n.n(ri),ai=n(171),si=n.n(ai),li={alphamap_fragment:r.a,alphamap_pars_fragment:a.a,alphatest_fragment:l.a,aomap_fragment:h.a,aomap_pars_fragment:d.a,begin_vertex:p.a,beginnormal_vertex:v.a,bsdfs:y.a,bumpmap_pars_fragment:x.a,clipping_planes_fragment:w.a,clipping_planes_pars_fragment:P.a,clipping_planes_pars_vertex:S.a,clipping_planes_vertex:C.a,color_fragment:A.a,color_pars_fragment:N.a,color_pars_vertex:D.a,color_vertex:U.a,common:B.a,cube_uv_reflection_fragment:X.a,defaultnormal_vertex:G.a,displacementmap_pars_vertex:Y.a,displacementmap_vertex:W.a,emissivemap_fragment:q.a,emissivemap_pars_fragment:Z.a,encodings_fragment:K.a,encodings_pars_fragment:tt.a,envmap_fragment:nt.a,envmap_pars_fragment:rt.a,envmap_pars_vertex:at.a,envmap_vertex:lt.a,fog_vertex:ht.a,fog_pars_vertex:dt.a,fog_fragment:pt.a,fog_pars_fragment:vt.a,gradientmap_pars_fragment:yt.a,lightmap_fragment:xt.a,lightmap_pars_fragment:wt.a,lights_lambert_vertex:Pt.a,lights_pars:St.a,lights_phong_fragment:Ct.a,lights_phong_pars_fragment:At.a,lights_physical_fragment:Nt.a,lights_physical_pars_fragment:Dt.a,lights_template:Ut.a,logdepthbuf_fragment:Bt.a,logdepthbuf_pars_fragment:Xt.a,logdepthbuf_pars_vertex:Gt.a,logdepthbuf_vertex:Yt.a,map_fragment:Wt.a,map_pars_fragment:qt.a,map_particle_fragment:Zt.a,map_particle_pars_fragment:Kt.a,metalnessmap_fragment:te.a,metalnessmap_pars_fragment:ne.a,morphnormal_vertex:re.a,morphtarget_pars_vertex:ae.a,morphtarget_vertex:le.a,normal_flip:he.a,normal_fragment:de.a,normalmap_pars_fragment:pe.a,packing:ve.a,premultiplied_alpha_fragment:ye.a,project_vertex:xe.a,dithering_fragment:we.a,dithering_pars_fragment:Pe.a,roughnessmap_fragment:Se.a,roughnessmap_pars_fragment:Ce.a,shadowmap_pars_fragment:Ae.a,shadowmap_pars_vertex:Ne.a,shadowmap_vertex:De.a,shadowmask_pars_fragment:Ue.a,skinbase_vertex:Be.a,skinning_pars_vertex:Xe.a,skinning_vertex:Ge.a,skinnormal_vertex:Ye.a,specularmap_fragment:We.a,specularmap_pars_fragment:qe.a,tonemapping_fragment:Ze.a,tonemapping_pars_fragment:Ke.a,uv_pars_fragment:tn.a,uv_pars_vertex:nn.a,uv_vertex:on.a,uv2_pars_fragment:sn.a,uv2_pars_vertex:un.a,uv2_vertex:cn.a,worldpos_vertex:fn.a,cube_frag:mn.a,cube_vert:gn.a,depth_frag:_n.a,depth_vert:bn.a,distanceRGBA_frag:En.a,distanceRGBA_vert:Mn.a,equirect_frag:Tn.a,equirect_vert:Ln.a,linedashed_frag:In.a,linedashed_vert:Rn.a,meshbasic_frag:On.a,meshbasic_vert:Fn.a,meshlambert_frag:zn.a,meshlambert_vert:kn.a,meshphong_frag:Vn.a,meshphong_vert:Hn.a,meshphysical_frag:jn.a,meshphysical_vert:Jn.a,normal_frag:Qn.a,normal_vert:$n.a,points_frag:ei.a,points_vert:ii.a,shadow_frag:oi.a,shadow_vert:si.a}},function(t,e,n){"use strict";n.d(e,"a",function(){return l});var i=n(36),r=n(16),o=n(0),a=n(38),s=n(3),l={basic:{uniforms:r.a.merge([a.a.common,a.a.aomap,a.a.lightmap,a.a.fog]),vertexShader:i.a.meshbasic_vert,fragmentShader:i.a.meshbasic_frag},lambert:{uniforms:r.a.merge([a.a.common,a.a.aomap,a.a.lightmap,a.a.emissivemap,a.a.fog,a.a.lights,{emissive:{value:new s.a(0)}}]),vertexShader:i.a.meshlambert_vert,fragmentShader:i.a.meshlambert_frag},phong:{uniforms:r.a.merge([a.a.common,a.a.aomap,a.a.lightmap,a.a.emissivemap,a.a.bumpmap,a.a.normalmap,a.a.displacementmap,a.a.gradientmap,a.a.fog,a.a.lights,{emissive:{value:new s.a(0)},specular:{value:new s.a(1118481)},shininess:{value:30}}]),vertexShader:i.a.meshphong_vert,fragmentShader:i.a.meshphong_frag},standard:{uniforms:r.a.merge([a.a.common,a.a.aomap,a.a.lightmap,a.a.emissivemap,a.a.bumpmap,a.a.normalmap,a.a.displacementmap,a.a.roughnessmap,a.a.metalnessmap,a.a.fog,a.a.lights,{emissive:{value:new s.a(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:i.a.meshphysical_vert,fragmentShader:i.a.meshphysical_frag},points:{uniforms:r.a.merge([a.a.points,a.a.fog]),vertexShader:i.a.points_vert,fragmentShader:i.a.points_frag},dashed:{uniforms:r.a.merge([a.a.common,a.a.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:i.a.linedashed_vert,fragmentShader:i.a.linedashed_frag},depth:{uniforms:r.a.merge([a.a.common,a.a.displacementmap]),vertexShader:i.a.depth_vert,fragmentShader:i.a.depth_frag},normal:{uniforms:r.a.merge([a.a.common,a.a.bumpmap,a.a.normalmap,a.a.displacementmap,{opacity:{value:1}}]),vertexShader:i.a.normal_vert,fragmentShader:i.a.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:i.a.cube_vert,fragmentShader:i.a.cube_frag},equirect:{uniforms:{tEquirect:{value:null},tFlip:{value:-1}},vertexShader:i.a.equirect_vert,fragmentShader:i.a.equirect_frag},distanceRGBA:{uniforms:{lightPos:{value:new o.a}},vertexShader:i.a.distanceRGBA_vert,fragmentShader:i.a.distanceRGBA_frag}};l.physical={uniforms:r.a.merge([l.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:i.a.meshphysical_vert,fragmentShader:i.a.meshphysical_frag}},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n(11),r=n(3),o=n(4),a=(n(40),{common:{diffuse:{value:new r.a(15658734)},opacity:{value:1},map:{value:null},offsetRepeat:{value:new i.a(0,0,1,1)},specularMap:{value:null},alphaMap:{value:null},envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new o.a(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new r.a(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new r.a(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},offsetRepeat:{value:new i.a(0,0,1,1)}}})},function(t,e,n){"use strict";function i(){this.seq=[],this.map={}}function r(t,e,n){var i=t[0];if(i<=0||i>0)return t;var r=e*n,o=k[r];if(void 0===o&&(o=new Float32Array(r),k[r]=o),0!==e){i.toArray(o,0);for(var a=1,s=0;a!==e;++a)s+=n,t[a].toArray(o,s)}return o}function o(t,e){var n=G[e];void 0===n&&(n=new Int32Array(e),G[e]=n);for(var i=0;i!==e;++i)n[i]=t.allocTextureUnit();return n}function a(t,e){t.uniform1f(this.addr,e)}function s(t,e){t.uniform1i(this.addr,e)}function l(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)}function u(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)}function h(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)}function c(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)}function d(t,e){void 0===e.elements?t.uniformMatrix3fv(this.addr,!1,e):(Y.set(e.elements),t.uniformMatrix3fv(this.addr,!1,Y))}function f(t,e){void 0===e.elements?t.uniformMatrix4fv(this.addr,!1,e):(V.set(e.elements),t.uniformMatrix4fv(this.addr,!1,V))}function p(t,e,n){var i=n.allocTextureUnit();t.uniform1i(this.addr,i),n.setTexture2D(e||z,i)}function m(t,e,n){var i=n.allocTextureUnit();t.uniform1i(this.addr,i),n.setTextureCube(e||X,i)}function v(t,e){t.uniform2iv(this.addr,e)}function g(t,e){t.uniform3iv(this.addr,e)}function y(t,e){t.uniform4iv(this.addr,e)}function _(t){switch(t){case 5126:return a;case 35664:return l;case 35665:return u;case 35666:return h;case 35674:return c;case 35675:return d;case 35676:return f;case 35678:return p;case 35680:return m;case 5124:case 35670:return s;case 35667:case 35671:return v;case 35668:case 35672:return g;case 35669:case 35673:return y}}function x(t,e){t.uniform1fv(this.addr,e)}function b(t,e){t.uniform1iv(this.addr,e)}function w(t,e){t.uniform2fv(this.addr,r(e,this.size,2))}function E(t,e){t.uniform3fv(this.addr,r(e,this.size,3))}function P(t,e){t.uniform4fv(this.addr,r(e,this.size,4))}function M(t,e){t.uniformMatrix2fv(this.addr,!1,r(e,this.size,4))}function S(t,e){t.uniformMatrix3fv(this.addr,!1,r(e,this.size,9))}function T(t,e){t.uniformMatrix4fv(this.addr,!1,r(e,this.size,16))}function C(t,e,n){var i=e.length,r=o(n,i);t.uniform1iv(this.addr,r);for(var a=0;a!==i;++a)n.setTexture2D(e[a]||z,r[a])}function L(t,e,n){var i=e.length,r=o(n,i);t.uniform1iv(this.addr,r);for(var a=0;a!==i;++a)n.setTextureCube(e[a]||X,r[a])}function A(t){switch(t){case 5126:return x;case 35664:return w;case 35665:return E;case 35666:return P;case 35674:return M;case 35675:return S;case 35676:return T;case 35678:return C;case 35680:return L;case 5124:case 35670:return b;case 35667:case 35671:return v;case 35668:case 35672:return g;case 35669:case 35673:return y}}function I(t,e,n){this.id=t,this.addr=n,this.setValue=_(e.type)}function N(t,e,n){this.id=t,this.addr=n,this.size=e.size,this.setValue=A(e.type)}function R(t){this.id=t,i.call(this)}function D(t,e){t.seq.push(e),t.map[e.id]=e}function O(t,e,n){var i=t.name,r=i.length;for(H.lastIndex=0;;){var o=H.exec(i),a=H.lastIndex,s=o[1],l="]"===o[2],u=o[3];if(l&&(s|=0),void 0===u||"["===u&&a+2===r){D(n,void 0===u?new I(s,t,e):new N(s,t,e));break}var h=n.map,c=h[s];void 0===c&&(c=new R(s),D(n,c)),n=c}}function U(t,e,n){i.call(this),this.renderer=n;for(var r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),o=0;o<r;++o){var a=t.getActiveUniform(e,o),s=a.name;O(a,t.getUniformLocation(e,s),this)}}n.d(e,"a",function(){return U});var F=n(212),B=n(15),z=new B.a,X=new F.a,k=[],G=[],V=new Float32Array(16),Y=new Float32Array(9);R.prototype.setValue=function(t,e){for(var n=this.seq,i=0,r=n.length;i!==r;++i){var o=n[i];o.setValue(t,e[o.id])}};var H=/([\w\d_]+)(\])?(\[|\.)?/g;U.prototype.setValue=function(t,e,n){var i=this.map[e];void 0!==i&&i.setValue(t,n,this.renderer)},U.prototype.setOptional=function(t,e,n){var i=e[n];void 0!==i&&this.setValue(t,n,i)},U.upload=function(t,e,n,i){for(var r=0,o=e.length;r!==o;++r){var a=e[r],s=n[a.id];!1!==s.needsUpdate&&a.setValue(t,s.value,i)}},U.seqWithValue=function(t,e){for(var n=[],i=0,r=t.length;i!==r;++i){var o=t[i];o.id in e&&n.push(o)}return n}},function(t,e,n){"use strict";function i(t,e,n,i,a,s,l,u,h,c,d,f){r.a.call(this,null,s,l,u,h,c,i,a,d,f),this.image={data:t,width:e,height:n},this.magFilter=void 0!==h?h:o.A,this.minFilter=void 0!==c?c:o.A,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}n.d(e,"a",function(){return i});var r=n(15),o=n(1);i.prototype=Object.create(r.a.prototype),i.prototype.constructor=i,i.prototype.isDataTexture=!0},function(t,e,n){"use strict";function i(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,i=t.length;n<i;++n)t[n]>e&&(e=t[n]);return e}n.d(e,"a",function(){return i})},function(t,e,n){"use strict";function i(t){var e=a()(function(){return t.regenerateAndDraw()},50),n=new l.a.GUI;return h.a.PARAMS.groups.forEach(function(i){var r=n;i.name&&(r=n.addFolder(i.name)),i.params.forEach(function(n){var i=null;switch(n.type){case"int":i=r.add(t.params,n.name,n.min,n.max).step(1);break;case"float":i=r.add(t.params,n.name,n.min,n.max);break;case"bool":case"string":i=r.add(t.params,n.name);break;default:throw new Error("unsupported param type")}i.onChange(e)})}),t.gui=n,n}function r(){var t=new h.a("dkkkhurf a der3"),e=i(t);t.regenerateAndDraw();var n=null,r=!1,o={generateHeightmap:function(){function e(){n.generateNextLine()?setTimeout(e,1):r=!0}n=new c.a(t,256,256),n.startGenerate(),r=!1,e()},renderHeightmap:function(){if(!r)return void alert("The heightmap must be generated first.");var t=new u.a(n);setInterval(function(){return t.render()},25),t.updateMesh()}};return e.add(o,"generateHeightmap"),e.add(o,"renderHeightmap"),t}e.a=r;var o=n(57),a=n.n(o),s=n(52),l=n.n(s),u=n(45),h=n(46),c=n(44)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:512;i(this,t),this.resolution=e,this.points=[],this.bitmap=null}return r(t,[{key:"addPoint",value:function(t,e){this.points.push({color:t,point:e}),this.bitmap=null}},{key:"getColor",value:function(t){this.bitmap||(this.bitmap=this.render()),t=Math.min(Math.max(0,t),1);var e=4*Math.floor(t*this.bitmap.width),n=this.bitmap.data;return"rgb("+n[e]+", "+n[e+1]+", "+n[e+2]+")"}},{key:"render",value:function(){var t=document.createElement("canvas");t.width=this.resolution,t.height=10;var e=t.getContext("2d"),n=e.createLinearGradient(0,0,t.width,0);return this.points.forEach(function(t){var e=t.color,i=t.point;return n.addColorStop(i,e)}),e.fillStyle=n,e.fillRect(0,0,t.width,t.height),e.getImageData(0,0,t.width,t.height)}}]),t}();e.a=o},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(50),s=a.lerp,l=a.closestPointOnSegment,u=a.getSquaredDistance,h=a.getDistance,c=n(21),d=c.rand,f=function(){function t(e,n,r){i(this,t),this.ig=e,this.mapWidth=n,this.mapHeight=r,this.scaleX=this.mapWidth/this.ig.width,this.scaleY=this.mapHeight/this.ig.height;var o=document.createElement("canvas");o.width=this.mapWidth,o.height=this.mapHeight,o.style.border="1px solid red",o.style.width="500px",o.style.height="500px",document.body.appendChild(o),this.debugCanvas=o;var a=document.createElement("canvas");a.width=this.mapWidth,a.height=this.mapHeight,a.style.border="1px solid black",this.scratchCanvas=a,this.debugCtx=o.getContext("2d"),this.scratchCtx=a.getContext("2d"),this.heightmapData=new Float32Array(n*r),this.segments=this.generateSegments(),console.log(this.segments.length+" segments.")}return o(t,[{key:"generateSegments",value:function(){var t=this,e=[];return this.ig.layers.forEach(function(n){for(var i=n.height,r=0;r<n.length;++r){var o=(r+1)%n.length,a=[n[r][0]*t.scaleX,n[r][1]*t.scaleY],s=[n[o][0]*t.scaleX,n[o][1]*t.scaleY],l=[a,s];l.height=i,e.push(l)}}),e}},{key:"updateDebugCanvas",value:function(){var t=Math.max.apply(null,this.heightmapData),e=this.debugCtx;e.fillStyle="purple",e.fillRect(0,0,this.mapWidth,this.mapHeight);for(var n=e.getImageData(0,0,this.mapWidth,this.mapHeight),i=0;i<this.heightmapData.length;++i){var r=this.heightmapData[i];if(r>0){var o=Math.floor(r/t*255);n.data[4*i+0]=o,n.data[4*i+1]=o,n.data[4*i+2]=o,n.data[4*i+3]=255}}e.putImageData(n,0,0),e.fillStyle="white",e.fillText("max = "+Math.floor(t),3,this.mapHeight-3)}},{key:"determineBaseRegion",value:function(){var t=this,e=this.scratchCtx;e.fillStyle="black",e.fillRect(0,0,this.mapWidth,this.mapHeight),e.fillStyle="red",this.ig.layers.forEach(function(n){n.height>0||(e.beginPath(),n.forEach(function(n,i){var o=r(n,2),a=o[0],s=o[1];a*=t.scaleX,s*=t.scaleY,0===i?e.moveTo(a,s):e.lineTo(a,s)}),e.closePath(),e.fill())});for(var n=e.getImageData(0,0,this.mapWidth,this.mapHeight),i=0,o=this.mapWidth*this.mapHeight;i<o;++i){var a=4*i;n.data[a]>=250?n.data[a++]=255:n.data[a++]=0,n.data[a++]=0,n.data[a++]=0,n.data[a++]=255}e.putImageData(n,0,0)}},{key:"startGenerate",value:function(){this.determineBaseRegion(),this.updateDebugCanvas(),this.y=0}},{key:"generateNextLine",value:function(){return!(this.y>=this.mapHeight)&&(this.generateLine(this.y),this.y++,!0)}},{key:"generateLine",value:function(t){console.log("generating line: "+t);for(var e=this.scratchCtx.getImageData(0,t,this.mapWidth,1).data,n=0;n<this.mapWidth;++n){if(255===e[4*n]){for(var i=t*this.mapWidth+n,r=0,o=0;o<5;++o)r+=this.generatePoint(n+d(-1,1),t+d(-1,1));this.heightmapData[i]=r/5}}this.updateDebugCanvas()}},{key:"getSegmentDistances",value:function(t,e){var n=[],i=[t,e];return this.segments.forEach(function(r){var o=r.height,a=l(i,r[0],r[1]),s=u(t,e,a[0],a[1]);n.push({distance:s,pt:a,height:o})}),n.sort(function(t,e){return t.distance-e.distance})}},{key:"generatePoint",value:function(t,e){for(var n=this.getSegmentDistances(t,e),i=n[0],r=i,o=0;o<n.length;++o){var a=n[o];if(a.height!==i.height){r=a;break}}r=r||i;var u=i.pt,c=r.pt,d=l([t,e],u,c),f=h(u[0],u[1],c[0],c[1]),p=h(d[0],d[1],u[0],u[1]),m=p/f;return s(i.height,r.height,m)}}]),t}();e.a=f},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t){return t<0?0:t>=255?255:Math.round(t)}var o=n(189),a=(n.n(o),n(177)),s=n(3),l=n(35),u=n(182),h=n(183),c=n(17),d=n(28),f=n(180),p=n(211),m=n(1),v=n(191),g=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),y=function(){function t(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;i(this,t),this.heightmap=e,this.resX=n,this.resY=r,this.heightScale=o,this.geometry=new d.a(100,100,this.resX,this.resY)}return g(t,[{key:"sample",value:function(t,e){return t/=this.resX,e/=this.resY,t*=this.heightmap.mapWidth,e*=this.heightmap.mapHeight,t=Math.floor(t),e=Math.floor(e),t<0||t>this.heightmap.mapWidth?-1:e<0||e>this.heightmap.mapHeight?-1:(e=this.heightmap.heightmapData[e*this.heightmap.mapWidth+t]*this.heightScale,e<=0&&(e=-1),e)}},{key:"update",value:function(){for(var t=0;t<this.resX;++t)for(var e=0;e<this.resY;++e){var n=this.sample(e,t),i=t*(this.resX+1)+e;this.geometry.vertices[i].z=n}var o=0,a=this.geometry,l=a.vertices,u=a.faces;l.forEach(function(t){t.z>o&&(o=t.z)});var h=["a","b","c"];return u.forEach(function(t){for(var e=0;e<3;++e){var n=l[t[h[e]]],i=n.z/o,a=r(Math.round(255*i));t.vertexColors[e]=new s.a(a<<16|a<<8|a)}}),this.geometry.computeFaceNormals(),this.geometry.computeVertexNormals(),this.geometry.verticesNeedUpdate=!0,this.geometry.colorsNeedUpdate=!0,this.geometry}}]),t}(),_=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:640,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:480;i(this,t),this.heightmap=e;var o=n/r,s=new v.a({antialias:!0});s.setClearColor(16777215),s.setSize(n,r),this.renderer=s,document.body.appendChild(s.domElement),this.camera=new c.a(60,o,.1,1e3),this.pointLight=new f.a(16777215),this.sea=new l.a(new d.a(100,100,3,3),new u.a({color:5488383})),this.sea.rotation.x=-.5*Math.PI;var h=new p.a;h.add(this.camera),h.add(this.pointLight),h.add(this.sea),h.add(new a.a(10)),this.scene=h}return g(t,[{key:"updateMesh",value:function(){var t=new h.a({color:16777215,vertexColors:m.a}),e=new y(this.heightmap,64,64,.1),n=e.update(),i=new l.a(n,t);this.plane&&(this.scene.remove(this.plane),this.plane=null),this.plane=i,this.plane.rotation.x=-.5*Math.PI,this.scene.add(i)}},{key:"render",value:function(){var t=-5e-4*+new Date,e=50*Math.cos(t),n=50*Math.sin(t);this.camera.position.x=e,this.camera.position.y=50,this.camera.position.z=n,this.camera.lookAt(this.scene.position),this.pointLight.position.x=15,this.pointLight.position.y=60,this.pointLight.position.z=15,this.renderer.render(this.scene,this.camera)}}]),t}();e.a=_},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e,n){var i=new d.a.Paths,r=new d.a.Paths;t.forEach(function(t){return i.push(b(t))}),e.forEach(function(t){return r.push(b(t))});var o=new d.a.Clipper;o.AddPaths(i,d.a.PolyType.ptSubject,!0),o.AddPaths(r,d.a.PolyType.ptClip,!0);var a=new d.a.Paths,s=d.a.PolyFillType.pftPositive;return o.Execute(n,a,s,s)?Array.from(a).map(w):(console.log("No success."),[])}function o(t){var e=[].concat(t);return r([e.shift()],e,d.a.ClipType.ctUnion)}function a(t,e){return r(t,e,d.a.ClipType.ctDifference)}function s(t,e){var n=d.a.JoinType.jtMiter,i=new d.a.ClipperOffset(0,0);i.AddPaths([b(t)],n,d.a.EndType.etClosedPolygon);var r=new d.a.Paths;i.Execute(r,e);var o=d.a.JS.Clean(r,2.5);return Array.from(o).map(w)}function l(t){var e=Math.cos(t),n=Math.sin(t);return function(t,i){return[t*e-i*n,t*n+i*e]}}function u(t,e,n,i){return e.map(function(e){var r=_(e,2),o=r[0],a=r[1];return[o+t.uniform(-n,n),a+t.uniform(-i,i)]})}function h(t,e,n){return t.map(function(t){var i=_(t,2),r=i[0],o=i[1];return[r+e,o+n]})}var c=n(51),d=n.n(c),f=n(25),p=n.n(f),m=n(21),v=n(49),g=n(47),y=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),_=function(){function t(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),x=2*Math.PI,b=function(t){var e=new d.a.Path;return t.forEach(function(t){var n=_(t,2),i=n[0],r=n[1];return e.push(new d.a.IntPoint(i,r))}),e},w=function(t){return Array.from(t).map(function(t){return[t.X,t.Y]})},E=new v.a;E.group(null,[n.i(v.b)("seed",""+ +new Date),n.i(v.c)("size",600,0,2048)]),E.group("Drawing",[n.i(v.d)("isletOutlines",!1),n.i(v.d)("contourOutlines",!0),n.i(v.d)("bwColorMap",!1),n.i(v.c)("blurContours",0,0,20)]),E.group("Islets",[n.i(v.c)("isletMinN",2),n.i(v.c)("isletMaxN",15),n.i(v.e)("isletSpread",.3),n.i(v.e)("isletMinRadius",.1),n.i(v.e)("isletMaxRadius",.3),n.i(v.c)("isletMinPoints",7),n.i(v.c)("isletMaxPoints",25),n.i(v.e)("isletJagginess",.2),n.i(v.d)("isletSeparateRadii",!0),n.i(v.e)("isletMinAspect",.9,0,2),n.i(v.e)("isletMaxAspect",1.1,0,2),n.i(v.e)("isletMinAngle",-.3,-1,1),n.i(v.e)("isletMaxAngle",.3,-1,1),n.i(v.e)("isletNegativeChance",.05)]),E.group("Layers",[n.i(v.c)("islandInitialOutset",0,-15,15),n.i(v.c)("minHeightIncrease",5),n.i(v.c)("maxHeightIncrease",50),n.i(v.e)("minHeightInsetRatio",.9,0,2),n.i(v.e)("maxHeightInsetRatio",1.1,0,2),n.i(v.c)("minLayerJitter",2),n.i(v.c)("maxLayerJitter",5),n.i(v.c)("layerOffsetSize",5)]);var P=function(){function t(){i(this,t),this.params=E.initialize(),this.islets=[],this.layers=[]}return y(t,[{key:"generateIslet",value:function(t){for(var e=.5-this.params.isletSpread,n=.5+this.params.isletSpread,i=t.uniform(this.width*e,this.width*n),r=t.uniform(this.height*e,this.height*n),o=Math.min(this.width,this.height),a=t.uniform(o*this.params.isletMinRadius,o*this.params.isletMaxRadius),s=a-a*this.params.isletJagginess,u=t.uniformInt(this.params.isletMinPoints,this.params.isletMaxPoints),h=[],c=t.uniform(this.params.isletMinAspect,this.params.isletMaxAspect),d=t.uniform(this.params.isletMinAngle,this.params.isletMaxAngle)*x,f=l(d),p=0;p<u;p++){var m=p/u,v=t.uniform(s,a),g=t.uniform(s,a);if(!this.params.isletSeparateRadii){var y=.5*(v+g);v=y,g=y}v/=c,g*=c;var b=f(Math.cos(m*x)*v,Math.sin(m*x)*g),w=_(b,2),E=w[0],P=w[1];h.push([i+E,r+P])}return h.negative=t.uniform(0,1)<=this.params.isletNegativeChance,h}},{key:"convertIsletsToLayers",value:function(t,e){var n=this,i=[],r=e.filter(function(t){return!t.negative}),l=e.filter(function(t){return t.negative});l.length&&(e=a(r,l)),o(e).forEach(function(t){s(t,n.params.islandInitialOutset).forEach(function(t){t.height=0,i.push(t)})});var c=[].concat(i),d=t.uniformInt(200,400);this.maxHeight=d;t:for(;c.length;){var f=function(){var e=c.shift();if(t.uniform(0,1)<.05)return console.log("skipping layer"),"continue";if(e.height>d)return console.log("maxheight "+d+" reached"),"break";var r=t.uniformInt(n.params.minHeightIncrease,n.params.maxHeightIncrease),o=t.uniform(n.params.minHeightInsetRatio,n.params.maxHeightInsetRatio)*r,a=t.uniform(n.params.minLayerJitter,n.params.maxLayerJitter),l=s(e,-o);l.length?(l=l.map(function(i){var o=t.uniform(-n.params.layerOffsetSize,n.params.layerOffsetSize),s=t.uniform(-n.params.layerOffsetSize,n.params.layerOffsetSize);return i=u(t,i,a,a),i=h(i,o,s),i.height=e.height+r,i}),c=c.concat(l),i=i.concat(l)):console.log("no new layers")}();switch(f){case"continue":continue;case"break":break t}}return i}},{key:"generateIslets",value:function(t){for(var e=t.uniformInt(this.params.isletMinN,this.params.isletMaxN),n=[],i=0;i<e;i++)n.push(this.generateIslet(t));return n}},{key:"generate",value:function(){var t=Math.floor(this.params.size);this.width=t,this.height=t;var e=+new Date;this.rngFarm=new m.RandomFarm(this.params.seed);var n=this.rngFarm.get("islet"),i=this.rngFarm.get("layer");return this.islets=this.generateIslets(n),this.layers=this.convertIsletsToLayers(i,this.islets),this.genTime=+new Date-e,this.genTime}},{key:"draw",value:function(){this.svg||(this.svg=p()(document.body)),this.svg.size(this.width,this.height).clear(),n.i(g.a)(this.svg,this,{monochrome:!!this.params.bwColorMap,blur:this.params.blurContours,isletOutlines:!!this.params.isletOutlines,contourOutlines:!!this.params.contourOutlines})}},{key:"regenerateAndDraw",value:function(){this.generate(),this.draw(),console.log("generated in "+this.genTime+" ms")}}]),t}();P.PARAMS=E,e.a=P},function(t,e,n){"use strict";var i=n(43);n(25);n(172);var r=new i.a;r.addPoint("#222222",0),r.addPoint("#ffffff",1);var o=new i.a;o.addPoint("#94bf8b",0),o.addPoint("#acd0a5",.2),o.addPoint("#bdcc96",.5),o.addPoint("#efebc0",.8),o.addPoint("#cab982",.99),o.addPoint("#cab982",1);var a={monochrome:!1,isletOutlines:!1,contourOutlines:!0,blur:0};e.a=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Object.assign({},a,n),s=i.monochrome,l=i.isletOutlines,u=i.contourOutlines,h=i.blur,c=e.width,d=e.height,f=s?"#000000":"#53BEFF";t.rect(c,d).fill(f);var p=s?r:o,m=e.maxHeight||Math.max.apply(null,e.layers.map(function(t){return t.height}));return e.layers.forEach(function(e){var n=e.height/m,i=p.getColor(n),r=0===e.height?"black":"rgba(0,0,0,0.2)",o=t.polygon(e).fill(i);u&&o.stroke({width:1,color:r}),h&&o.filter(function(t){return t.gaussianBlur(h)})}),l&&e.islets.forEach(function(e){var n=e.negative?"red":"white";t.polygon(e).stroke({width:1,color:n}).fill("none")}),t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(42);window.islandGenerator=n.i(i.a)()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"c",function(){return o}),n.d(e,"e",function(){return a}),n.d(e,"d",function(){return s}),n.d(e,"b",function(){return l}),n.d(e,"a",function(){return h});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(t,e){return{name:t,value:e,min:arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,max:arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,type:"int"}},a=function(t,e){return{name:t,value:e,min:arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,max:arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,type:"float"}},s=function(t,e){return{name:t,value:!!e,type:"bool"}},l=function(t,e){return{name:t,value:""+e,type:"string"}},u=function t(e,n){i(this,t),this.name=e,this.params=n},h=function(){function t(){i(this,t),this.groups=[]}return r(t,[{key:"group",value:function(t,e){this.groups.push(new u(t,e))}},{key:"initialize",value:function(){var t={};return this.groups.forEach(function(e){e.params.forEach(function(e){t[e.name]=e.value})}),t}}]),t}()},function(t,e,n){"use strict";function i(t,e,n){return e*n+t*(1-n)}function r(t,e,n,i){return Math.sqrt((n-t)*(n-t)+(i-e)*(i-e))}function o(t,e,n,i){return(n-t)*(n-t)+(i-e)*(i-e)}function a(t,e,n){var i=o(e[0],e[1],n[0],n[1]);if(i<=0)return o(t[0],t[1],e[0],e[1]);var r=((t[0]-e[0])*(n[0]-e[0])+(t[1]-e[1])*(n[1]-e[1]))/i;return r<=0?o(t[0],t[1],e[0],e[1]):r>=1?o(t[0],t[1],n[0],n[1]):o(t[0],t[1],e[0]+r*(n[0]-e[0]),e[1]+r*(n[1]-e[1]))}function s(t,e,n){return Math.sqrt(a(t,e,n))}function l(t,e,n){var i=o(e[0],e[1],n[0],n[1]);if(i<=0)return t;var r=((t[0]-e[0])*(n[0]-e[0])+(t[1]-e[1])*(n[1]-e[1]))/i;return r<=0?e:r>=1?n:[e[0]+r*(n[0]-e[0]),e[1]+r*(n[1]-e[1])]}Object.defineProperty(e,"__esModule",{value:!0}),e.lerp=i,e.getDistance=r,e.getSquaredDistance=o,e.distToSegmentSquared=a,e.distToSegment=s,e.closestPointOnSegment=l},function(t,e,n){var i,r;!function(){"use strict";function o(t,e,n){ie.biginteger_used=1,null!=t&&("number"==typeof t&&void 0===e?this.fromInt(t):"number"==typeof t?this.fromNumber(t,e,n):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function a(){return new o(null,void 0,void 0)}function s(t,e,n,i,r,o){for(;--o>=0;){var a=e*this[t++]+n[i]+r;r=Math.floor(a/67108864),n[i++]=67108863&a}return r}function l(t,e,n,i,r,o){for(var a=32767&e,s=e>>15;--o>=0;){var l=32767&this[t],u=this[t++]>>15,h=s*l+u*a;l=a*l+((32767&h)<<15)+n[i]+(1073741823&r),r=(l>>>30)+(h>>>15)+s*u+(r>>>30),n[i++]=1073741823&l}return r}function u(t,e,n,i,r,o){for(var a=16383&e,s=e>>14;--o>=0;){var l=16383&this[t],u=this[t++]>>14,h=s*l+u*a;l=a*l+((16383&h)<<14)+n[i]+r,r=(l>>28)+(h>>14)+s*u,n[i++]=268435455&l}return r}function h(t){return ce.charAt(t)}function c(t,e){var n=de[t.charCodeAt(e)];return null==n?-1:n}function d(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function f(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0}function p(t){var e=a();return e.fromInt(t),e}function m(t,e){var n;if(16==e)n=4;else if(8==e)n=3;else if(256==e)n=8;else if(2==e)n=1;else if(32==e)n=5;else{if(4!=e)return void this.fromRadix(t,e);n=2}this.t=0,this.s=0;for(var i=t.length,r=!1,a=0;--i>=0;){var s=8==n?255&t[i]:c(t,i);s<0?"-"==t.charAt(i)&&(r=!0):(r=!1,0==a?this[this.t++]=s:a+n>this.DB?(this[this.t-1]|=(s&(1<<this.DB-a)-1)<<a,this[this.t++]=s>>this.DB-a):this[this.t-1]|=s<<a,(a+=n)>=this.DB&&(a-=this.DB))}8==n&&0!=(128&t[0])&&(this.s=-1,a>0&&(this[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),r&&o.ZERO.subTo(this,this)}function v(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function g(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var n,i=(1<<e)-1,r=!1,o="",a=this.t,s=this.DB-a*this.DB%e;if(a-- >0)for(s<this.DB&&(n=this[a]>>s)>0&&(r=!0,o=h(n));a>=0;)s<e?(n=(this[a]&(1<<s)-1)<<e-s,n|=this[--a]>>(s+=this.DB-e)):(n=this[a]>>(s-=e)&i,s<=0&&(s+=this.DB,--a)),n>0&&(r=!0),r&&(o+=h(n));return r?o:"0"}function y(){var t=a();return o.ZERO.subTo(this,t),t}function _(){return this.s<0?this.negate():this}function x(t){var e=this.s-t.s;if(0!=e)return e;var n=this.t;if(0!=(e=n-t.t))return this.s<0?-e:e;for(;--n>=0;)if(0!=(e=this[n]-t[n]))return e;return 0}function b(t){var e,n=1;return 0!=(e=t>>>16)&&(t=e,n+=16),0!=(e=t>>8)&&(t=e,n+=8),0!=(e=t>>4)&&(t=e,n+=4),0!=(e=t>>2)&&(t=e,n+=2),0!=(e=t>>1)&&(t=e,n+=1),n}function w(){return this.t<=0?0:this.DB*(this.t-1)+b(this[this.t-1]^this.s&this.DM)}function E(t,e){var n;for(n=this.t-1;n>=0;--n)e[n+t]=this[n];for(n=t-1;n>=0;--n)e[n]=0;e.t=this.t+t,e.s=this.s}function P(t,e){for(var n=t;n<this.t;++n)e[n-t]=this[n];e.t=Math.max(this.t-t,0),e.s=this.s}function M(t,e){var n,i=t%this.DB,r=this.DB-i,o=(1<<r)-1,a=Math.floor(t/this.DB),s=this.s<<i&this.DM;for(n=this.t-1;n>=0;--n)e[n+a+1]=this[n]>>r|s,s=(this[n]&o)<<i;for(n=a-1;n>=0;--n)e[n]=0;e[a]=s,e.t=this.t+a+1,e.s=this.s,e.clamp()}function S(t,e){e.s=this.s;var n=Math.floor(t/this.DB);if(n>=this.t)return void(e.t=0);var i=t%this.DB,r=this.DB-i,o=(1<<i)-1;e[0]=this[n]>>i;for(var a=n+1;a<this.t;++a)e[a-n-1]|=(this[a]&o)<<r,e[a-n]=this[a]>>i;i>0&&(e[this.t-n-1]|=(this.s&o)<<r),e.t=this.t-n,e.clamp()}function T(t,e){for(var n=0,i=0,r=Math.min(t.t,this.t);n<r;)i+=this[n]-t[n],e[n++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i-=t.s;n<this.t;)i+=this[n],e[n++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;n<t.t;)i-=t[n],e[n++]=i&this.DM,i>>=this.DB;i-=t.s}e.s=i<0?-1:0,i<-1?e[n++]=this.DV+i:i>0&&(e[n++]=i),e.t=n,e.clamp()}function C(t,e){var n=this.abs(),i=t.abs(),r=n.t;for(e.t=r+i.t;--r>=0;)e[r]=0;for(r=0;r<i.t;++r)e[r+n.t]=n.am(0,i[r],e,r,0,n.t);e.s=0,e.clamp(),this.s!=t.s&&o.ZERO.subTo(e,e)}function L(t){for(var e=this.abs(),n=t.t=2*e.t;--n>=0;)t[n]=0;for(n=0;n<e.t-1;++n){var i=e.am(n,e[n],t,2*n,0,1);(t[n+e.t]+=e.am(n+1,2*e[n],t,2*n+1,i,e.t-n-1))>=e.DV&&(t[n+e.t]-=e.DV,t[n+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(n,e[n],t,2*n,0,1)),t.s=0,t.clamp()}function A(t,e,n){var i=t.abs();if(!(i.t<=0)){var r=this.abs();if(r.t<i.t)return null!=e&&e.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=a());var s=a(),l=this.s,u=t.s,h=this.DB-b(i[i.t-1]);h>0?(i.lShiftTo(h,s),r.lShiftTo(h,n)):(i.copyTo(s),r.copyTo(n));var c=s.t,d=s[c-1];if(0!=d){var f=d*(1<<this.F1)+(c>1?s[c-2]>>this.F2:0),p=this.FV/f,m=(1<<this.F1)/f,v=1<<this.F2,g=n.t,y=g-c,_=null==e?a():e;for(s.dlShiftTo(y,_),n.compareTo(_)>=0&&(n[n.t++]=1,n.subTo(_,n)),o.ONE.dlShiftTo(c,_),_.subTo(s,s);s.t<c;)s[s.t++]=0;for(;--y>=0;){var x=n[--g]==d?this.DM:Math.floor(n[g]*p+(n[g-1]+v)*m);if((n[g]+=s.am(0,x,n,y,0,c))<x)for(s.dlShiftTo(y,_),n.subTo(_,n);n[g]<--x;)n.subTo(_,n)}null!=e&&(n.drShiftTo(c,e),l!=u&&o.ZERO.subTo(e,e)),n.t=c,n.clamp(),h>0&&n.rShiftTo(h,n),l<0&&o.ZERO.subTo(n,n)}}}function I(t){var e=a();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(o.ZERO)>0&&t.subTo(e,e),e}function N(t){this.m=t}function R(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function D(t){return t}function O(t){t.divRemTo(this.m,null,t)}function U(t,e,n){t.multiplyTo(e,n),this.reduce(n)}function F(t,e){t.squareTo(e),this.reduce(e)}function B(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function z(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function X(t){var e=a();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(o.ZERO)>0&&this.m.subTo(e,e),e}function k(t){var e=a();return t.copyTo(e),this.reduce(e),e}function G(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var n=32767&t[e],i=n*this.mpl+((n*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(n=e+this.m.t,t[n]+=this.m.am(0,i,t,e,0,this.m.t);t[n]>=t.DV;)t[n]-=t.DV,t[++n]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function V(t,e){t.squareTo(e),this.reduce(e)}function Y(t,e,n){t.multiplyTo(e,n),this.reduce(n)}function H(){return 0==(this.t>0?1&this[0]:this.s)}function W(t,e){if(t>4294967295||t<1)return o.ONE;var n=a(),i=a(),r=e.convert(this),s=b(t)-1;for(r.copyTo(n);--s>=0;)if(e.sqrTo(n,i),(t&1<<s)>0)e.mulTo(i,r,n);else{var l=n;n=i,i=l}return e.revert(n)}function j(t,e){var n;return n=t<256||e.isEven()?new N(e):new z(e),this.exp(t,n)}function q(){var t=a();return this.copyTo(t),t}function J(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function Z(){return 0==this.t?this.s:this[0]<<24>>24}function Q(){return 0==this.t?this.s:this[0]<<16>>16}function K(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function $(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function tt(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),n=Math.pow(t,e),i=p(n),r=a(),o=a(),s="";for(this.divRemTo(i,r,o);r.signum()>0;)s=(n+o.intValue()).toString(t).substr(1)+s,r.divRemTo(i,r,o);return o.intValue().toString(t)+s}function et(t,e){this.fromInt(0),null==e&&(e=10);for(var n=this.chunkSize(e),i=Math.pow(e,n),r=!1,a=0,s=0,l=0;l<t.length;++l){var u=c(t,l);u<0?"-"==t.charAt(l)&&0==this.signum()&&(r=!0):(s=e*s+u,++a>=n&&(this.dMultiply(i),this.dAddOffset(s,0),a=0,s=0))}a>0&&(this.dMultiply(Math.pow(e,a)),this.dAddOffset(s,0)),r&&o.ZERO.subTo(this,this)}function nt(t,e,n){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,n),this.testBit(t-1)||this.bitwiseTo(o.ONE.shiftLeft(t-1),ht,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(o.ONE.shiftLeft(t-1),this);else{var i=new Array,r=7&t;i.length=1+(t>>3),e.nextBytes(i),r>0?i[0]&=(1<<r)-1:i[0]=0,this.fromString(i,256)}}function it(){var t=this.t,e=new Array;e[0]=this.s;var n,i=this.DB-t*this.DB%8,r=0;if(t-- >0)for(i<this.DB&&(n=this[t]>>i)!=(this.s&this.DM)>>i&&(e[r++]=n|this.s<<this.DB-i);t>=0;)i<8?(n=(this[t]&(1<<i)-1)<<8-i,n|=this[--t]>>(i+=this.DB-8)):(n=this[t]>>(i-=8)&255,i<=0&&(i+=this.DB,--t)),0!=(128&n)&&(n|=-256),0==r&&(128&this.s)!=(128&n)&&++r,(r>0||n!=this.s)&&(e[r++]=n);return e}function rt(t){return 0==this.compareTo(t)}function ot(t){return this.compareTo(t)<0?this:t}function at(t){return this.compareTo(t)>0?this:t}function st(t,e,n){var i,r,o=Math.min(t.t,this.t);for(i=0;i<o;++i)n[i]=e(this[i],t[i]);if(t.t<this.t){for(r=t.s&this.DM,i=o;i<this.t;++i)n[i]=e(this[i],r);n.t=this.t}else{for(r=this.s&this.DM,i=o;i<t.t;++i)n[i]=e(r,t[i]);n.t=t.t}n.s=e(this.s,t.s),n.clamp()}function lt(t,e){return t&e}function ut(t){var e=a();return this.bitwiseTo(t,lt,e),e}function ht(t,e){return t|e}function ct(t){var e=a();return this.bitwiseTo(t,ht,e),e}function dt(t,e){return t^e}function ft(t){var e=a();return this.bitwiseTo(t,dt,e),e}function pt(t,e){return t&~e}function mt(t){var e=a();return this.bitwiseTo(t,pt,e),e}function vt(){for(var t=a(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}function gt(t){var e=a();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function yt(t){var e=a();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function _t(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function xt(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+_t(this[t]);return this.s<0?this.t*this.DB:-1}function bt(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function wt(){for(var t=0,e=this.s&this.DM,n=0;n<this.t;++n)t+=bt(this[n]^e);return t}function Et(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)}function Pt(t,e){var n=o.ONE.shiftLeft(t);return this.bitwiseTo(n,e,n),n}function Mt(t){return this.changeBit(t,ht)}function St(t){return this.changeBit(t,pt)}function Tt(t){return this.changeBit(t,dt)}function Ct(t,e){for(var n=0,i=0,r=Math.min(t.t,this.t);n<r;)i+=this[n]+t[n],e[n++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i+=t.s;n<this.t;)i+=this[n],e[n++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;n<t.t;)i+=t[n],e[n++]=i&this.DM,i>>=this.DB;i+=t.s}e.s=i<0?-1:0,i>0?e[n++]=i:i<-1&&(e[n++]=this.DV+i),e.t=n,e.clamp()}function Lt(t){var e=a();return this.addTo(t,e),e}function At(t){var e=a();return this.subTo(t,e),e}function It(t){var e=a();return this.multiplyTo(t,e),e}function Nt(){var t=a();return this.squareTo(t),t}function Rt(t){var e=a();return this.divRemTo(t,e,null),e}function Dt(t){var e=a();return this.divRemTo(t,null,e),e}function Ot(t){var e=a(),n=a();return this.divRemTo(t,e,n),new Array(e,n)}function Ut(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Ft(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function Bt(){}function zt(t){return t}function Xt(t,e,n){t.multiplyTo(e,n)}function kt(t,e){t.squareTo(e)}function Gt(t){return this.exp(t,new Bt)}function Vt(t,e,n){var i=Math.min(this.t+t.t,e);for(n.s=0,n.t=i;i>0;)n[--i]=0;var r;for(r=n.t-this.t;i<r;++i)n[i+this.t]=this.am(0,t[i],n,i,0,this.t);for(r=Math.min(t.t,e);i<r;++i)this.am(0,t[i],n,i,0,e-i);n.clamp()}function Yt(t,e,n){--e;var i=n.t=this.t+t.t-e;for(n.s=0;--i>=0;)n[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)n[this.t+i-e]=this.am(e-i,t[i],n,0,0,this.t+i-e);n.clamp(),n.drShiftTo(1,n)}function Ht(t){this.r2=a(),this.q3=a(),o.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function Wt(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=a();return t.copyTo(e),this.reduce(e),e}function jt(t){return t}function qt(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Jt(t,e){t.squareTo(e),this.reduce(e)}function Zt(t,e,n){t.multiplyTo(e,n),this.reduce(n)}function Qt(t,e){var n,i,r=t.bitLength(),o=p(1);if(r<=0)return o;n=r<18?1:r<48?3:r<144?4:r<768?5:6,i=r<8?new N(e):e.isEven()?new Ht(e):new z(e);var s=new Array,l=3,u=n-1,h=(1<<n)-1;if(s[1]=i.convert(this),n>1){var c=a();for(i.sqrTo(s[1],c);l<=h;)s[l]=a(),i.mulTo(c,s[l-2],s[l]),l+=2}var d,f,m=t.t-1,v=!0,g=a();for(r=b(t[m])-1;m>=0;){for(r>=u?d=t[m]>>r-u&h:(d=(t[m]&(1<<r+1)-1)<<u-r,m>0&&(d|=t[m-1]>>this.DB+r-u)),l=n;0==(1&d);)d>>=1,--l;if((r-=l)<0&&(r+=this.DB,--m),v)s[d].copyTo(o),v=!1;else{for(;l>1;)i.sqrTo(o,g),i.sqrTo(g,o),l-=2;l>0?i.sqrTo(o,g):(f=o,o=g,g=f),i.mulTo(g,s[d],o)}for(;m>=0&&0==(t[m]&1<<r);)i.sqrTo(o,g),f=o,o=g,g=f,--r<0&&(r=this.DB-1,--m)}return i.revert(o)}function Kt(t){var e=this.s<0?this.negate():this.clone(),n=t.s<0?t.negate():t.clone();if(e.compareTo(n)<0){var i=e;e=n,n=i}var r=e.getLowestSetBit(),o=n.getLowestSetBit();if(o<0)return e;for(r<o&&(o=r),o>0&&(e.rShiftTo(o,e),n.rShiftTo(o,n));e.signum()>0;)(r=e.getLowestSetBit())>0&&e.rShiftTo(r,e),(r=n.getLowestSetBit())>0&&n.rShiftTo(r,n),e.compareTo(n)>=0?(e.subTo(n,e),e.rShiftTo(1,e)):(n.subTo(e,n),n.rShiftTo(1,n));return o>0&&n.lShiftTo(o,n),n}function $t(t){if(t<=0)return 0;var e=this.DV%t,n=this.s<0?t-1:0;if(this.t>0)if(0==e)n=this[0]%t;else for(var i=this.t-1;i>=0;--i)n=(e*n+this[i])%t;return n}function te(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return o.ZERO;for(var n=t.clone(),i=this.clone(),r=p(1),a=p(0),s=p(0),l=p(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),e?(r.isEven()&&a.isEven()||(r.addTo(this,r),a.subTo(t,a)),r.rShiftTo(1,r)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);for(;i.isEven();)i.rShiftTo(1,i),e?(s.isEven()&&l.isEven()||(s.addTo(this,s),l.subTo(t,l)),s.rShiftTo(1,s)):l.isEven()||l.subTo(t,l),l.rShiftTo(1,l);n.compareTo(i)>=0?(n.subTo(i,n),e&&r.subTo(s,r),a.subTo(l,a)):(i.subTo(n,i),e&&s.subTo(r,s),l.subTo(a,l))}return 0!=i.compareTo(o.ONE)?o.ZERO:l.compareTo(t)>=0?l.subtract(t):l.signum()<0?(l.addTo(t,l),l.signum()<0?l.add(t):l):l}function ee(t){var e,n=this.abs();if(1==n.t&&n[0]<=fe[fe.length-1]){for(e=0;e<fe.length;++e)if(n[0]==fe[e])return!0;return!1}if(n.isEven())return!1;for(e=1;e<fe.length;){for(var i=fe[e],r=e+1;r<fe.length&&i<pe;)i*=fe[r++];for(i=n.modInt(i);e<r;)if(i%fe[e++]==0)return!1}return n.millerRabin(t)}function ne(t){var e=this.subtract(o.ONE),n=e.getLowestSetBit();if(n<=0)return!1;var i=e.shiftRight(n);(t=t+1>>1)>fe.length&&(t=fe.length);for(var r=a(),s=0;s<t;++s){r.fromInt(fe[Math.floor(Math.random()*fe.length)]);var l=r.modPow(i,this);if(0!=l.compareTo(o.ONE)&&0!=l.compareTo(e)){for(var u=1;u++<n&&0!=l.compareTo(e);)if(l=l.modPowInt(2,this),0==l.compareTo(o.ONE))return!1;if(0!=l.compareTo(e))return!1}}return!0}var ie={},re=!1;void 0!==t&&t.exports?(t.exports=ie,re=!0):(i=ie,void 0!==(r="function"==typeof i?i.call(e,n,e,t):i)&&(t.exports=r),"undefined"!=typeof document?window.ClipperLib=ie:self.ClipperLib=ie);var oe;if(re){var ae="chrome";oe="Netscape"}else{var ae=navigator.userAgent.toString().toLowerCase();oe=navigator.appName}var se={};-1!=ae.indexOf("chrome")&&-1==ae.indexOf("chromium")?se.chrome=1:se.chrome=0,-1!=ae.indexOf("chromium")?se.chromium=1:se.chromium=0,-1!=ae.indexOf("safari")&&-1==ae.indexOf("chrome")&&-1==ae.indexOf("chromium")?se.safari=1:se.safari=0,-1!=ae.indexOf("firefox")?se.firefox=1:se.firefox=0,-1!=ae.indexOf("firefox/17")?se.firefox17=1:se.firefox17=0,-1!=ae.indexOf("firefox/15")?se.firefox15=1:se.firefox15=0,-1!=ae.indexOf("firefox/3")?se.firefox3=1:se.firefox3=0,-1!=ae.indexOf("opera")?se.opera=1:se.opera=0,-1!=ae.indexOf("msie 10")?se.msie10=1:se.msie10=0,-1!=ae.indexOf("msie 9")?se.msie9=1:se.msie9=0,-1!=ae.indexOf("msie 8")?se.msie8=1:se.msie8=0,-1!=ae.indexOf("msie 7")?se.msie7=1:se.msie7=0,-1!=ae.indexOf("msie ")?se.msie=1:se.msie=0,ie.biginteger_used=null;var le;"Microsoft Internet Explorer"==oe?(o.prototype.am=l,le=30):"Netscape"!=oe?(o.prototype.am=s,le=26):(o.prototype.am=u,le=28),o.prototype.DB=le,o.prototype.DM=(1<<le)-1,o.prototype.DV=1<<le;o.prototype.FV=Math.pow(2,52),o.prototype.F1=52-le,o.prototype.F2=2*le-52;var ue,he,ce="0123456789abcdefghijklmnopqrstuvwxyz",de=new Array;for(ue="0".charCodeAt(0),he=0;he<=9;++he)de[ue++]=he;for(ue="a".charCodeAt(0),he=10;he<36;++he)de[ue++]=he;for(ue="A".charCodeAt(0),he=10;he<36;++he)de[ue++]=he;N.prototype.convert=R,N.prototype.revert=D,N.prototype.reduce=O,N.prototype.mulTo=U,N.prototype.sqrTo=F,z.prototype.convert=X,z.prototype.revert=k,z.prototype.reduce=G,z.prototype.mulTo=Y,z.prototype.sqrTo=V,o.prototype.copyTo=d,o.prototype.fromInt=f,o.prototype.fromString=m,o.prototype.clamp=v,o.prototype.dlShiftTo=E,o.prototype.drShiftTo=P,o.prototype.lShiftTo=M,o.prototype.rShiftTo=S,o.prototype.subTo=T,o.prototype.multiplyTo=C,o.prototype.squareTo=L,o.prototype.divRemTo=A,o.prototype.invDigit=B,o.prototype.isEven=H,o.prototype.exp=W,o.prototype.toString=g,o.prototype.negate=y,o.prototype.abs=_,o.prototype.compareTo=x,o.prototype.bitLength=w,o.prototype.mod=I,o.prototype.modPowInt=j,o.ZERO=p(0),o.ONE=p(1),Bt.prototype.convert=zt,Bt.prototype.revert=zt,Bt.prototype.mulTo=Xt,Bt.prototype.sqrTo=kt,Ht.prototype.convert=Wt,Ht.prototype.revert=jt,Ht.prototype.reduce=qt,Ht.prototype.mulTo=Zt,Ht.prototype.sqrTo=Jt;var fe=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],pe=(1<<26)/fe[fe.length-1];o.prototype.chunkSize=K,o.prototype.toRadix=tt,o.prototype.fromRadix=et,o.prototype.fromNumber=nt,o.prototype.bitwiseTo=st,o.prototype.changeBit=Pt,o.prototype.addTo=Ct,o.prototype.dMultiply=Ut,o.prototype.dAddOffset=Ft,o.prototype.multiplyLowerTo=Vt,o.prototype.multiplyUpperTo=Yt,o.prototype.modInt=$t,o.prototype.millerRabin=ne,o.prototype.clone=q,o.prototype.intValue=J,o.prototype.byteValue=Z,o.prototype.shortValue=Q,o.prototype.signum=$,o.prototype.toByteArray=it,o.prototype.equals=rt,o.prototype.min=ot,o.prototype.max=at,o.prototype.and=ut,o.prototype.or=ct,o.prototype.xor=ft,o.prototype.andNot=mt,o.prototype.not=vt,o.prototype.shiftLeft=gt,o.prototype.shiftRight=yt,o.prototype.getLowestSetBit=xt,o.prototype.bitCount=wt,o.prototype.testBit=Et,o.prototype.setBit=Mt,o.prototype.clearBit=St,o.prototype.flipBit=Tt,o.prototype.add=Lt,o.prototype.subtract=At,o.prototype.multiply=It,o.prototype.divide=Rt,o.prototype.remainder=Dt,o.prototype.divideAndRemainder=Ot,o.prototype.modPow=Qt,o.prototype.modInverse=te,o.prototype.pow=Gt,o.prototype.gcd=Kt,o.prototype.isProbablePrime=ee,o.prototype.square=Nt;var me=o;me.prototype.IsNegative=function(){return-1==this.compareTo(me.ZERO)},me.op_Equality=function(t,e){return 0==t.compareTo(e)},me.op_Inequality=function(t,e){return 0!=t.compareTo(e)},me.op_GreaterThan=function(t,e){return t.compareTo(e)>0},me.op_LessThan=function(t,e){return t.compareTo(e)<0},me.op_Addition=function(t,e){return new me(t).add(new me(e))},me.op_Subtraction=function(t,e){return new me(t).subtract(new me(e))},me.Int128Mul=function(t,e){return new me(t).multiply(new me(e))},me.op_Division=function(t,e){return t.divide(e)},me.prototype.ToDouble=function(){return parseFloat(this.toString())};var ve=function(t,e){var n;if(void 0===Object.getOwnPropertyNames){for(n in e.prototype)void 0!==t.prototype[n]&&t.prototype[n]!=Object.prototype[n]||(t.prototype[n]=e.prototype[n]);for(n in e)void 0===t[n]&&(t[n]=e[n]);t.$baseCtor=e}else{for(var i=Object.getOwnPropertyNames(e.prototype),r=0;r<i.length;r++)void 0===Object.getOwnPropertyDescriptor(t.prototype,i[r])&&Object.defineProperty(t.prototype,i[r],Object.getOwnPropertyDescriptor(e.prototype,i[r]));for(n in e)void 0===t[n]&&(t[n]=e[n]);t.$baseCtor=e}};ie.Path=function(){return[]},ie.Paths=function(){return[]},ie.DoublePoint=function(){var t=arguments;this.X=0,this.Y=0,1==t.length?(this.X=t[0].X,this.Y=t[0].Y):2==t.length&&(this.X=t[0],this.Y=t[1])},ie.DoublePoint0=function(){this.X=0,this.Y=0},ie.DoublePoint1=function(t){this.X=t.X,this.Y=t.Y},ie.DoublePoint2=function(t,e){this.X=t,this.Y=e},ie.PolyNode=function(){this.m_Parent=null,this.m_polygon=new ie.Path,this.m_Index=0,this.m_jointype=0,this.m_endtype=0,this.m_Childs=[],this.IsOpen=!1},ie.PolyNode.prototype.IsHoleNode=function(){for(var t=!0,e=this.m_Parent;null!==e;)t=!t,e=e.m_Parent;return t},ie.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length},ie.PolyNode.prototype.Contour=function(){return this.m_polygon},ie.PolyNode.prototype.AddChild=function(t){var e=this.m_Childs.length;this.m_Childs.push(t),t.m_Parent=this,t.m_Index=e},ie.PolyNode.prototype.GetNext=function(){return this.m_Childs.length>0?this.m_Childs[0]:this.GetNextSiblingUp()},ie.PolyNode.prototype.GetNextSiblingUp=function(){return null===this.m_Parent?null:this.m_Index==this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]},ie.PolyNode.prototype.Childs=function(){return this.m_Childs},ie.PolyNode.prototype.Parent=function(){return this.m_Parent},ie.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()},ie.PolyTree=function(){this.m_AllPolys=[],ie.PolyNode.call(this)},ie.PolyTree.prototype.Clear=function(){for(var t=0,e=this.m_AllPolys.length;t<e;t++)this.m_AllPolys[t]=null;this.m_AllPolys.length=0,this.m_Childs.length=0},ie.PolyTree.prototype.GetFirst=function(){return this.m_Childs.length>0?this.m_Childs[0]:null},ie.PolyTree.prototype.Total=function(){var t=this.m_AllPolys.length;return t>0&&this.m_Childs[0]!=this.m_AllPolys[0]&&t--,t},ve(ie.PolyTree,ie.PolyNode),ie.Math_Abs_Int64=ie.Math_Abs_Int32=ie.Math_Abs_Double=function(t){return Math.abs(t)},ie.Math_Max_Int32_Int32=function(t,e){return Math.max(t,e)},se.msie||se.opera||se.safari?ie.Cast_Int32=function(t){return 0|t}:ie.Cast_Int32=function(t){return~~t},se.chrome?ie.Cast_Int64=function(t){return t<-2147483648||t>2147483647?t<0?Math.ceil(t):Math.floor(t):~~t}:se.firefox&&"function"==typeof Number.toInteger?ie.Cast_Int64=function(t){return Number.toInteger(t)}:se.msie7||se.msie8?ie.Cast_Int64=function(t){return parseInt(t,10)}:se.msie?ie.Cast_Int64=function(t){return t<-2147483648||t>2147483647?t<0?Math.ceil(t):Math.floor(t):0|t}:ie.Cast_Int64=function(t){return t<0?Math.ceil(t):Math.floor(t)},ie.Clear=function(t){t.length=0},ie.PI=3.141592653589793,ie.PI2=6.283185307179586,ie.IntPoint=function(){var t=arguments,e=t.length;this.X=0,this.Y=0;var n,i;if(2==e)this.X=t[0],this.Y=t[1];else if(1==e)if(t[0]instanceof ie.DoublePoint){var n=t[0];this.X=ie.Clipper.Round(n.X),this.Y=ie.Clipper.Round(n.Y)}else{var i=t[0];this.X=i.X,this.Y=i.Y}else this.X=0,this.Y=0},ie.IntPoint.op_Equality=function(t,e){return t.X==e.X&&t.Y==e.Y},ie.IntPoint.op_Inequality=function(t,e){return t.X!=e.X||t.Y!=e.Y},ie.IntPoint0=function(){this.X=0,this.Y=0},ie.IntPoint1=function(t){this.X=t.X,this.Y=t.Y},ie.IntPoint1dp=function(t){this.X=ie.Clipper.Round(t.X),this.Y=ie.Clipper.Round(t.Y)},ie.IntPoint2=function(t,e){this.X=t,this.Y=e},ie.IntRect=function(){var t=arguments,e=t.length;4==e?(this.left=t[0],this.top=t[1],this.right=t[2],this.bottom=t[3]):1==e?(this.left=ir.left,this.top=ir.top,this.right=ir.right,this.bottom=ir.bottom):(this.left=0,this.top=0,this.right=0,this.bottom=0)},ie.IntRect0=function(){this.left=0,this.top=0,this.right=0,this.bottom=0},ie.IntRect1=function(t){this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom},ie.IntRect4=function(t,e,n,i){this.left=t,this.top=e,this.right=n,this.bottom=i},ie.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3},ie.PolyType={ptSubject:0,ptClip:1},ie.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3},ie.JoinType={jtSquare:0,jtRound:1,jtMiter:2},ie.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4},ie.EdgeSide={esLeft:0,esRight:1},ie.Direction={dRightToLeft:0,dLeftToRight:1},ie.TEdge=function(){this.Bot=new ie.IntPoint,this.Curr=new ie.IntPoint,this.Top=new ie.IntPoint,this.Delta=new ie.IntPoint,this.Dx=0,this.PolyTyp=ie.PolyType.ptSubject,this.Side=ie.EdgeSide.esLeft,this.WindDelta=0,this.WindCnt=0,this.WindCnt2=0,this.OutIdx=0,this.Next=null,this.Prev=null,this.NextInLML=null,this.NextInAEL=null,this.PrevInAEL=null,this.NextInSEL=null,this.PrevInSEL=null},ie.IntersectNode=function(){this.Edge1=null,this.Edge2=null,this.Pt=new ie.IntPoint},ie.MyIntersectNodeSort=function(){},ie.MyIntersectNodeSort.Compare=function(t,e){var n=e.Pt.Y-t.Pt.Y;return n>0?1:n<0?-1:0},ie.LocalMinima=function(){this.Y=0,this.LeftBound=null,this.RightBound=null,this.Next=null},ie.Scanbeam=function(){this.Y=0,this.Next=null},ie.OutRec=function(){this.Idx=0,this.IsHole=!1,this.IsOpen=!1,this.FirstLeft=null,this.Pts=null,this.BottomPt=null,this.PolyNode=null},ie.OutPt=function(){this.Idx=0,this.Pt=new ie.IntPoint,this.Next=null,this.Prev=null},ie.Join=function(){this.OutPt1=null,this.OutPt2=null,this.OffPt=new ie.IntPoint},ie.ClipperBase=function(){this.m_MinimaList=null,this.m_CurrentLM=null,this.m_edges=new Array,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1,this.PreserveCollinear=!1,this.m_MinimaList=null,this.m_CurrentLM=null,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},ie.ClipperBase.horizontal=-9007199254740992,ie.ClipperBase.Skip=-2,ie.ClipperBase.Unassigned=-1,ie.ClipperBase.tolerance=1e-20,ie.ClipperBase.loRange=47453132,ie.ClipperBase.hiRange=0xfffffffffffff,ie.ClipperBase.near_zero=function(t){return t>-ie.ClipperBase.tolerance&&t<ie.ClipperBase.tolerance},ie.ClipperBase.IsHorizontal=function(t){return 0===t.Delta.Y},ie.ClipperBase.prototype.PointIsVertex=function(t,e){var n=e;do{if(ie.IntPoint.op_Equality(n.Pt,t))return!0;n=n.Next}while(n!=e);return!1},ie.ClipperBase.prototype.PointOnLineSegment=function(t,e,n,i){return i?t.X==e.X&&t.Y==e.Y||t.X==n.X&&t.Y==n.Y||t.X>e.X==t.X<n.X&&t.Y>e.Y==t.Y<n.Y&&me.op_Equality(me.Int128Mul(t.X-e.X,n.Y-e.Y),me.Int128Mul(n.X-e.X,t.Y-e.Y)):t.X==e.X&&t.Y==e.Y||t.X==n.X&&t.Y==n.Y||t.X>e.X==t.X<n.X&&t.Y>e.Y==t.Y<n.Y&&(t.X-e.X)*(n.Y-e.Y)==(n.X-e.X)*(t.Y-e.Y)},ie.ClipperBase.prototype.PointOnPolygon=function(t,e,n){for(var i=e;;){if(this.PointOnLineSegment(t,i.Pt,i.Next.Pt,n))return!0;if((i=i.Next)==e)break}return!1},ie.ClipperBase.prototype.SlopesEqual=ie.ClipperBase.SlopesEqual=function(){var t,e,n,i,r,o,a,s=arguments,l=s.length;return 3==l?(t=s[0],e=s[1],a=s[2],a?me.op_Equality(me.Int128Mul(t.Delta.Y,e.Delta.X),me.Int128Mul(t.Delta.X,e.Delta.Y)):ie.Cast_Int64(t.Delta.Y*e.Delta.X)==ie.Cast_Int64(t.Delta.X*e.Delta.Y)):4==l?(n=s[0],i=s[1],r=s[2],a=s[3],a?me.op_Equality(me.Int128Mul(n.Y-i.Y,i.X-r.X),me.Int128Mul(n.X-i.X,i.Y-r.Y)):ie.Cast_Int64((n.Y-i.Y)*(i.X-r.X))-ie.Cast_Int64((n.X-i.X)*(i.Y-r.Y))==0):(n=s[0],i=s[1],r=s[2],o=s[3],a=s[4],a?me.op_Equality(me.Int128Mul(n.Y-i.Y,r.X-o.X),me.Int128Mul(n.X-i.X,r.Y-o.Y)):ie.Cast_Int64((n.Y-i.Y)*(r.X-o.X))-ie.Cast_Int64((n.X-i.X)*(r.Y-o.Y))==0)},ie.ClipperBase.SlopesEqual3=function(t,e,n){return n?me.op_Equality(me.Int128Mul(t.Delta.Y,e.Delta.X),me.Int128Mul(t.Delta.X,e.Delta.Y)):ie.Cast_Int64(t.Delta.Y*e.Delta.X)==ie.Cast_Int64(t.Delta.X*e.Delta.Y)},ie.ClipperBase.SlopesEqual4=function(t,e,n,i){return i?me.op_Equality(me.Int128Mul(t.Y-e.Y,e.X-n.X),me.Int128Mul(t.X-e.X,e.Y-n.Y)):ie.Cast_Int64((t.Y-e.Y)*(e.X-n.X))-ie.Cast_Int64((t.X-e.X)*(e.Y-n.Y))==0},ie.ClipperBase.SlopesEqual5=function(t,e,n,i,r){return r?me.op_Equality(me.Int128Mul(t.Y-e.Y,n.X-i.X),me.Int128Mul(t.X-e.X,n.Y-i.Y)):ie.Cast_Int64((t.Y-e.Y)*(n.X-i.X))-ie.Cast_Int64((t.X-e.X)*(n.Y-i.Y))==0},ie.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var t=0,e=this.m_edges.length;t<e;++t){for(var n=0,i=this.m_edges[t].length;n<i;++n)this.m_edges[t][n]=null;ie.Clear(this.m_edges[t])}ie.Clear(this.m_edges),this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},ie.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;null!==this.m_MinimaList;){var t=this.m_MinimaList.Next;this.m_MinimaList=null,this.m_MinimaList=t}this.m_CurrentLM=null},ie.ClipperBase.prototype.RangeTest=function(t,e){e.Value?(t.X>ie.ClipperBase.hiRange||t.Y>ie.ClipperBase.hiRange||-t.X>ie.ClipperBase.hiRange||-t.Y>ie.ClipperBase.hiRange)&&ie.Error("Coordinate outside allowed range in RangeTest()."):(t.X>ie.ClipperBase.loRange||t.Y>ie.ClipperBase.loRange||-t.X>ie.ClipperBase.loRange||-t.Y>ie.ClipperBase.loRange)&&(e.Value=!0,this.RangeTest(t,e))},ie.ClipperBase.prototype.InitEdge=function(t,e,n,i){t.Next=e,t.Prev=n,t.Curr.X=i.X,t.Curr.Y=i.Y,t.OutIdx=-1},ie.ClipperBase.prototype.InitEdge2=function(t,e){t.Curr.Y>=t.Next.Curr.Y?(t.Bot.X=t.Curr.X,t.Bot.Y=t.Curr.Y,t.Top.X=t.Next.Curr.X,t.Top.Y=t.Next.Curr.Y):(t.Top.X=t.Curr.X,t.Top.Y=t.Curr.Y,t.Bot.X=t.Next.Curr.X,t.Bot.Y=t.Next.Curr.Y),this.SetDx(t),t.PolyTyp=e},ie.ClipperBase.prototype.FindNextLocMin=function(t){for(var e;;){for(;ie.IntPoint.op_Inequality(t.Bot,t.Prev.Bot)||ie.IntPoint.op_Equality(t.Curr,t.Top);)t=t.Next;if(t.Dx!=ie.ClipperBase.horizontal&&t.Prev.Dx!=ie.ClipperBase.horizontal)break;for(;t.Prev.Dx==ie.ClipperBase.horizontal;)t=t.Prev;for(e=t;t.Dx==ie.ClipperBase.horizontal;)t=t.Next;if(t.Top.Y!=t.Prev.Bot.Y){e.Prev.Bot.X<t.Bot.X&&(t=e);break}}return t},ie.ClipperBase.prototype.ProcessBound=function(t,e){var n,i,r=t;if(r.OutIdx==ie.ClipperBase.Skip){if(t=r,e){for(;t.Top.Y==t.Next.Bot.Y;)t=t.Next;for(;t!=r&&t.Dx==ie.ClipperBase.horizontal;)t=t.Prev}else{for(;t.Top.Y==t.Prev.Bot.Y;)t=t.Prev;for(;t!=r&&t.Dx==ie.ClipperBase.horizontal;)t=t.Next}if(t==r)r=e?t.Next:t.Prev;else{t=e?r.Next:r.Prev;var o=new ie.LocalMinima;o.Next=null,o.Y=t.Bot.Y,o.LeftBound=null,o.RightBound=t,t.WindDelta=0,r=this.ProcessBound(t,e),this.InsertLocalMinima(o)}return r}if(t.Dx==ie.ClipperBase.horizontal&&(n=e?t.Prev:t.Next,n.OutIdx!=ie.ClipperBase.Skip&&(n.Dx==ie.ClipperBase.horizontal?n.Bot.X!=t.Bot.X&&n.Top.X!=t.Bot.X&&this.ReverseHorizontal(t):n.Bot.X!=t.Bot.X&&this.ReverseHorizontal(t))),n=t,e){for(;r.Top.Y==r.Next.Bot.Y&&r.Next.OutIdx!=ie.ClipperBase.Skip;)r=r.Next;if(r.Dx==ie.ClipperBase.horizontal&&r.Next.OutIdx!=ie.ClipperBase.Skip){for(i=r;i.Prev.Dx==ie.ClipperBase.horizontal;)i=i.Prev;i.Prev.Top.X==r.Next.Top.X?e||(r=i.Prev):i.Prev.Top.X>r.Next.Top.X&&(r=i.Prev)}for(;t!=r;)t.NextInLML=t.Next,t.Dx==ie.ClipperBase.horizontal&&t!=n&&t.Bot.X!=t.Prev.Top.X&&this.ReverseHorizontal(t),t=t.Next;t.Dx==ie.ClipperBase.horizontal&&t!=n&&t.Bot.X!=t.Prev.Top.X&&this.ReverseHorizontal(t),r=r.Next}else{for(;r.Top.Y==r.Prev.Bot.Y&&r.Prev.OutIdx!=ie.ClipperBase.Skip;)r=r.Prev;if(r.Dx==ie.ClipperBase.horizontal&&r.Prev.OutIdx!=ie.ClipperBase.Skip){for(i=r;i.Next.Dx==ie.ClipperBase.horizontal;)i=i.Next;i.Next.Top.X==r.Prev.Top.X?e||(r=i.Next):i.Next.Top.X>r.Prev.Top.X&&(r=i.Next)}for(;t!=r;)t.NextInLML=t.Prev,t.Dx==ie.ClipperBase.horizontal&&t!=n&&t.Bot.X!=t.Next.Top.X&&this.ReverseHorizontal(t),t=t.Prev;t.Dx==ie.ClipperBase.horizontal&&t!=n&&t.Bot.X!=t.Next.Top.X&&this.ReverseHorizontal(t),r=r.Prev}return r},ie.ClipperBase.prototype.AddPath=function(t,e,n){n||e!=ie.PolyType.ptClip||ie.Error("AddPath: Open paths must be subject.");var i=t.length-1;if(n)for(;i>0&&ie.IntPoint.op_Equality(t[i],t[0]);)--i;for(;i>0&&ie.IntPoint.op_Equality(t[i],t[i-1]);)--i;if(n&&i<2||!n&&i<1)return!1;for(var r=new Array,o=0;o<=i;o++)r.push(new ie.TEdge);var a=!0;r[1].Curr.X=t[1].X,r[1].Curr.Y=t[1].Y;var s={Value:this.m_UseFullRange};this.RangeTest(t[0],s),this.m_UseFullRange=s.Value,s.Value=this.m_UseFullRange,this.RangeTest(t[i],s),this.m_UseFullRange=s.Value,this.InitEdge(r[0],r[1],r[i],t[0]),this.InitEdge(r[i],r[0],r[i-1],t[i]);for(var o=i-1;o>=1;--o)s.Value=this.m_UseFullRange,this.RangeTest(t[o],s),this.m_UseFullRange=s.Value,this.InitEdge(r[o],r[o+1],r[o-1],t[o]);for(var l=r[0],u=l,h=l;;)if(u.Curr!=u.Next.Curr||!n&&u.Next==l){if(u.Prev==u.Next)break;if(!n||!ie.ClipperBase.SlopesEqual(u.Prev.Curr,u.Curr,u.Next.Curr,this.m_UseFullRange)||this.PreserveCollinear&&this.Pt2IsBetweenPt1AndPt3(u.Prev.Curr,u.Curr,u.Next.Curr)){if((u=u.Next)==h||!n&&u.Next==l)break}else u==l&&(l=u.Next),u=this.RemoveEdge(u),u=u.Prev,h=u}else{if(u==u.Next)break;u==l&&(l=u.Next),u=this.RemoveEdge(u),h=u}if(!n&&u==u.Next||n&&u.Prev==u.Next)return!1;n||(this.m_HasOpenPaths=!0,l.Prev.OutIdx=ie.ClipperBase.Skip),u=l;do{this.InitEdge2(u,e),u=u.Next,a&&u.Curr.Y!=l.Curr.Y&&(a=!1)}while(u!=l);if(a){if(n)return!1;u.Prev.OutIdx=ie.ClipperBase.Skip,u.Prev.Bot.X<u.Prev.Top.X&&this.ReverseHorizontal(u.Prev);var c=new ie.LocalMinima;for(c.Next=null,c.Y=u.Bot.Y,c.LeftBound=null,c.RightBound=u,c.RightBound.Side=ie.EdgeSide.esRight,c.RightBound.WindDelta=0;u.Next.OutIdx!=ie.ClipperBase.Skip;)u.NextInLML=u.Next,u.Bot.X!=u.Prev.Top.X&&this.ReverseHorizontal(u),u=u.Next;return this.InsertLocalMinima(c),this.m_edges.push(r),!0}this.m_edges.push(r);var d,f=null;for(ie.IntPoint.op_Equality(u.Prev.Bot,u.Prev.Top)&&(u=u.Next);(u=this.FindNextLocMin(u))!=f;){null==f&&(f=u);var c=new ie.LocalMinima;c.Next=null,c.Y=u.Bot.Y,u.Dx<u.Prev.Dx?(c.LeftBound=u.Prev,c.RightBound=u,d=!1):(c.LeftBound=u,c.RightBound=u.Prev,d=!0),c.LeftBound.Side=ie.EdgeSide.esLeft,c.RightBound.Side=ie.EdgeSide.esRight,n?c.LeftBound.Next==c.RightBound?c.LeftBound.WindDelta=-1:c.LeftBound.WindDelta=1:c.LeftBound.WindDelta=0,c.RightBound.WindDelta=-c.LeftBound.WindDelta,u=this.ProcessBound(c.LeftBound,d),u.OutIdx==ie.ClipperBase.Skip&&(u=this.ProcessBound(u,d));var p=this.ProcessBound(c.RightBound,!d);p.OutIdx==ie.ClipperBase.Skip&&(p=this.ProcessBound(p,!d)),c.LeftBound.OutIdx==ie.ClipperBase.Skip?c.LeftBound=null:c.RightBound.OutIdx==ie.ClipperBase.Skip&&(c.RightBound=null),this.InsertLocalMinima(c),d||(u=p)}return!0},ie.ClipperBase.prototype.AddPaths=function(t,e,n){for(var i=!1,r=0,o=t.length;r<o;++r)this.AddPath(t[r],e,n)&&(i=!0);return i},ie.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(t,e,n){return!(ie.IntPoint.op_Equality(t,n)||ie.IntPoint.op_Equality(t,e)||ie.IntPoint.op_Equality(n,e))&&(t.X!=n.X?e.X>t.X==e.X<n.X:e.Y>t.Y==e.Y<n.Y)},ie.ClipperBase.prototype.RemoveEdge=function(t){t.Prev.Next=t.Next,t.Next.Prev=t.Prev;var e=t.Next;return t.Prev=null,e},ie.ClipperBase.prototype.SetDx=function(t){t.Delta.X=t.Top.X-t.Bot.X,t.Delta.Y=t.Top.Y-t.Bot.Y,0===t.Delta.Y?t.Dx=ie.ClipperBase.horizontal:t.Dx=t.Delta.X/t.Delta.Y},ie.ClipperBase.prototype.InsertLocalMinima=function(t){if(null===this.m_MinimaList)this.m_MinimaList=t;else if(t.Y>=this.m_MinimaList.Y)t.Next=this.m_MinimaList,this.m_MinimaList=t;else{for(var e=this.m_MinimaList;null!==e.Next&&t.Y<e.Next.Y;)e=e.Next;t.Next=e.Next,e.Next=t}},ie.ClipperBase.prototype.PopLocalMinima=function(){null!==this.m_CurrentLM&&(this.m_CurrentLM=this.m_CurrentLM.Next)},ie.ClipperBase.prototype.ReverseHorizontal=function(t){var e=t.Top.X;t.Top.X=t.Bot.X,t.Bot.X=e},ie.ClipperBase.prototype.Reset=function(){if(this.m_CurrentLM=this.m_MinimaList,null!=this.m_CurrentLM)for(var t=this.m_MinimaList;null!=t;){var e=t.LeftBound;null!=e&&(e.Curr.X=e.Bot.X,e.Curr.Y=e.Bot.Y,e.Side=ie.EdgeSide.esLeft,e.OutIdx=ie.ClipperBase.Unassigned),e=t.RightBound,null!=e&&(e.Curr.X=e.Bot.X,e.Curr.Y=e.Bot.Y,e.Side=ie.EdgeSide.esRight,e.OutIdx=ie.ClipperBase.Unassigned),t=t.Next}},ie.Clipper=function(t){void 0===t&&(t=0),this.m_PolyOuts=null,this.m_ClipType=ie.ClipType.ctIntersection,this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=null,this.m_IntersectNodeComparer=null,this.m_ExecuteLocked=!1,this.m_ClipFillType=ie.PolyFillType.pftEvenOdd,this.m_SubjFillType=ie.PolyFillType.pftEvenOdd,this.m_Joins=null,this.m_GhostJoins=null,this.m_UsingPolyTree=!1,this.ReverseSolution=!1,this.StrictlySimple=!1,ie.ClipperBase.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=new Array,this.m_IntersectNodeComparer=ie.MyIntersectNodeSort.Compare,this.m_ExecuteLocked=!1,this.m_UsingPolyTree=!1,this.m_PolyOuts=new Array,this.m_Joins=new Array,this.m_GhostJoins=new Array,this.ReverseSolution=0!=(1&t),this.StrictlySimple=0!=(2&t),this.PreserveCollinear=0!=(4&t)},ie.Clipper.ioReverseSolution=1,ie.Clipper.ioStrictlySimple=2,ie.Clipper.ioPreserveCollinear=4,ie.Clipper.prototype.Clear=function(){0!==this.m_edges.length&&(this.DisposeAllPolyPts(),ie.ClipperBase.prototype.Clear.call(this))},ie.Clipper.prototype.DisposeScanbeamList=function(){for(;null!==this.m_Scanbeam;){var t=this.m_Scanbeam.Next;this.m_Scanbeam=null,this.m_Scanbeam=t}},ie.Clipper.prototype.Reset=function(){ie.ClipperBase.prototype.Reset.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null;for(var t=this.m_MinimaList;null!==t;)this.InsertScanbeam(t.Y),t=t.Next},ie.Clipper.prototype.InsertScanbeam=function(t){if(null===this.m_Scanbeam)this.m_Scanbeam=new ie.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=t;else if(t>this.m_Scanbeam.Y){var e=new ie.Scanbeam;e.Y=t,e.Next=this.m_Scanbeam,this.m_Scanbeam=e}else{for(var n=this.m_Scanbeam;null!==n.Next&&t<=n.Next.Y;)n=n.Next;if(t==n.Y)return;var e=new ie.Scanbeam;e.Y=t,e.Next=n.Next,n.Next=e}},ie.Clipper.prototype.Execute=function(){var t=arguments,e=t.length,n=t[1]instanceof ie.PolyTree;if(4==e&&!n){var i=t[0],r=t[1],o=t[2],a=t[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&ie.Error("Error: PolyTree struct is need for open path clipping."),this.m_ExecuteLocked=!0,ie.Clear(r),this.m_SubjFillType=o,this.m_ClipFillType=a,this.m_ClipType=i,this.m_UsingPolyTree=!1;try{var s=this.ExecuteInternal();s&&this.BuildResult(r)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return s}if(4==e&&n){var i=t[0],l=t[1],o=t[2],a=t[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,this.m_SubjFillType=o,this.m_ClipFillType=a,this.m_ClipType=i,this.m_UsingPolyTree=!0;try{var s=this.ExecuteInternal();s&&this.BuildResult2(l)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return s}if(2==e&&!n){var i=t[0],r=t[1];return this.Execute(i,r,ie.PolyFillType.pftEvenOdd,ie.PolyFillType.pftEvenOdd)}if(2==e&&n){var i=t[0],l=t[1];return this.Execute(i,l,ie.PolyFillType.pftEvenOdd,ie.PolyFillType.pftEvenOdd)}},ie.Clipper.prototype.FixHoleLinkage=function(t){if(null!==t.FirstLeft&&(t.IsHole==t.FirstLeft.IsHole||null===t.FirstLeft.Pts)){for(var e=t.FirstLeft;null!==e&&(e.IsHole==t.IsHole||null===e.Pts);)e=e.FirstLeft;t.FirstLeft=e}},ie.Clipper.prototype.ExecuteInternal=function(){try{if(this.Reset(),null===this.m_CurrentLM)return!1;var t=this.PopScanbeam();do{if(this.InsertLocalMinimaIntoAEL(t),ie.Clear(this.m_GhostJoins),this.ProcessHorizontals(!1),null===this.m_Scanbeam)break;var e=this.PopScanbeam();if(!this.ProcessIntersections(e))return!1;this.ProcessEdgesAtTopOfScanbeam(e),t=e}while(null!==this.m_Scanbeam||null!==this.m_CurrentLM);for(var n=0,i=this.m_PolyOuts.length;n<i;n++){var r=this.m_PolyOuts[n];null===r.Pts||r.IsOpen||(r.IsHole^this.ReverseSolution)==this.Area(r)>0&&this.ReversePolyPtLinks(r.Pts)}this.JoinCommonEdges();for(var n=0,i=this.m_PolyOuts.length;n<i;n++){var r=this.m_PolyOuts[n];null===r.Pts||r.IsOpen||this.FixupOutPolygon(r)}return this.StrictlySimple&&this.DoSimplePolygons(),!0}finally{ie.Clear(this.m_Joins),ie.Clear(this.m_GhostJoins)}},ie.Clipper.prototype.PopScanbeam=function(){var t=this.m_Scanbeam.Y;return this.m_Scanbeam=this.m_Scanbeam.Next,t},ie.Clipper.prototype.DisposeAllPolyPts=function(){for(var t=0,e=this.m_PolyOuts.length;t<e;++t)this.DisposeOutRec(t);ie.Clear(this.m_PolyOuts)},ie.Clipper.prototype.DisposeOutRec=function(t){var e=this.m_PolyOuts[t];e.Pts=null,e=null,this.m_PolyOuts[t]=null},ie.Clipper.prototype.AddJoin=function(t,e,n){var i=new ie.Join;i.OutPt1=t,i.OutPt2=e,i.OffPt.X=n.X,i.OffPt.Y=n.Y,this.m_Joins.push(i)},ie.Clipper.prototype.AddGhostJoin=function(t,e){var n=new ie.Join;n.OutPt1=t,n.OffPt.X=e.X,n.OffPt.Y=e.Y,this.m_GhostJoins.push(n)},ie.Clipper.prototype.InsertLocalMinimaIntoAEL=function(t){for(;null!==this.m_CurrentLM&&this.m_CurrentLM.Y==t;){var e=this.m_CurrentLM.LeftBound,n=this.m_CurrentLM.RightBound;this.PopLocalMinima();var i=null;if(null===e?(this.InsertEdgeIntoAEL(n,null),this.SetWindingCount(n),this.IsContributing(n)&&(i=this.AddOutPt(n,n.Bot))):null==n?(this.InsertEdgeIntoAEL(e,null),this.SetWindingCount(e),this.IsContributing(e)&&(i=this.AddOutPt(e,e.Bot)),this.InsertScanbeam(e.Top.Y)):(this.InsertEdgeIntoAEL(e,null),this.InsertEdgeIntoAEL(n,e),this.SetWindingCount(e),n.WindCnt=e.WindCnt,n.WindCnt2=e.WindCnt2,this.IsContributing(e)&&(i=this.AddLocalMinPoly(e,n,e.Bot)),this.InsertScanbeam(e.Top.Y)),null!=n&&(ie.ClipperBase.IsHorizontal(n)?this.AddEdgeToSEL(n):this.InsertScanbeam(n.Top.Y)),null!=e&&null!=n){if(null!==i&&ie.ClipperBase.IsHorizontal(n)&&this.m_GhostJoins.length>0&&0!==n.WindDelta)for(var r=0,o=this.m_GhostJoins.length;r<o;r++){var a=this.m_GhostJoins[r];this.HorzSegmentsOverlap(a.OutPt1.Pt.X,a.OffPt.X,n.Bot.X,n.Top.X)&&this.AddJoin(a.OutPt1,i,a.OffPt)}if(e.OutIdx>=0&&null!==e.PrevInAEL&&e.PrevInAEL.Curr.X==e.Bot.X&&e.PrevInAEL.OutIdx>=0&&ie.ClipperBase.SlopesEqual(e.PrevInAEL,e,this.m_UseFullRange)&&0!==e.WindDelta&&0!==e.PrevInAEL.WindDelta){var s=this.AddOutPt(e.PrevInAEL,e.Bot);this.AddJoin(i,s,e.Top)}if(e.NextInAEL!=n){if(n.OutIdx>=0&&n.PrevInAEL.OutIdx>=0&&ie.ClipperBase.SlopesEqual(n.PrevInAEL,n,this.m_UseFullRange)&&0!==n.WindDelta&&0!==n.PrevInAEL.WindDelta){var s=this.AddOutPt(n.PrevInAEL,n.Bot);this.AddJoin(i,s,n.Top)}var l=e.NextInAEL;if(null!==l)for(;l!=n;)this.IntersectEdges(n,l,e.Curr,!1),l=l.NextInAEL}}}},ie.Clipper.prototype.InsertEdgeIntoAEL=function(t,e){if(null===this.m_ActiveEdges)t.PrevInAEL=null,t.NextInAEL=null,this.m_ActiveEdges=t;else if(null===e&&this.E2InsertsBeforeE1(this.m_ActiveEdges,t))t.PrevInAEL=null,t.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges.PrevInAEL=t,this.m_ActiveEdges=t;else{for(null===e&&(e=this.m_ActiveEdges);null!==e.NextInAEL&&!this.E2InsertsBeforeE1(e.NextInAEL,t);)e=e.NextInAEL;t.NextInAEL=e.NextInAEL,null!==e.NextInAEL&&(e.NextInAEL.PrevInAEL=t),t.PrevInAEL=e,e.NextInAEL=t}},ie.Clipper.prototype.E2InsertsBeforeE1=function(t,e){return e.Curr.X==t.Curr.X?e.Top.Y>t.Top.Y?e.Top.X<ie.Clipper.TopX(t,e.Top.Y):t.Top.X>ie.Clipper.TopX(e,t.Top.Y):e.Curr.X<t.Curr.X},ie.Clipper.prototype.IsEvenOddFillType=function(t){return t.PolyTyp==ie.PolyType.ptSubject?this.m_SubjFillType==ie.PolyFillType.pftEvenOdd:this.m_ClipFillType==ie.PolyFillType.pftEvenOdd},ie.Clipper.prototype.IsEvenOddAltFillType=function(t){return t.PolyTyp==ie.PolyType.ptSubject?this.m_ClipFillType==ie.PolyFillType.pftEvenOdd:this.m_SubjFillType==ie.PolyFillType.pftEvenOdd},ie.Clipper.prototype.IsContributing=function(t){var e,n;switch(t.PolyTyp==ie.PolyType.ptSubject?(e=this.m_SubjFillType,n=this.m_ClipFillType):(e=this.m_ClipFillType,n=this.m_SubjFillType),e){case ie.PolyFillType.pftEvenOdd:if(0===t.WindDelta&&1!=t.WindCnt)return!1;break;case ie.PolyFillType.pftNonZero:if(1!=Math.abs(t.WindCnt))return!1;break;case ie.PolyFillType.pftPositive:if(1!=t.WindCnt)return!1;break;default:if(-1!=t.WindCnt)return!1}switch(this.m_ClipType){case ie.ClipType.ctIntersection:switch(n){case ie.PolyFillType.pftEvenOdd:case ie.PolyFillType.pftNonZero:return 0!==t.WindCnt2;case ie.PolyFillType.pftPositive:return t.WindCnt2>0;default:return t.WindCnt2<0}case ie.ClipType.ctUnion:switch(n){case ie.PolyFillType.pftEvenOdd:case ie.PolyFillType.pftNonZero:return 0===t.WindCnt2;case ie.PolyFillType.pftPositive:return t.WindCnt2<=0;default:return t.WindCnt2>=0}case ie.ClipType.ctDifference:if(t.PolyTyp==ie.PolyType.ptSubject)switch(n){case ie.PolyFillType.pftEvenOdd:case ie.PolyFillType.pftNonZero:return 0===t.WindCnt2;case ie.PolyFillType.pftPositive:return t.WindCnt2<=0;default:return t.WindCnt2>=0}else switch(n){case ie.PolyFillType.pftEvenOdd:case ie.PolyFillType.pftNonZero:return 0!==t.WindCnt2;case ie.PolyFillType.pftPositive:return t.WindCnt2>0;default:return t.WindCnt2<0}case ie.ClipType.ctXor:if(0!==t.WindDelta)return!0;switch(n){case ie.PolyFillType.pftEvenOdd:case ie.PolyFillType.pftNonZero:return 0===t.WindCnt2;case ie.PolyFillType.pftPositive:return t.WindCnt2<=0;default:return t.WindCnt2>=0}}return!0},ie.Clipper.prototype.SetWindingCount=function(t){for(var e=t.PrevInAEL;null!==e&&(e.PolyTyp!=t.PolyTyp||0===e.WindDelta);)e=e.PrevInAEL;if(null===e)t.WindCnt=0===t.WindDelta?1:t.WindDelta,t.WindCnt2=0,e=this.m_ActiveEdges;else if(0===t.WindDelta&&this.m_ClipType!=ie.ClipType.ctUnion)t.WindCnt=1,t.WindCnt2=e.WindCnt2,e=e.NextInAEL;else if(this.IsEvenOddFillType(t)){if(0===t.WindDelta){for(var n=!0,i=e.PrevInAEL;null!==i;)i.PolyTyp==e.PolyTyp&&0!==i.WindDelta&&(n=!n),i=i.PrevInAEL;t.WindCnt=n?0:1}else t.WindCnt=t.WindDelta;t.WindCnt2=e.WindCnt2,e=e.NextInAEL}else e.WindCnt*e.WindDelta<0?Math.abs(e.WindCnt)>1?e.WindDelta*t.WindDelta<0?t.WindCnt=e.WindCnt:t.WindCnt=e.WindCnt+t.WindDelta:t.WindCnt=0===t.WindDelta?1:t.WindDelta:0===t.WindDelta?t.WindCnt=e.WindCnt<0?e.WindCnt-1:e.WindCnt+1:e.WindDelta*t.WindDelta<0?t.WindCnt=e.WindCnt:t.WindCnt=e.WindCnt+t.WindDelta,t.WindCnt2=e.WindCnt2,e=e.NextInAEL;if(this.IsEvenOddAltFillType(t))for(;e!=t;)0!==e.WindDelta&&(t.WindCnt2=0===t.WindCnt2?1:0),e=e.NextInAEL;else for(;e!=t;)t.WindCnt2+=e.WindDelta,e=e.NextInAEL},ie.Clipper.prototype.AddEdgeToSEL=function(t){null===this.m_SortedEdges?(this.m_SortedEdges=t,t.PrevInSEL=null,t.NextInSEL=null):(t.NextInSEL=this.m_SortedEdges,t.PrevInSEL=null,this.m_SortedEdges.PrevInSEL=t,this.m_SortedEdges=t)},ie.Clipper.prototype.CopyAELToSEL=function(){var t=this.m_ActiveEdges;for(this.m_SortedEdges=t;null!==t;)t.PrevInSEL=t.PrevInAEL,t.NextInSEL=t.NextInAEL,t=t.NextInAEL},ie.Clipper.prototype.SwapPositionsInAEL=function(t,e){if(t.NextInAEL!=t.PrevInAEL&&e.NextInAEL!=e.PrevInAEL){if(t.NextInAEL==e){var n=e.NextInAEL;null!==n&&(n.PrevInAEL=t);var i=t.PrevInAEL;null!==i&&(i.NextInAEL=e),e.PrevInAEL=i,e.NextInAEL=t,t.PrevInAEL=e,t.NextInAEL=n}else if(e.NextInAEL==t){var n=t.NextInAEL;null!==n&&(n.PrevInAEL=e);var i=e.PrevInAEL;null!==i&&(i.NextInAEL=t),t.PrevInAEL=i,t.NextInAEL=e,e.PrevInAEL=t,e.NextInAEL=n}else{var n=t.NextInAEL,i=t.PrevInAEL;t.NextInAEL=e.NextInAEL,null!==t.NextInAEL&&(t.NextInAEL.PrevInAEL=t),t.PrevInAEL=e.PrevInAEL,null!==t.PrevInAEL&&(t.PrevInAEL.NextInAEL=t),e.NextInAEL=n,null!==e.NextInAEL&&(e.NextInAEL.PrevInAEL=e),e.PrevInAEL=i,null!==e.PrevInAEL&&(e.PrevInAEL.NextInAEL=e)}null===t.PrevInAEL?this.m_ActiveEdges=t:null===e.PrevInAEL&&(this.m_ActiveEdges=e)}},ie.Clipper.prototype.SwapPositionsInSEL=function(t,e){if(!(null===t.NextInSEL&&null===t.PrevInSEL||null===e.NextInSEL&&null===e.PrevInSEL)){if(t.NextInSEL==e){var n=e.NextInSEL;null!==n&&(n.PrevInSEL=t);var i=t.PrevInSEL;null!==i&&(i.NextInSEL=e),e.PrevInSEL=i,e.NextInSEL=t,t.PrevInSEL=e,t.NextInSEL=n}else if(e.NextInSEL==t){var n=t.NextInSEL;null!==n&&(n.PrevInSEL=e);var i=e.PrevInSEL;null!==i&&(i.NextInSEL=t),t.PrevInSEL=i,t.NextInSEL=e,e.PrevInSEL=t,e.NextInSEL=n}else{var n=t.NextInSEL,i=t.PrevInSEL;t.NextInSEL=e.NextInSEL,null!==t.NextInSEL&&(t.NextInSEL.PrevInSEL=t),t.PrevInSEL=e.PrevInSEL,null!==t.PrevInSEL&&(t.PrevInSEL.NextInSEL=t),e.NextInSEL=n,null!==e.NextInSEL&&(e.NextInSEL.PrevInSEL=e),e.PrevInSEL=i,null!==e.PrevInSEL&&(e.PrevInSEL.NextInSEL=e)}null===t.PrevInSEL?this.m_SortedEdges=t:null===e.PrevInSEL&&(this.m_SortedEdges=e)}},ie.Clipper.prototype.AddLocalMaxPoly=function(t,e,n){this.AddOutPt(t,n),0==e.WindDelta&&this.AddOutPt(e,n),t.OutIdx==e.OutIdx?(t.OutIdx=-1,e.OutIdx=-1):t.OutIdx<e.OutIdx?this.AppendPolygon(t,e):this.AppendPolygon(e,t)},ie.Clipper.prototype.AddLocalMinPoly=function(t,e,n){var i,r,o;if(ie.ClipperBase.IsHorizontal(e)||t.Dx>e.Dx?(i=this.AddOutPt(t,n),e.OutIdx=t.OutIdx,t.Side=ie.EdgeSide.esLeft,e.Side=ie.EdgeSide.esRight,r=t,o=r.PrevInAEL==e?e.PrevInAEL:r.PrevInAEL):(i=this.AddOutPt(e,n),t.OutIdx=e.OutIdx,t.Side=ie.EdgeSide.esRight,e.Side=ie.EdgeSide.esLeft,r=e,o=r.PrevInAEL==t?t.PrevInAEL:r.PrevInAEL),null!==o&&o.OutIdx>=0&&ie.Clipper.TopX(o,n.Y)==ie.Clipper.TopX(r,n.Y)&&ie.ClipperBase.SlopesEqual(r,o,this.m_UseFullRange)&&0!==r.WindDelta&&0!==o.WindDelta){var a=this.AddOutPt(o,n);this.AddJoin(i,a,r.Top)}return i},ie.Clipper.prototype.CreateOutRec=function(){var t=new ie.OutRec;return t.Idx=-1,t.IsHole=!1,t.IsOpen=!1,t.FirstLeft=null,t.Pts=null,t.BottomPt=null,t.PolyNode=null,this.m_PolyOuts.push(t),t.Idx=this.m_PolyOuts.length-1,t},ie.Clipper.prototype.AddOutPt=function(t,e){var n=t.Side==ie.EdgeSide.esLeft;if(t.OutIdx<0){var i=this.CreateOutRec();i.IsOpen=0===t.WindDelta;var r=new ie.OutPt;return i.Pts=r,r.Idx=i.Idx,r.Pt.X=e.X,r.Pt.Y=e.Y,r.Next=r,r.Prev=r,i.IsOpen||this.SetHoleState(t,i),t.OutIdx=i.Idx,r}var i=this.m_PolyOuts[t.OutIdx],o=i.Pts;if(n&&ie.IntPoint.op_Equality(e,o.Pt))return o;if(!n&&ie.IntPoint.op_Equality(e,o.Prev.Pt))return o.Prev;var r=new ie.OutPt;return r.Idx=i.Idx,r.Pt.X=e.X,r.Pt.Y=e.Y,r.Next=o,r.Prev=o.Prev,r.Prev.Next=r,o.Prev=r,n&&(i.Pts=r),r},ie.Clipper.prototype.SwapPoints=function(t,e){var n=new ie.IntPoint(t.Value);t.Value.X=e.Value.X,t.Value.Y=e.Value.Y,e.Value.X=n.X,e.Value.Y=n.Y},ie.Clipper.prototype.HorzSegmentsOverlap=function(t,e,n,i){var r;return t>e&&(r=t,t=e,e=r),n>i&&(r=n,n=i,i=r),t<i&&n<e},ie.Clipper.prototype.SetHoleState=function(t,e){for(var n=!1,i=t.PrevInAEL;null!==i;)i.OutIdx>=0&&0!=i.WindDelta&&(n=!n,null===e.FirstLeft&&(e.FirstLeft=this.m_PolyOuts[i.OutIdx])),i=i.PrevInAEL;n&&(e.IsHole=!0)},ie.Clipper.prototype.GetDx=function(t,e){return t.Y==e.Y?ie.ClipperBase.horizontal:(e.X-t.X)/(e.Y-t.Y)},ie.Clipper.prototype.FirstIsBottomPt=function(t,e){for(var n=t.Prev;ie.IntPoint.op_Equality(n.Pt,t.Pt)&&n!=t;)n=n.Prev;var i=Math.abs(this.GetDx(t.Pt,n.Pt));for(n=t.Next;ie.IntPoint.op_Equality(n.Pt,t.Pt)&&n!=t;)n=n.Next;var r=Math.abs(this.GetDx(t.Pt,n.Pt));for(n=e.Prev;ie.IntPoint.op_Equality(n.Pt,e.Pt)&&n!=e;)n=n.Prev;var o=Math.abs(this.GetDx(e.Pt,n.Pt));for(n=e.Next;ie.IntPoint.op_Equality(n.Pt,e.Pt)&&n!=e;)n=n.Next;var a=Math.abs(this.GetDx(e.Pt,n.Pt));return i>=o&&i>=a||r>=o&&r>=a},ie.Clipper.prototype.GetBottomPt=function(t){for(var e=null,n=t.Next;n!=t;)n.Pt.Y>t.Pt.Y?(t=n,e=null):n.Pt.Y==t.Pt.Y&&n.Pt.X<=t.Pt.X&&(n.Pt.X<t.Pt.X?(e=null,t=n):n.Next!=t&&n.Prev!=t&&(e=n)),n=n.Next;if(null!==e)for(;e!=n;)for(this.FirstIsBottomPt(n,e)||(t=e),e=e.Next;ie.IntPoint.op_Inequality(e.Pt,t.Pt);)e=e.Next;return t},ie.Clipper.prototype.GetLowermostRec=function(t,e){null===t.BottomPt&&(t.BottomPt=this.GetBottomPt(t.Pts)),null===e.BottomPt&&(e.BottomPt=this.GetBottomPt(e.Pts));var n=t.BottomPt,i=e.BottomPt;return n.Pt.Y>i.Pt.Y?t:n.Pt.Y<i.Pt.Y?e:n.Pt.X<i.Pt.X?t:n.Pt.X>i.Pt.X?e:n.Next==n?e:i.Next==i?t:this.FirstIsBottomPt(n,i)?t:e},ie.Clipper.prototype.Param1RightOfParam2=function(t,e){do{if((t=t.FirstLeft)==e)return!0}while(null!==t);return!1},ie.Clipper.prototype.GetOutRec=function(t){for(var e=this.m_PolyOuts[t];e!=this.m_PolyOuts[e.Idx];)e=this.m_PolyOuts[e.Idx];return e},ie.Clipper.prototype.AppendPolygon=function(t,e){var n,i=this.m_PolyOuts[t.OutIdx],r=this.m_PolyOuts[e.OutIdx];n=this.Param1RightOfParam2(i,r)?r:this.Param1RightOfParam2(r,i)?i:this.GetLowermostRec(i,r);var o,a=i.Pts,s=a.Prev,l=r.Pts,u=l.Prev;t.Side==ie.EdgeSide.esLeft?(e.Side==ie.EdgeSide.esLeft?(this.ReversePolyPtLinks(l),l.Next=a,a.Prev=l,s.Next=u,u.Prev=s,i.Pts=u):(u.Next=a,a.Prev=u,l.Prev=s,s.Next=l,i.Pts=l),o=ie.EdgeSide.esLeft):(e.Side==ie.EdgeSide.esRight?(this.ReversePolyPtLinks(l),s.Next=u,u.Prev=s,l.Next=a,a.Prev=l):(s.Next=l,l.Prev=s,a.Prev=u,u.Next=a),o=ie.EdgeSide.esRight),i.BottomPt=null,n==r&&(r.FirstLeft!=i&&(i.FirstLeft=r.FirstLeft),i.IsHole=r.IsHole),r.Pts=null,r.BottomPt=null,r.FirstLeft=i;var h=t.OutIdx,c=e.OutIdx;t.OutIdx=-1,e.OutIdx=-1;for(var d=this.m_ActiveEdges;null!==d;){if(d.OutIdx==c){d.OutIdx=h,d.Side=o;break}d=d.NextInAEL}r.Idx=i.Idx},ie.Clipper.prototype.ReversePolyPtLinks=function(t){if(null!==t){var e,n;e=t;do{n=e.Next,e.Next=e.Prev,e.Prev=n,e=n}while(e!=t)}},ie.Clipper.SwapSides=function(t,e){var n=t.Side;t.Side=e.Side,e.Side=n},ie.Clipper.SwapPolyIndexes=function(t,e){var n=t.OutIdx;t.OutIdx=e.OutIdx,e.OutIdx=n},ie.Clipper.prototype.IntersectEdges=function(t,e,n){var i=t.OutIdx>=0,r=e.OutIdx>=0;if(0===t.WindDelta||0===e.WindDelta){if(0==t.WindDelta&&0==e.WindDelta)return;return void(t.PolyTyp==e.PolyTyp&&t.WindDelta!=e.WindDelta&&this.m_ClipType==ie.ClipType.ctUnion?0===t.WindDelta?r&&(this.AddOutPt(t,n),i&&(t.OutIdx=-1)):i&&(this.AddOutPt(e,n),r&&(e.OutIdx=-1)):t.PolyTyp!=e.PolyTyp&&(0!==t.WindDelta||1!=Math.abs(e.WindCnt)||this.m_ClipType==ie.ClipType.ctUnion&&0!==e.WindCnt2?0!==e.WindDelta||1!=Math.abs(t.WindCnt)||this.m_ClipType==ie.ClipType.ctUnion&&0!==t.WindCnt2||(this.AddOutPt(e,n),r&&(e.OutIdx=-1)):(this.AddOutPt(t,n),i&&(t.OutIdx=-1))))}if(t.PolyTyp==e.PolyTyp)if(this.IsEvenOddFillType(t)){var o=t.WindCnt;t.WindCnt=e.WindCnt,e.WindCnt=o}else t.WindCnt+e.WindDelta===0?t.WindCnt=-t.WindCnt:t.WindCnt+=e.WindDelta,e.WindCnt-t.WindDelta==0?e.WindCnt=-e.WindCnt:e.WindCnt-=t.WindDelta;else this.IsEvenOddFillType(e)?t.WindCnt2=0===t.WindCnt2?1:0:t.WindCnt2+=e.WindDelta,this.IsEvenOddFillType(t)?e.WindCnt2=0===e.WindCnt2?1:0:e.WindCnt2-=t.WindDelta;var a,s,l,u;t.PolyTyp==ie.PolyType.ptSubject?(a=this.m_SubjFillType,l=this.m_ClipFillType):(a=this.m_ClipFillType,l=this.m_SubjFillType),e.PolyTyp==ie.PolyType.ptSubject?(s=this.m_SubjFillType,u=this.m_ClipFillType):(s=this.m_ClipFillType,u=this.m_SubjFillType);var h,c;switch(a){case ie.PolyFillType.pftPositive:h=t.WindCnt;break;case ie.PolyFillType.pftNegative:h=-t.WindCnt;break;default:h=Math.abs(t.WindCnt)}switch(s){case ie.PolyFillType.pftPositive:c=e.WindCnt;break;case ie.PolyFillType.pftNegative:c=-e.WindCnt;break;default:c=Math.abs(e.WindCnt)}if(i&&r)0!=h&&1!=h||0!=c&&1!=c||t.PolyTyp!=e.PolyTyp&&this.m_ClipType!=ie.ClipType.ctXor?this.AddLocalMaxPoly(t,e,n):(this.AddOutPt(t,n),this.AddOutPt(e,n),ie.Clipper.SwapSides(t,e),ie.Clipper.SwapPolyIndexes(t,e));else if(i)0!==c&&1!=c||(this.AddOutPt(t,n),ie.Clipper.SwapSides(t,e),ie.Clipper.SwapPolyIndexes(t,e));else if(r)0!==h&&1!=h||(this.AddOutPt(e,n),ie.Clipper.SwapSides(t,e),ie.Clipper.SwapPolyIndexes(t,e));else if(!(0!=h&&1!=h||0!=c&&1!=c)){var d,f;switch(l){case ie.PolyFillType.pftPositive:d=t.WindCnt2;break;case ie.PolyFillType.pftNegative:d=-t.WindCnt2;break;default:d=Math.abs(t.WindCnt2)}switch(u){case ie.PolyFillType.pftPositive:f=e.WindCnt2;break;case ie.PolyFillType.pftNegative:f=-e.WindCnt2;break;default:f=Math.abs(e.WindCnt2)}if(t.PolyTyp!=e.PolyTyp)this.AddLocalMinPoly(t,e,n);else if(1==h&&1==c)switch(this.m_ClipType){case ie.ClipType.ctIntersection:d>0&&f>0&&this.AddLocalMinPoly(t,e,n);break;case ie.ClipType.ctUnion:d<=0&&f<=0&&this.AddLocalMinPoly(t,e,n);break;case ie.ClipType.ctDifference:(t.PolyTyp==ie.PolyType.ptClip&&d>0&&f>0||t.PolyTyp==ie.PolyType.ptSubject&&d<=0&&f<=0)&&this.AddLocalMinPoly(t,e,n);break;case ie.ClipType.ctXor:this.AddLocalMinPoly(t,e,n)}else ie.Clipper.SwapSides(t,e)}},ie.Clipper.prototype.DeleteFromAEL=function(t){var e=t.PrevInAEL,n=t.NextInAEL;null===e&&null===n&&t!=this.m_ActiveEdges||(null!==e?e.NextInAEL=n:this.m_ActiveEdges=n,null!==n&&(n.PrevInAEL=e),t.NextInAEL=null,t.PrevInAEL=null)},ie.Clipper.prototype.DeleteFromSEL=function(t){var e=t.PrevInSEL,n=t.NextInSEL;null===e&&null===n&&t!=this.m_SortedEdges||(null!==e?e.NextInSEL=n:this.m_SortedEdges=n,null!==n&&(n.PrevInSEL=e),t.NextInSEL=null,t.PrevInSEL=null)},ie.Clipper.prototype.UpdateEdgeIntoAEL=function(t){null===t.NextInLML&&ie.Error("UpdateEdgeIntoAEL: invalid call");var e=t.PrevInAEL,n=t.NextInAEL;return t.NextInLML.OutIdx=t.OutIdx,null!==e?e.NextInAEL=t.NextInLML:this.m_ActiveEdges=t.NextInLML,null!==n&&(n.PrevInAEL=t.NextInLML),t.NextInLML.Side=t.Side,t.NextInLML.WindDelta=t.WindDelta,t.NextInLML.WindCnt=t.WindCnt,t.NextInLML.WindCnt2=t.WindCnt2,t=t.NextInLML,t.Curr.X=t.Bot.X,t.Curr.Y=t.Bot.Y,t.PrevInAEL=e,t.NextInAEL=n,ie.ClipperBase.IsHorizontal(t)||this.InsertScanbeam(t.Top.Y),t},ie.Clipper.prototype.ProcessHorizontals=function(t){for(var e=this.m_SortedEdges;null!==e;)this.DeleteFromSEL(e),this.ProcessHorizontal(e,t),e=this.m_SortedEdges},ie.Clipper.prototype.GetHorzDirection=function(t,e){t.Bot.X<t.Top.X?(e.Left=t.Bot.X,e.Right=t.Top.X,e.Dir=ie.Direction.dLeftToRight):(e.Left=t.Top.X,e.Right=t.Bot.X,e.Dir=ie.Direction.dRightToLeft)},ie.Clipper.prototype.ProcessHorizontal=function(t,e){var n={Dir:null,Left:null,Right:null};this.GetHorzDirection(t,n);for(var i=n.Dir,r=n.Left,o=n.Right,a=t,s=null;null!==a.NextInLML&&ie.ClipperBase.IsHorizontal(a.NextInLML);)a=a.NextInLML;for(null===a.NextInLML&&(s=this.GetMaximaPair(a));;){for(var l=t==a,u=this.GetNextInAEL(t,i);null!==u&&!(u.Curr.X==t.Top.X&&null!==t.NextInLML&&u.Dx<t.NextInLML.Dx);){var h=this.GetNextInAEL(u,i);if(i==ie.Direction.dLeftToRight&&u.Curr.X<=o||i==ie.Direction.dRightToLeft&&u.Curr.X>=r){if(u==s&&l){if(t.OutIdx>=0){for(var c=this.AddOutPt(t,t.Top),d=this.m_SortedEdges;null!==d;){if(d.OutIdx>=0&&this.HorzSegmentsOverlap(t.Bot.X,t.Top.X,d.Bot.X,d.Top.X)){var f=this.AddOutPt(d,d.Bot);this.AddJoin(f,c,d.Top)}d=d.NextInSEL}this.AddGhostJoin(c,t.Bot),this.AddLocalMaxPoly(t,s,t.Top)}return this.DeleteFromAEL(t),void this.DeleteFromAEL(s)}if(i==ie.Direction.dLeftToRight){var p=new ie.IntPoint(u.Curr.X,t.Curr.Y);this.IntersectEdges(t,u,p)}else{var p=new ie.IntPoint(u.Curr.X,t.Curr.Y);this.IntersectEdges(u,t,p)}this.SwapPositionsInAEL(t,u)}else if(i==ie.Direction.dLeftToRight&&u.Curr.X>=o||i==ie.Direction.dRightToLeft&&u.Curr.X<=r)break;u=h}if(null===t.NextInLML||!ie.ClipperBase.IsHorizontal(t.NextInLML))break;t=this.UpdateEdgeIntoAEL(t),t.OutIdx>=0&&this.AddOutPt(t,t.Bot);var n={Dir:i,Left:r,Right:o};this.GetHorzDirection(t,n),i=n.Dir,r=n.Left,o=n.Right}if(null!==t.NextInLML)if(t.OutIdx>=0){var c=this.AddOutPt(t,t.Top);if(e&&this.AddGhostJoin(c,t.Bot),t=this.UpdateEdgeIntoAEL(t),0===t.WindDelta)return;var m=t.PrevInAEL,h=t.NextInAEL;if(null!==m&&m.Curr.X==t.Bot.X&&m.Curr.Y==t.Bot.Y&&0!==m.WindDelta&&m.OutIdx>=0&&m.Curr.Y>m.Top.Y&&ie.ClipperBase.SlopesEqual(t,m,this.m_UseFullRange)){var f=this.AddOutPt(m,t.Bot);this.AddJoin(c,f,t.Top)}else if(null!==h&&h.Curr.X==t.Bot.X&&h.Curr.Y==t.Bot.Y&&0!==h.WindDelta&&h.OutIdx>=0&&h.Curr.Y>h.Top.Y&&ie.ClipperBase.SlopesEqual(t,h,this.m_UseFullRange)){var f=this.AddOutPt(h,t.Bot);this.AddJoin(c,f,t.Top)}}else t=this.UpdateEdgeIntoAEL(t);else t.OutIdx>=0&&this.AddOutPt(t,t.Top),this.DeleteFromAEL(t)},ie.Clipper.prototype.GetNextInAEL=function(t,e){return e==ie.Direction.dLeftToRight?t.NextInAEL:t.PrevInAEL},ie.Clipper.prototype.IsMinima=function(t){return null!==t&&t.Prev.NextInLML!=t&&t.Next.NextInLML!=t},ie.Clipper.prototype.IsMaxima=function(t,e){return null!==t&&t.Top.Y==e&&null===t.NextInLML},ie.Clipper.prototype.IsIntermediate=function(t,e){return t.Top.Y==e&&null!==t.NextInLML},ie.Clipper.prototype.GetMaximaPair=function(t){var e=null;return ie.IntPoint.op_Equality(t.Next.Top,t.Top)&&null===t.Next.NextInLML?e=t.Next:ie.IntPoint.op_Equality(t.Prev.Top,t.Top)&&null===t.Prev.NextInLML&&(e=t.Prev),null===e||-2!=e.OutIdx&&(e.NextInAEL!=e.PrevInAEL||ie.ClipperBase.IsHorizontal(e))?e:null},ie.Clipper.prototype.ProcessIntersections=function(t){if(null==this.m_ActiveEdges)return!0;try{if(this.BuildIntersectList(t),0==this.m_IntersectList.length)return!0;if(1!=this.m_IntersectList.length&&!this.FixupIntersectionOrder())return!1;this.ProcessIntersectList()}catch(t){this.m_SortedEdges=null,this.m_IntersectList.length=0,ie.Error("ProcessIntersections error")}return this.m_SortedEdges=null,!0},ie.Clipper.prototype.BuildIntersectList=function(t){if(null!==this.m_ActiveEdges){var e=this.m_ActiveEdges;for(this.m_SortedEdges=e;null!==e;)e.PrevInSEL=e.PrevInAEL,e.NextInSEL=e.NextInAEL,e.Curr.X=ie.Clipper.TopX(e,t),e=e.NextInAEL;for(var n=!0;n&&null!==this.m_SortedEdges;){for(n=!1,e=this.m_SortedEdges;null!==e.NextInSEL;){var i=e.NextInSEL,r=new ie.IntPoint;if(e.Curr.X>i.Curr.X){this.IntersectPoint(e,i,r);var o=new ie.IntersectNode;o.Edge1=e,o.Edge2=i,o.Pt.X=r.X,o.Pt.Y=r.Y,this.m_IntersectList.push(o),this.SwapPositionsInSEL(e,i),n=!0}else e=i}if(null===e.PrevInSEL)break;e.PrevInSEL.NextInSEL=null}this.m_SortedEdges=null}},ie.Clipper.prototype.EdgesAdjacent=function(t){return t.Edge1.NextInSEL==t.Edge2||t.Edge1.PrevInSEL==t.Edge2},ie.Clipper.IntersectNodeSort=function(t,e){return e.Pt.Y-t.Pt.Y},ie.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer),this.CopyAELToSEL();for(var t=this.m_IntersectList.length,e=0;e<t;e++){if(!this.EdgesAdjacent(this.m_IntersectList[e])){for(var n=e+1;n<t&&!this.EdgesAdjacent(this.m_IntersectList[n]);)n++;if(n==t)return!1;var i=this.m_IntersectList[e];this.m_IntersectList[e]=this.m_IntersectList[n],this.m_IntersectList[n]=i}this.SwapPositionsInSEL(this.m_IntersectList[e].Edge1,this.m_IntersectList[e].Edge2)}return!0},ie.Clipper.prototype.ProcessIntersectList=function(){for(var t=0,e=this.m_IntersectList.length;t<e;t++){var n=this.m_IntersectList[t];this.IntersectEdges(n.Edge1,n.Edge2,n.Pt),this.SwapPositionsInAEL(n.Edge1,n.Edge2)}this.m_IntersectList.length=0};var ge=function(t){return t<0?Math.ceil(t-.5):Math.round(t)},ye=function(t){return t<0?Math.ceil(t-.5):Math.floor(t+.5)},_e=function(t){return t<0?-Math.round(Math.abs(t)):Math.round(t)},xe=function(t){return t<0?(t-=.5,t<-2147483648?Math.ceil(t):0|t):(t+=.5,t>2147483647?Math.floor(t):0|t)};se.msie?ie.Clipper.Round=ge:se.chromium?ie.Clipper.Round=_e:se.safari?ie.Clipper.Round=xe:ie.Clipper.Round=ye,ie.Clipper.TopX=function(t,e){return e==t.Top.Y?t.Top.X:t.Bot.X+ie.Clipper.Round(t.Dx*(e-t.Bot.Y))},ie.Clipper.prototype.IntersectPoint=function(t,e,n){n.X=0,n.Y=0;var i,r;if(t.Dx==e.Dx)return n.Y=t.Curr.Y,void(n.X=ie.Clipper.TopX(t,n.Y));if(0===t.Delta.X)n.X=t.Bot.X,ie.ClipperBase.IsHorizontal(e)?n.Y=e.Bot.Y:(r=e.Bot.Y-e.Bot.X/e.Dx,n.Y=ie.Clipper.Round(n.X/e.Dx+r));else if(0===e.Delta.X)n.X=e.Bot.X,ie.ClipperBase.IsHorizontal(t)?n.Y=t.Bot.Y:(i=t.Bot.Y-t.Bot.X/t.Dx,n.Y=ie.Clipper.Round(n.X/t.Dx+i));else{i=t.Bot.X-t.Bot.Y*t.Dx,r=e.Bot.X-e.Bot.Y*e.Dx;var o=(r-i)/(t.Dx-e.Dx);n.Y=ie.Clipper.Round(o),Math.abs(t.Dx)<Math.abs(e.Dx)?n.X=ie.Clipper.Round(t.Dx*o+i):n.X=ie.Clipper.Round(e.Dx*o+r)}if(n.Y<t.Top.Y||n.Y<e.Top.Y){if(t.Top.Y>e.Top.Y)return n.Y=t.Top.Y,n.X=ie.Clipper.TopX(e,t.Top.Y),n.X<t.Top.X;n.Y=e.Top.Y,Math.abs(t.Dx)<Math.abs(e.Dx)?n.X=ie.Clipper.TopX(t,n.Y):n.X=ie.Clipper.TopX(e,n.Y)}n.Y>t.Curr.Y&&(n.Y=t.Curr.Y,Math.abs(t.Dx)>Math.abs(e.Dx)?n.X=ie.Clipper.TopX(e,n.Y):n.X=ie.Clipper.TopX(t,n.Y))},ie.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(t){for(var e=this.m_ActiveEdges;null!==e;){var n=this.IsMaxima(e,t);if(n){var i=this.GetMaximaPair(e);n=null===i||!ie.ClipperBase.IsHorizontal(i)}if(n){var r=e.PrevInAEL;this.DoMaxima(e),e=null===r?this.m_ActiveEdges:r.NextInAEL}else{if(this.IsIntermediate(e,t)&&ie.ClipperBase.IsHorizontal(e.NextInLML)?(e=this.UpdateEdgeIntoAEL(e),e.OutIdx>=0&&this.AddOutPt(e,e.Bot),this.AddEdgeToSEL(e)):(e.Curr.X=ie.Clipper.TopX(e,t),e.Curr.Y=t),this.StrictlySimple){var r=e.PrevInAEL;if(e.OutIdx>=0&&0!==e.WindDelta&&null!==r&&r.OutIdx>=0&&r.Curr.X==e.Curr.X&&0!==r.WindDelta){var o=new ie.IntPoint(e.Curr),a=this.AddOutPt(r,o),s=this.AddOutPt(e,o);this.AddJoin(a,s,o)}}e=e.NextInAEL}}for(this.ProcessHorizontals(!0),e=this.m_ActiveEdges;null!==e;){if(this.IsIntermediate(e,t)){var a=null;e.OutIdx>=0&&(a=this.AddOutPt(e,e.Top)),e=this.UpdateEdgeIntoAEL(e);var r=e.PrevInAEL,l=e.NextInAEL;if(null!==r&&r.Curr.X==e.Bot.X&&r.Curr.Y==e.Bot.Y&&null!==a&&r.OutIdx>=0&&r.Curr.Y>r.Top.Y&&ie.ClipperBase.SlopesEqual(e,r,this.m_UseFullRange)&&0!==e.WindDelta&&0!==r.WindDelta){var s=this.AddOutPt(r,e.Bot);this.AddJoin(a,s,e.Top)}else if(null!==l&&l.Curr.X==e.Bot.X&&l.Curr.Y==e.Bot.Y&&null!==a&&l.OutIdx>=0&&l.Curr.Y>l.Top.Y&&ie.ClipperBase.SlopesEqual(e,l,this.m_UseFullRange)&&0!==e.WindDelta&&0!==l.WindDelta){var s=this.AddOutPt(l,e.Bot);this.AddJoin(a,s,e.Top)}}e=e.NextInAEL}},ie.Clipper.prototype.DoMaxima=function(t){var e=this.GetMaximaPair(t);if(null===e)return t.OutIdx>=0&&this.AddOutPt(t,t.Top),void this.DeleteFromAEL(t);for(var n=t.NextInAEL;null!==n&&n!=e;)this.IntersectEdges(t,n,t.Top),this.SwapPositionsInAEL(t,n),n=t.NextInAEL;-1==t.OutIdx&&-1==e.OutIdx?(this.DeleteFromAEL(t),this.DeleteFromAEL(e)):t.OutIdx>=0&&e.OutIdx>=0?(t.OutIdx>=0&&this.AddLocalMaxPoly(t,e,t.Top),this.DeleteFromAEL(t),this.DeleteFromAEL(e)):0===t.WindDelta?(t.OutIdx>=0&&(this.AddOutPt(t,t.Top),t.OutIdx=-1),this.DeleteFromAEL(t),e.OutIdx>=0&&(this.AddOutPt(e,t.Top),e.OutIdx=-1),this.DeleteFromAEL(e)):ie.Error("DoMaxima error")},ie.Clipper.ReversePaths=function(t){for(var e=0,n=t.length;e<n;e++)t[e].reverse()},ie.Clipper.Orientation=function(t){return ie.Clipper.Area(t)>=0},ie.Clipper.prototype.PointCount=function(t){if(null===t)return 0;var e=0,n=t;do{e++,n=n.Next}while(n!=t);return e},ie.Clipper.prototype.BuildResult=function(t){ie.Clear(t);for(var e=0,n=this.m_PolyOuts.length;e<n;e++){var i=this.m_PolyOuts[e];if(null!==i.Pts){var r=i.Pts.Prev,o=this.PointCount(r);if(!(o<2)){for(var a=new Array(o),s=0;s<o;s++)a[s]=r.Pt,r=r.Prev;t.push(a)}}}},ie.Clipper.prototype.BuildResult2=function(t){t.Clear();for(var e=0,n=this.m_PolyOuts.length;e<n;e++){var i=this.m_PolyOuts[e],r=this.PointCount(i.Pts);if(!(i.IsOpen&&r<2||!i.IsOpen&&r<3)){this.FixHoleLinkage(i);var o=new ie.PolyNode;t.m_AllPolys.push(o),i.PolyNode=o,o.m_polygon.length=r;for(var a=i.Pts.Prev,s=0;s<r;s++)o.m_polygon[s]=a.Pt,a=a.Prev}}for(var e=0,n=this.m_PolyOuts.length;e<n;e++){var i=this.m_PolyOuts[e];null!==i.PolyNode&&(i.IsOpen?(i.PolyNode.IsOpen=!0,t.AddChild(i.PolyNode)):null!==i.FirstLeft&&null!=i.FirstLeft.PolyNode?i.FirstLeft.PolyNode.AddChild(i.PolyNode):t.AddChild(i.PolyNode))}},ie.Clipper.prototype.FixupOutPolygon=function(t){var e=null;t.BottomPt=null;for(var n=t.Pts;;){if(n.Prev==n||n.Prev==n.Next)return void(t.Pts=null);if(ie.IntPoint.op_Equality(n.Pt,n.Next.Pt)||ie.IntPoint.op_Equality(n.Pt,n.Prev.Pt)||ie.ClipperBase.SlopesEqual(n.Prev.Pt,n.Pt,n.Next.Pt,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(n.Prev.Pt,n.Pt,n.Next.Pt)))e=null,n.Prev.Next=n.Next,n.Next.Prev=n.Prev,n=n.Prev;else{if(n==e)break;null===e&&(e=n),n=n.Next}}t.Pts=n},ie.Clipper.prototype.DupOutPt=function(t,e){var n=new ie.OutPt;return n.Pt.X=t.Pt.X,n.Pt.Y=t.Pt.Y,n.Idx=t.Idx,e?(n.Next=t.Next,n.Prev=t,t.Next.Prev=n,t.Next=n):(n.Prev=t.Prev,n.Next=t,t.Prev.Next=n,t.Prev=n),n},ie.Clipper.prototype.GetOverlap=function(t,e,n,i,r){return t<e?n<i?(r.Left=Math.max(t,n),r.Right=Math.min(e,i)):(r.Left=Math.max(t,i),r.Right=Math.min(e,n)):n<i?(r.Left=Math.max(e,n),r.Right=Math.min(t,i)):(r.Left=Math.max(e,i),r.Right=Math.min(t,n)),r.Left<r.Right},ie.Clipper.prototype.JoinHorz=function(t,e,n,i,r,o){var a=t.Pt.X>e.Pt.X?ie.Direction.dRightToLeft:ie.Direction.dLeftToRight,s=n.Pt.X>i.Pt.X?ie.Direction.dRightToLeft:ie.Direction.dLeftToRight;if(a==s)return!1;if(a==ie.Direction.dLeftToRight){for(;t.Next.Pt.X<=r.X&&t.Next.Pt.X>=t.Pt.X&&t.Next.Pt.Y==r.Y;)t=t.Next;o&&t.Pt.X!=r.X&&(t=t.Next),e=this.DupOutPt(t,!o),ie.IntPoint.op_Inequality(e.Pt,r)&&(t=e,t.Pt.X=r.X,t.Pt.Y=r.Y,e=this.DupOutPt(t,!o))}else{for(;t.Next.Pt.X>=r.X&&t.Next.Pt.X<=t.Pt.X&&t.Next.Pt.Y==r.Y;)t=t.Next;o||t.Pt.X==r.X||(t=t.Next),e=this.DupOutPt(t,o),ie.IntPoint.op_Inequality(e.Pt,r)&&(t=e,t.Pt.X=r.X,t.Pt.Y=r.Y,e=this.DupOutPt(t,o))}if(s==ie.Direction.dLeftToRight){for(;n.Next.Pt.X<=r.X&&n.Next.Pt.X>=n.Pt.X&&n.Next.Pt.Y==r.Y;)n=n.Next;o&&n.Pt.X!=r.X&&(n=n.Next),i=this.DupOutPt(n,!o),ie.IntPoint.op_Inequality(i.Pt,r)&&(n=i,n.Pt.X=r.X,n.Pt.Y=r.Y,i=this.DupOutPt(n,!o))}else{for(;n.Next.Pt.X>=r.X&&n.Next.Pt.X<=n.Pt.X&&n.Next.Pt.Y==r.Y;)n=n.Next;o||n.Pt.X==r.X||(n=n.Next),i=this.DupOutPt(n,o),ie.IntPoint.op_Inequality(i.Pt,r)&&(n=i,n.Pt.X=r.X,n.Pt.Y=r.Y,i=this.DupOutPt(n,o))}return a==ie.Direction.dLeftToRight==o?(t.Prev=n,n.Next=t,e.Next=i,i.Prev=e):(t.Next=n,n.Prev=t,e.Prev=i,i.Next=e),!0},ie.Clipper.prototype.JoinPoints=function(t,e,n){var i=t.OutPt1,r=new ie.OutPt,o=t.OutPt2,a=new ie.OutPt,s=t.OutPt1.Pt.Y==t.OffPt.Y;if(s&&ie.IntPoint.op_Equality(t.OffPt,t.OutPt1.Pt)&&ie.IntPoint.op_Equality(t.OffPt,t.OutPt2.Pt)){if(e!=n)return!1;for(r=t.OutPt1.Next;r!=i&&ie.IntPoint.op_Equality(r.Pt,t.OffPt);)r=r.Next;var l=r.Pt.Y>t.OffPt.Y;for(a=t.OutPt2.Next;a!=o&&ie.IntPoint.op_Equality(a.Pt,t.OffPt);)a=a.Next;return l!=a.Pt.Y>t.OffPt.Y&&(l?(r=this.DupOutPt(i,!1),a=this.DupOutPt(o,!0),i.Prev=o,o.Next=i,r.Next=a,a.Prev=r,t.OutPt1=i,t.OutPt2=r,!0):(r=this.DupOutPt(i,!0),a=this.DupOutPt(o,!1),i.Next=o,o.Prev=i,r.Prev=a,a.Next=r,t.OutPt1=i,t.OutPt2=r,!0))}if(s){for(r=i;i.Prev.Pt.Y==i.Pt.Y&&i.Prev!=r&&i.Prev!=o;)i=i.Prev;for(;r.Next.Pt.Y==r.Pt.Y&&r.Next!=i&&r.Next!=o;)r=r.Next;if(r.Next==i||r.Next==o)return!1;for(a=o;o.Prev.Pt.Y==o.Pt.Y&&o.Prev!=a&&o.Prev!=r;)o=o.Prev;for(;a.Next.Pt.Y==a.Pt.Y&&a.Next!=o&&a.Next!=i;)a=a.Next;if(a.Next==o||a.Next==i)return!1;var u={Left:null,Right:null};if(!this.GetOverlap(i.Pt.X,r.Pt.X,o.Pt.X,a.Pt.X,u))return!1;var h,c=u.Left,d=u.Right,f=new ie.IntPoint;return i.Pt.X>=c&&i.Pt.X<=d?(f.X=i.Pt.X,f.Y=i.Pt.Y,h=i.Pt.X>r.Pt.X):o.Pt.X>=c&&o.Pt.X<=d?(f.X=o.Pt.X,f.Y=o.Pt.Y,h=o.Pt.X>a.Pt.X):r.Pt.X>=c&&r.Pt.X<=d?(f.X=r.Pt.X,f.Y=r.Pt.Y,h=r.Pt.X>i.Pt.X):(f.X=a.Pt.X,f.Y=a.Pt.Y,h=a.Pt.X>o.Pt.X),t.OutPt1=i,t.OutPt2=o,this.JoinHorz(i,r,o,a,f,h)}for(r=i.Next;ie.IntPoint.op_Equality(r.Pt,i.Pt)&&r!=i;)r=r.Next;var p=r.Pt.Y>i.Pt.Y||!ie.ClipperBase.SlopesEqual(i.Pt,r.Pt,t.OffPt,this.m_UseFullRange);if(p){for(r=i.Prev;ie.IntPoint.op_Equality(r.Pt,i.Pt)&&r!=i;)r=r.Prev;if(r.Pt.Y>i.Pt.Y||!ie.ClipperBase.SlopesEqual(i.Pt,r.Pt,t.OffPt,this.m_UseFullRange))return!1}for(a=o.Next;ie.IntPoint.op_Equality(a.Pt,o.Pt)&&a!=o;)a=a.Next;var m=a.Pt.Y>o.Pt.Y||!ie.ClipperBase.SlopesEqual(o.Pt,a.Pt,t.OffPt,this.m_UseFullRange);if(m){for(a=o.Prev;ie.IntPoint.op_Equality(a.Pt,o.Pt)&&a!=o;)a=a.Prev;if(a.Pt.Y>o.Pt.Y||!ie.ClipperBase.SlopesEqual(o.Pt,a.Pt,t.OffPt,this.m_UseFullRange))return!1}return r!=i&&a!=o&&r!=a&&(e!=n||p!=m)&&(p?(r=this.DupOutPt(i,!1),a=this.DupOutPt(o,!0),i.Prev=o,o.Next=i,r.Next=a,a.Prev=r,t.OutPt1=i,t.OutPt2=r,!0):(r=this.DupOutPt(i,!0),a=this.DupOutPt(o,!1),i.Next=o,o.Prev=i,r.Prev=a,a.Next=r,t.OutPt1=i,t.OutPt2=r,!0))},ie.Clipper.GetBounds=function(t){for(var e=0,n=t.length;e<n&&0==t[e].length;)e++;if(e==n)return new ie.IntRect(0,0,0,0);var i=new ie.IntRect;for(i.left=t[e][0].X,i.right=i.left,i.top=t[e][0].Y,i.bottom=i.top;e<n;e++)for(var r=0,o=t[e].length;r<o;r++)t[e][r].X<i.left?i.left=t[e][r].X:t[e][r].X>i.right&&(i.right=t[e][r].X),t[e][r].Y<i.top?i.top=t[e][r].Y:t[e][r].Y>i.bottom&&(i.bottom=t[e][r].Y);return i},ie.Clipper.prototype.GetBounds2=function(t){var e=t,n=new ie.IntRect;for(n.left=t.Pt.X,n.right=t.Pt.X,n.top=t.Pt.Y,n.bottom=t.Pt.Y,t=t.Next;t!=e;)t.Pt.X<n.left&&(n.left=t.Pt.X),t.Pt.X>n.right&&(n.right=t.Pt.X),t.Pt.Y<n.top&&(n.top=t.Pt.Y),t.Pt.Y>n.bottom&&(n.bottom=t.Pt.Y),t=t.Next;return n},ie.Clipper.PointInPolygon=function(t,e){var n=0,i=e.length;if(i<3)return 0;for(var r=e[0],o=1;o<=i;++o){var a=o==i?e[0]:e[o];if(a.Y==t.Y&&(a.X==t.X||r.Y==t.Y&&a.X>t.X==r.X<t.X))return-1;if(r.Y<t.Y!=a.Y<t.Y)if(r.X>=t.X)if(a.X>t.X)n=1-n;else{var s=(r.X-t.X)*(a.Y-t.Y)-(a.X-t.X)*(r.Y-t.Y);if(0==s)return-1;s>0==a.Y>r.Y&&(n=1-n)}else if(a.X>t.X){var s=(r.X-t.X)*(a.Y-t.Y)-(a.X-t.X)*(r.Y-t.Y);if(0==s)return-1;s>0==a.Y>r.Y&&(n=1-n)}r=a}return n},ie.Clipper.prototype.PointInPolygon=function(t,e){var n=0,i=e,r=t.X,o=t.Y,a=e.Pt.X,s=e.Pt.Y;do{e=e.Next;var l=e.Pt.X,u=e.Pt.Y;if(u==o&&(l==r||s==o&&l>r==a<r))return-1;if(s<o!=u<o)if(a>=r)if(l>r)n=1-n;else{var h=(a-r)*(u-o)-(l-r)*(s-o);if(0==h)return-1;h>0==u>s&&(n=1-n)}else if(l>r){var h=(a-r)*(u-o)-(l-r)*(s-o);if(0==h)return-1;h>0==u>s&&(n=1-n)}a=l,s=u}while(i!=e);return n},ie.Clipper.prototype.Poly2ContainsPoly1=function(t,e){var n=t;do{var i=this.PointInPolygon(n.Pt,e);if(i>=0)return i>0;n=n.Next}while(n!=t);return!0},ie.Clipper.prototype.FixupFirstLefts1=function(t,e){for(var n=0,i=this.m_PolyOuts.length;n<i;n++){var r=this.m_PolyOuts[n];if(null!=r.Pts&&null!=r.FirstLeft){this.ParseFirstLeft(r.FirstLeft)==t&&this.Poly2ContainsPoly1(r.Pts,e.Pts)&&(r.FirstLeft=e)}}},ie.Clipper.prototype.FixupFirstLefts2=function(t,e){for(var n=0,i=this.m_PolyOuts,r=i.length,o=i[n];n<r;n++,o=i[n])o.FirstLeft==t&&(o.FirstLeft=e)},ie.Clipper.ParseFirstLeft=function(t){for(;null!=t&&null==t.Pts;)t=t.FirstLeft;return t},ie.Clipper.prototype.JoinCommonEdges=function(){for(var t=0,e=this.m_Joins.length;t<e;t++){var n=this.m_Joins[t],i=this.GetOutRec(n.OutPt1.Idx),r=this.GetOutRec(n.OutPt2.Idx);if(null!=i.Pts&&null!=r.Pts){var o;if(o=i==r?i:this.Param1RightOfParam2(i,r)?r:this.Param1RightOfParam2(r,i)?i:this.GetLowermostRec(i,r),this.JoinPoints(n,i,r))if(i==r){if(i.Pts=n.OutPt1,i.BottomPt=null,r=this.CreateOutRec(),r.Pts=n.OutPt2,this.UpdateOutPtIdxs(r),this.m_UsingPolyTree)for(var a=0,s=this.m_PolyOuts.length;a<s-1;a++){var l=this.m_PolyOuts[a];null!=l.Pts&&ie.Clipper.ParseFirstLeft(l.FirstLeft)==i&&l.IsHole!=i.IsHole&&(this.Poly2ContainsPoly1(l.Pts,n.OutPt2)&&(l.FirstLeft=r))}this.Poly2ContainsPoly1(r.Pts,i.Pts)?(r.IsHole=!i.IsHole,r.FirstLeft=i,this.m_UsingPolyTree&&this.FixupFirstLefts2(r,i),(r.IsHole^this.ReverseSolution)==this.Area(r)>0&&this.ReversePolyPtLinks(r.Pts)):this.Poly2ContainsPoly1(i.Pts,r.Pts)?(r.IsHole=i.IsHole,i.IsHole=!r.IsHole,r.FirstLeft=i.FirstLeft,i.FirstLeft=r,this.m_UsingPolyTree&&this.FixupFirstLefts2(i,r),(i.IsHole^this.ReverseSolution)==this.Area(i)>0&&this.ReversePolyPtLinks(i.Pts)):(r.IsHole=i.IsHole,r.FirstLeft=i.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(i,r))}else r.Pts=null,r.BottomPt=null,r.Idx=i.Idx,i.IsHole=o.IsHole,o==r&&(i.FirstLeft=r.FirstLeft),r.FirstLeft=i,this.m_UsingPolyTree&&this.FixupFirstLefts2(r,i)}}},ie.Clipper.prototype.UpdateOutPtIdxs=function(t){var e=t.Pts;do{e.Idx=t.Idx,e=e.Prev}while(e!=t.Pts)},ie.Clipper.prototype.DoSimplePolygons=function(){for(var t=0;t<this.m_PolyOuts.length;){var e=this.m_PolyOuts[t++],n=e.Pts;if(null!=n&&!e.IsOpen)do{for(var i=n.Next;i!=e.Pts;){if(ie.IntPoint.op_Equality(n.Pt,i.Pt)&&i.Next!=n&&i.Prev!=n){var r=n.Prev,o=i.Prev;n.Prev=o,o.Next=n,i.Prev=r,r.Next=i,e.Pts=n;var a=this.CreateOutRec();a.Pts=i,this.UpdateOutPtIdxs(a),this.Poly2ContainsPoly1(a.Pts,e.Pts)?(a.IsHole=!e.IsHole,a.FirstLeft=e,this.m_UsingPolyTree&&this.FixupFirstLefts2(a,e)):this.Poly2ContainsPoly1(e.Pts,a.Pts)?(a.IsHole=e.IsHole,e.IsHole=!a.IsHole,a.FirstLeft=e.FirstLeft,e.FirstLeft=a,this.m_UsingPolyTree&&this.FixupFirstLefts2(e,a)):(a.IsHole=e.IsHole,a.FirstLeft=e.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(e,a)),i=n}i=i.Next}n=n.Next}while(n!=e.Pts)}},ie.Clipper.Area=function(t){var e=t.length;if(e<3)return 0;for(var n=0,i=0,r=e-1;i<e;++i)n+=(t[r].X+t[i].X)*(t[r].Y-t[i].Y),r=i;return.5*-n},ie.Clipper.prototype.Area=function(t){var e=t.Pts;if(null==e)return 0;var n=0;do{n+=(e.Prev.Pt.X+e.Pt.X)*(e.Prev.Pt.Y-e.Pt.Y),e=e.Next}while(e!=t.Pts);return.5*n},ie.Clipper.SimplifyPolygon=function(t,e){var n=new Array,i=new ie.Clipper(0);return i.StrictlySimple=!0,i.AddPath(t,ie.PolyType.ptSubject,!0),i.Execute(ie.ClipType.ctUnion,n,e,e),n},ie.Clipper.SimplifyPolygons=function(t,e){void 0===e&&(e=ie.PolyFillType.pftEvenOdd);var n=new Array,i=new ie.Clipper(0);return i.StrictlySimple=!0,i.AddPaths(t,ie.PolyType.ptSubject,!0),i.Execute(ie.ClipType.ctUnion,n,e,e),n},ie.Clipper.DistanceSqrd=function(t,e){var n=t.X-e.X,i=t.Y-e.Y;return n*n+i*i},ie.Clipper.DistanceFromLineSqrd=function(t,e,n){var i=e.Y-n.Y,r=n.X-e.X,o=i*e.X+r*e.Y;return(o=i*t.X+r*t.Y-o)*o/(i*i+r*r)},ie.Clipper.SlopesNearCollinear=function(t,e,n,i){return Math.abs(t.X-e.X)>Math.abs(t.Y-e.Y)?t.X>e.X==t.X<n.X?ie.Clipper.DistanceFromLineSqrd(t,e,n)<i:e.X>t.X==e.X<n.X?ie.Clipper.DistanceFromLineSqrd(e,t,n)<i:ie.Clipper.DistanceFromLineSqrd(n,t,e)<i:t.Y>e.Y==t.Y<n.Y?ie.Clipper.DistanceFromLineSqrd(t,e,n)<i:e.Y>t.Y==e.Y<n.Y?ie.Clipper.DistanceFromLineSqrd(e,t,n)<i:ie.Clipper.DistanceFromLineSqrd(n,t,e)<i},ie.Clipper.PointsAreClose=function(t,e,n){var i=t.X-e.X,r=t.Y-e.Y;return i*i+r*r<=n},ie.Clipper.ExcludeOp=function(t){var e=t.Prev;return e.Next=t.Next,t.Next.Prev=e,e.Idx=0,e},ie.Clipper.CleanPolygon=function(t,e){void 0===e&&(e=1.415);var n=t.length;if(0==n)return new Array;for(var i=new Array(n),r=0;r<n;++r)i[r]=new ie.OutPt;for(var r=0;r<n;++r)i[r].Pt=t[r],i[r].Next=i[(r+1)%n],i[r].Next.Prev=i[r],i[r].Idx=0;for(var o=e*e,a=i[0];0==a.Idx&&a.Next!=a.Prev;)ie.Clipper.PointsAreClose(a.Pt,a.Prev.Pt,o)?(a=ie.Clipper.ExcludeOp(a),n--):ie.Clipper.PointsAreClose(a.Prev.Pt,a.Next.Pt,o)?(ie.Clipper.ExcludeOp(a.Next),a=ie.Clipper.ExcludeOp(a),n-=2):ie.Clipper.SlopesNearCollinear(a.Prev.Pt,a.Pt,a.Next.Pt,o)?(a=ie.Clipper.ExcludeOp(a),n--):(a.Idx=1,a=a.Next);n<3&&(n=0);for(var s=new Array(n),r=0;r<n;++r)s[r]=new ie.IntPoint(a.Pt),a=a.Next;return i=null,s},ie.Clipper.CleanPolygons=function(t,e){for(var n=new Array(t.length),i=0,r=t.length;i<r;i++)n[i]=ie.Clipper.CleanPolygon(t[i],e);return n},ie.Clipper.Minkowski=function(t,e,n,i){var r=i?1:0,o=t.length,a=e.length,s=new Array;if(n)for(var l=0;l<a;l++){for(var u=new Array(o),h=0,c=t.length,d=t[h];h<c;h++,d=t[h])u[h]=new ie.IntPoint(e[l].X+d.X,e[l].Y+d.Y);s.push(u)}else for(var l=0;l<a;l++){for(var u=new Array(o),h=0,c=t.length,d=t[h];h<c;h++,d=t[h])u[h]=new ie.IntPoint(e[l].X-d.X,e[l].Y-d.Y);s.push(u)}for(var f=new Array,l=0;l<a-1+r;l++)for(var h=0;h<o;h++){var p=new Array;p.push(s[l%a][h%o]),p.push(s[(l+1)%a][h%o]),p.push(s[(l+1)%a][(h+1)%o]),p.push(s[l%a][(h+1)%o]),ie.Clipper.Orientation(p)||p.reverse(),f.push(p)}return f},ie.Clipper.MinkowskiSum=function(t,e,n){if(e[0]instanceof Array){for(var i=e,r=new ie.Paths,o=new ie.Clipper,a=0;a<i.length;++a){var s=ie.Clipper.Minkowski(t,i[a],!0,n);if(o.AddPaths(s,ie.PolyType.ptSubject,!0),n){var l=ie.Clipper.TranslatePath(i[a],t[0]);o.AddPath(l,ie.PolyType.ptClip,!0)}}return o.Execute(ie.ClipType.ctUnion,r,ie.PolyFillType.pftNonZero,ie.PolyFillType.pftNonZero),r}var l=e,i=ie.Clipper.Minkowski(t,l,!0,n),o=new ie.Clipper;return o.AddPaths(i,ie.PolyType.ptSubject,!0),o.Execute(ie.ClipType.ctUnion,i,ie.PolyFillType.pftNonZero,ie.PolyFillType.pftNonZero),i},ie.Clipper.TranslatePath=function(t,e){for(var n=new ie.Path,i=0;i<t.length;i++)n.push(new ie.IntPoint(t[i].X+e.X,t[i].Y+e.Y));return n},ie.Clipper.MinkowskiDiff=function(t,e){var n=ie.Clipper.Minkowski(t,e,!1,!0),i=new ie.Clipper;return i.AddPaths(n,ie.PolyType.ptSubject,!0),i.Execute(ie.ClipType.ctUnion,n,ie.PolyFillType.pftNonZero,ie.PolyFillType.pftNonZero),n},ie.Clipper.PolyTreeToPaths=function(t){var e=new Array;return ie.Clipper.AddPolyNodeToPaths(t,ie.Clipper.NodeType.ntAny,e),e},ie.Clipper.AddPolyNodeToPaths=function(t,e,n){var i=!0;switch(e){case ie.Clipper.NodeType.ntOpen:return;case ie.Clipper.NodeType.ntClosed:i=!t.IsOpen}t.m_polygon.length>0&&i&&n.push(t.m_polygon);for(var r=0,o=t.Childs(),a=o.length,s=o[r];r<a;r++,s=o[r])ie.Clipper.AddPolyNodeToPaths(s,e,n)},ie.Clipper.OpenPathsFromPolyTree=function(t){for(var e=new ie.Paths,n=0,i=t.ChildCount();n<i;n++)t.Childs()[n].IsOpen&&e.push(t.Childs()[n].m_polygon);return e},ie.Clipper.ClosedPathsFromPolyTree=function(t){var e=new ie.Paths;return ie.Clipper.AddPolyNodeToPaths(t,ie.Clipper.NodeType.ntClosed,e),e},ve(ie.Clipper,ie.ClipperBase),ie.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2},ie.ClipperOffset=function(t,e){void 0===t&&(t=2),void 0===e&&(e=ie.ClipperOffset.def_arc_tolerance),this.m_destPolys=new ie.Paths,this.m_srcPoly=new ie.Path,this.m_destPoly=new ie.Path,this.m_normals=new Array,this.m_delta=0,this.m_sinA=0,this.m_sin=0,this.m_cos=0,this.m_miterLim=0,this.m_StepsPerRad=0,this.m_lowest=new ie.IntPoint,this.m_polyNodes=new ie.PolyNode,this.MiterLimit=t,this.ArcTolerance=e,this.m_lowest.X=-1},ie.ClipperOffset.two_pi=6.28318530717959,ie.ClipperOffset.def_arc_tolerance=.25,ie.ClipperOffset.prototype.Clear=function(){ie.Clear(this.m_polyNodes.Childs()),this.m_lowest.X=-1},ie.ClipperOffset.Round=ie.Clipper.Round,ie.ClipperOffset.prototype.AddPath=function(t,e,n){var i=t.length-1;if(!(i<0)){var r=new ie.PolyNode;if(r.m_jointype=e,r.m_endtype=n,n==ie.EndType.etClosedLine||n==ie.EndType.etClosedPolygon)for(;i>0&&ie.IntPoint.op_Equality(t[0],t[i]);)i--;r.m_polygon.push(t[0]);for(var o=0,a=0,s=1;s<=i;s++)ie.IntPoint.op_Inequality(r.m_polygon[o],t[s])&&(o++,r.m_polygon.push(t[s]),(t[s].Y>r.m_polygon[a].Y||t[s].Y==r.m_polygon[a].Y&&t[s].X<r.m_polygon[a].X)&&(a=o));if(!(n==ie.EndType.etClosedPolygon&&o<2)&&(this.m_polyNodes.AddChild(r),n==ie.EndType.etClosedPolygon))if(this.m_lowest.X<0)this.m_lowest=new ie.IntPoint(this.m_polyNodes.ChildCount()-1,a);else{var l=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y];(r.m_polygon[a].Y>l.Y||r.m_polygon[a].Y==l.Y&&r.m_polygon[a].X<l.X)&&(this.m_lowest=new ie.IntPoint(this.m_polyNodes.ChildCount()-1,a))}}},ie.ClipperOffset.prototype.AddPaths=function(t,e,n){for(var i=0,r=t.length;i<r;i++)this.AddPath(t[i],e,n)},ie.ClipperOffset.prototype.FixOrientations=function(){if(this.m_lowest.X>=0&&!ie.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var t=0;t<this.m_polyNodes.ChildCount();t++){var e=this.m_polyNodes.Childs()[t];(e.m_endtype==ie.EndType.etClosedPolygon||e.m_endtype==ie.EndType.etClosedLine&&ie.Clipper.Orientation(e.m_polygon))&&e.m_polygon.reverse()}else for(var t=0;t<this.m_polyNodes.ChildCount();t++){var e=this.m_polyNodes.Childs()[t];e.m_endtype!=ie.EndType.etClosedLine||ie.Clipper.Orientation(e.m_polygon)||e.m_polygon.reverse()}},ie.ClipperOffset.GetUnitNormal=function(t,e){var n=e.X-t.X,i=e.Y-t.Y;if(0==n&&0==i)return new ie.DoublePoint(0,0);var r=1/Math.sqrt(n*n+i*i);return n*=r,i*=r,new ie.DoublePoint(i,-n)},ie.ClipperOffset.prototype.DoOffset=function(t){if(this.m_destPolys=new Array,this.m_delta=t,ie.ClipperBase.near_zero(t))for(var e=0;e<this.m_polyNodes.ChildCount();e++){var n=this.m_polyNodes.Childs()[e];n.m_endtype==ie.EndType.etClosedPolygon&&this.m_destPolys.push(n.m_polygon)}else{this.MiterLimit>2?this.m_miterLim=2/(this.MiterLimit*this.MiterLimit):this.m_miterLim=.5;var i;i=this.ArcTolerance<=0?ie.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(t)*ie.ClipperOffset.def_arc_tolerance?Math.abs(t)*ie.ClipperOffset.def_arc_tolerance:this.ArcTolerance;var r=3.14159265358979/Math.acos(1-i/Math.abs(t));this.m_sin=Math.sin(ie.ClipperOffset.two_pi/r),this.m_cos=Math.cos(ie.ClipperOffset.two_pi/r),this.m_StepsPerRad=r/ie.ClipperOffset.two_pi,t<0&&(this.m_sin=-this.m_sin);for(var e=0;e<this.m_polyNodes.ChildCount();e++){var n=this.m_polyNodes.Childs()[e];this.m_srcPoly=n.m_polygon;var o=this.m_srcPoly.length;if(!(0==o||t<=0&&(o<3||n.m_endtype!=ie.EndType.etClosedPolygon)))if(this.m_destPoly=new Array,1!=o){this.m_normals.length=0;for(var a=0;a<o-1;a++)this.m_normals.push(ie.ClipperOffset.GetUnitNormal(this.m_srcPoly[a],this.m_srcPoly[a+1]));if(n.m_endtype==ie.EndType.etClosedLine||n.m_endtype==ie.EndType.etClosedPolygon?this.m_normals.push(ie.ClipperOffset.GetUnitNormal(this.m_srcPoly[o-1],this.m_srcPoly[0])):this.m_normals.push(new ie.DoublePoint(this.m_normals[o-2])),n.m_endtype==ie.EndType.etClosedPolygon){for(var s=o-1,a=0;a<o;a++)s=this.OffsetPoint(a,s,n.m_jointype);this.m_destPolys.push(this.m_destPoly)}else if(n.m_endtype==ie.EndType.etClosedLine){for(var s=o-1,a=0;a<o;a++)s=this.OffsetPoint(a,s,n.m_jointype);this.m_destPolys.push(this.m_destPoly),this.m_destPoly=new Array;for(var l=this.m_normals[o-1],a=o-1;a>0;a--)this.m_normals[a]=new ie.DoublePoint(-this.m_normals[a-1].X,-this.m_normals[a-1].Y);this.m_normals[0]=new ie.DoublePoint(-l.X,-l.Y),s=0;for(var a=o-1;a>=0;a--)s=this.OffsetPoint(a,s,n.m_jointype);this.m_destPolys.push(this.m_destPoly)}else{for(var s=0,a=1;a<o-1;++a)s=this.OffsetPoint(a,s,n.m_jointype);var u;if(n.m_endtype==ie.EndType.etOpenButt){var a=o-1;u=new ie.IntPoint(ie.ClipperOffset.Round(this.m_srcPoly[a].X+this.m_normals[a].X*t),ie.ClipperOffset.Round(this.m_srcPoly[a].Y+this.m_normals[a].Y*t)),this.m_destPoly.push(u),u=new ie.IntPoint(ie.ClipperOffset.Round(this.m_srcPoly[a].X-this.m_normals[a].X*t),ie.ClipperOffset.Round(this.m_srcPoly[a].Y-this.m_normals[a].Y*t)),this.m_destPoly.push(u)}else{var a=o-1;s=o-2,this.m_sinA=0,this.m_normals[a]=new ie.DoublePoint(-this.m_normals[a].X,-this.m_normals[a].Y),n.m_endtype==ie.EndType.etOpenSquare?this.DoSquare(a,s):this.DoRound(a,s)}for(var a=o-1;a>0;a--)this.m_normals[a]=new ie.DoublePoint(-this.m_normals[a-1].X,-this.m_normals[a-1].Y);this.m_normals[0]=new ie.DoublePoint(-this.m_normals[1].X,-this.m_normals[1].Y),s=o-1;for(var a=s-1;a>0;--a)s=this.OffsetPoint(a,s,n.m_jointype);n.m_endtype==ie.EndType.etOpenButt?(u=new ie.IntPoint(ie.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*t),ie.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*t)),this.m_destPoly.push(u),u=new ie.IntPoint(ie.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*t),ie.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*t)),this.m_destPoly.push(u)):(s=1,this.m_sinA=0,n.m_endtype==ie.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1)),this.m_destPolys.push(this.m_destPoly)}}else{if(n.m_jointype==ie.JoinType.jtRound)for(var h=1,c=0,a=1;a<=r;a++){this.m_destPoly.push(new ie.IntPoint(ie.ClipperOffset.Round(this.m_srcPoly[0].X+h*t),ie.ClipperOffset.Round(this.m_srcPoly[0].Y+c*t)));var d=h;h=h*this.m_cos-this.m_sin*c,c=d*this.m_sin+c*this.m_cos}else for(var h=-1,c=-1,a=0;a<4;++a)this.m_destPoly.push(new ie.IntPoint(ie.ClipperOffset.Round(this.m_srcPoly[0].X+h*t),ie.ClipperOffset.Round(this.m_srcPoly[0].Y+c*t))),h<0?h=1:c<0?c=1:h=-1;this.m_destPolys.push(this.m_destPoly)}}}},ie.ClipperOffset.prototype.Execute=function(){var t=arguments;if(t[0]instanceof ie.PolyTree){var e=t[0],n=t[1];e.Clear(),this.FixOrientations(),this.DoOffset(n);var i=new ie.Clipper(0);if(i.AddPaths(this.m_destPolys,ie.PolyType.ptSubject,!0),n>0)i.Execute(ie.ClipType.ctUnion,e,ie.PolyFillType.pftPositive,ie.PolyFillType.pftPositive);else{var r=ie.Clipper.GetBounds(this.m_destPolys),o=new ie.Path;if(o.push(new ie.IntPoint(r.left-10,r.bottom+10)),o.push(new ie.IntPoint(r.right+10,r.bottom+10)),o.push(new ie.IntPoint(r.right+10,r.top-10)),o.push(new ie.IntPoint(r.left-10,r.top-10)),i.AddPath(o,ie.PolyType.ptSubject,!0),i.ReverseSolution=!0,i.Execute(ie.ClipType.ctUnion,e,ie.PolyFillType.pftNegative,ie.PolyFillType.pftNegative),1==e.ChildCount()&&e.Childs()[0].ChildCount()>0){var a=e.Childs()[0];e.Childs()[0]=a.Childs()[0],e.Childs()[0].m_Parent=e;for(var s=1;s<a.ChildCount();s++)e.AddChild(a.Childs()[s])}else e.Clear()}}else{var e=t[0],n=t[1];ie.Clear(e),this.FixOrientations(),this.DoOffset(n);var i=new ie.Clipper(0);if(i.AddPaths(this.m_destPolys,ie.PolyType.ptSubject,!0),n>0)i.Execute(ie.ClipType.ctUnion,e,ie.PolyFillType.pftPositive,ie.PolyFillType.pftPositive);else{var r=ie.Clipper.GetBounds(this.m_destPolys),o=new ie.Path;o.push(new ie.IntPoint(r.left-10,r.bottom+10)),o.push(new ie.IntPoint(r.right+10,r.bottom+10)),o.push(new ie.IntPoint(r.right+10,r.top-10)),o.push(new ie.IntPoint(r.left-10,r.top-10)),i.AddPath(o,ie.PolyType.ptSubject,!0),i.ReverseSolution=!0,i.Execute(ie.ClipType.ctUnion,e,ie.PolyFillType.pftNegative,ie.PolyFillType.pftNegative),e.length>0&&e.splice(0,1)}}},ie.ClipperOffset.prototype.OffsetPoint=function(t,e,n){if(this.m_sinA=this.m_normals[e].X*this.m_normals[t].Y-this.m_normals[t].X*this.m_normals[e].Y,Math.abs(this.m_sinA*this.m_delta)<1){if(this.m_normals[e].X*this.m_normals[t].X+this.m_normals[t].Y*this.m_normals[e].Y>0)return this.m_destPoly.push(new ie.IntPoint(ie.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_normals[e].X*this.m_delta),ie.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_normals[e].Y*this.m_delta))),e}else this.m_sinA>1?this.m_sinA=1:this.m_sinA<-1&&(this.m_sinA=-1);if(this.m_sinA*this.m_delta<0)this.m_destPoly.push(new ie.IntPoint(ie.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_normals[e].X*this.m_delta),ie.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_normals[e].Y*this.m_delta))),this.m_destPoly.push(new ie.IntPoint(this.m_srcPoly[t])),this.m_destPoly.push(new ie.IntPoint(ie.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_normals[t].X*this.m_delta),ie.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_normals[t].Y*this.m_delta)));else switch(n){case ie.JoinType.jtMiter:var i=this.m_normals[t].X*this.m_normals[e].X+this.m_normals[t].Y*this.m_normals[e].Y+1;i>=this.m_miterLim?this.DoMiter(t,e,i):this.DoSquare(t,e);break;case ie.JoinType.jtSquare:this.DoSquare(t,e);break;case ie.JoinType.jtRound:this.DoRound(t,e)}return e=t},ie.ClipperOffset.prototype.DoSquare=function(t,e){var n=Math.tan(Math.atan2(this.m_sinA,this.m_normals[e].X*this.m_normals[t].X+this.m_normals[e].Y*this.m_normals[t].Y)/4);this.m_destPoly.push(new ie.IntPoint(ie.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_delta*(this.m_normals[e].X-this.m_normals[e].Y*n)),ie.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_delta*(this.m_normals[e].Y+this.m_normals[e].X*n)))),this.m_destPoly.push(new ie.IntPoint(ie.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_delta*(this.m_normals[t].X+this.m_normals[t].Y*n)),ie.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_delta*(this.m_normals[t].Y-this.m_normals[t].X*n))))},ie.ClipperOffset.prototype.DoMiter=function(t,e,n){var i=this.m_delta/n;this.m_destPoly.push(new ie.IntPoint(ie.ClipperOffset.Round(this.m_srcPoly[t].X+(this.m_normals[e].X+this.m_normals[t].X)*i),ie.ClipperOffset.Round(this.m_srcPoly[t].Y+(this.m_normals[e].Y+this.m_normals[t].Y)*i)))},ie.ClipperOffset.prototype.DoRound=function(t,e){for(var n,i=Math.atan2(this.m_sinA,this.m_normals[e].X*this.m_normals[t].X+this.m_normals[e].Y*this.m_normals[t].Y),r=Math.max(ie.Cast_Int32(ie.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(i))),1),o=this.m_normals[e].X,a=this.m_normals[e].Y,s=0;s<r;++s)this.m_destPoly.push(new ie.IntPoint(ie.ClipperOffset.Round(this.m_srcPoly[t].X+o*this.m_delta),ie.ClipperOffset.Round(this.m_srcPoly[t].Y+a*this.m_delta))),n=o,o=o*this.m_cos-this.m_sin*a,a=n*this.m_sin+a*this.m_cos;this.m_destPoly.push(new ie.IntPoint(ie.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_normals[t].X*this.m_delta),ie.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_normals[t].Y*this.m_delta)))},ie.Error=function(t){try{throw new Error(t)}catch(t){alert(t.message)}},ie.JS={},ie.JS.AreaOfPolygon=function(t,e){return e||(e=1),ie.Clipper.Area(t)/(e*e)},ie.JS.AreaOfPolygons=function(t,e){e||(e=1);for(var n=0,i=0;i<t.length;i++)n+=ie.Clipper.Area(t[i]);return n/(e*e)},ie.JS.BoundsOfPath=function(t,e){return ie.JS.BoundsOfPaths([t],e)},ie.JS.BoundsOfPaths=function(t,e){e||(e=1);var n=ie.Clipper.GetBounds(t);return n.left/=e,n.bottom/=e,n.right/=e,n.top/=e,n},ie.JS.Clean=function(t,e){if(!(t instanceof Array))return[];var n=t[0]instanceof Array,t=ie.JS.Clone(t);if("number"!=typeof e||null===e)return ie.Error("Delta is not a number in Clean()."),t;if(0===t.length||1==t.length&&0===t[0].length||e<0)return t;n||(t=[t]);for(var i,r,o,a,s,l,u,h=t.length,c=[],d=0;d<h;d++)if(r=t[d],0!==(i=r.length))if(i<3)o=r,c.push(o);else{for(o=r,a=e*e,s=r[0],l=1,u=1;u<i;u++)(r[u].X-s.X)*(r[u].X-s.X)+(r[u].Y-s.Y)*(r[u].Y-s.Y)<=a||(o[l]=r[u],s=r[u],l++);s=r[l-1],(r[0].X-s.X)*(r[0].X-s.X)+(r[0].Y-s.Y)*(r[0].Y-s.Y)<=a&&l--,l<i&&o.splice(l,i-l),o.length&&c.push(o)}return!n&&c.length?c=c[0]:n||0!==c.length?n&&0===c.length&&(c=[[]]):c=[],c},ie.JS.Clone=function(t){if(!(t instanceof Array))return[];if(0===t.length)return[];if(1==t.length&&0===t[0].length)return[[]];var e=t[0]instanceof Array;e||(t=[t]);var n,i,r,o,a=t.length,s=new Array(a);for(i=0;i<a;i++){for(n=t[i].length,o=new Array(n),r=0;r<n;r++)o[r]={X:t[i][r].X,Y:t[i][r].Y};s[i]=o}return e||(s=s[0]),s},ie.JS.Lighten=function(t,e){if(!(t instanceof Array))return[];if("number"!=typeof e||null===e)return ie.Error("Tolerance is not a number in Lighten()."),ie.JS.Clone(t);if(0===t.length||1==t.length&&0===t[0].length||e<0)return ie.JS.Clone(t);t[0]instanceof Array||(t=[t]);var n,i,r,o,a,s,l,u,h,c,d,f,p,m,v,g,y=t.length,_=e*e,x=[];for(n=0;n<y;n++)if(r=t[n],0!=(s=r.length)){for(o=0;o<1e6;o++){for(a=[],s=r.length,r[s-1].X!=r[0].X||r[s-1].Y!=r[0].Y?(d=1,r.push({X:r[0].X,Y:r[0].Y}),s=r.length):d=0,c=[],i=0;i<s-2;i++)l=r[i],h=r[i+1],u=r[i+2],v=l.X,g=l.Y,f=u.X-v,p=u.Y-g,0===f&&0===p||(m=((h.X-v)*f+(h.Y-g)*p)/(f*f+p*p),m>1?(v=u.X,g=u.Y):m>0&&(v+=f*m,g+=p*m)),f=h.X-v,p=h.Y-g,f*f+p*p<=_&&(c[i+1]=1,i++);for(a.push({X:r[0].X,Y:r[0].Y}),i=1;i<s-1;i++)c[i]||a.push({X:r[i].X,Y:r[i].Y});if(a.push({X:r[s-1].X,Y:r[s-1].Y}),d&&r.pop(),!c.length)break;r=a}s=a.length,a[s-1].X==a[0].X&&a[s-1].Y==a[0].Y&&a.pop(),a.length>2&&x.push(a)}return t[0]instanceof Array||(x=x[0]),void 0===x&&(x=[[]]),x},ie.JS.PerimeterOfPath=function(t,e,n){if(void 0===t)return 0;var i,r,o=Math.sqrt,a=0,s=0,l=0,u=0,h=0,c=t.length;if(c<2)return 0;for(e&&(t[c]=t[0],c++);--c;)i=t[c],s=i.X,l=i.Y,r=t[c-1],u=r.X,h=r.Y,a+=o((s-u)*(s-u)+(l-h)*(l-h));return e&&t.pop(),a/n},ie.JS.PerimeterOfPaths=function(t,e,n){n||(n=1);for(var i=0,r=0;r<t.length;r++)i+=ie.JS.PerimeterOfPath(t[r],e,n);return i},ie.JS.ScaleDownPath=function(t,e){var n,i;for(e||(e=1),n=t.length;n--;)i=t[n],i.X=i.X/e,i.Y=i.Y/e},ie.JS.ScaleDownPaths=function(t,e){var n,i,r;for(e||(e=1),n=t.length;n--;)for(i=t[n].length;i--;)r=t[n][i],r.X=r.X/e,r.Y=r.Y/e},ie.JS.ScaleUpPath=function(t,e){var n,i,r=Math.round;for(e||(e=1),n=t.length;n--;)i=t[n],i.X=r(i.X*e),i.Y=r(i.Y*e)},ie.JS.ScaleUpPaths=function(t,e){var n,i,r,o=Math.round;for(e||(e=1),n=t.length;n--;)for(i=t[n].length;i--;)r=t[n][i],r.X=o(r.X*e),r.Y=o(r.Y*e)},ie.ExPolygons=function(){return[]},ie.ExPolygon=function(){this.outer=null,this.holes=null},ie.JS.AddOuterPolyNodeToExPolygons=function(t,e){var n=new ie.ExPolygon;n.outer=t.Contour();var i=t.Childs(),r=i.length;n.holes=new Array(r);var o,a,s,l,u,h;for(s=0;s<r;s++)for(o=i[s],n.holes[s]=o.Contour(),l=0,u=o.Childs(),h=u.length;l<h;l++)a=u[l],ie.JS.AddOuterPolyNodeToExPolygons(a,e);e.push(n)},ie.JS.ExPolygonsToPaths=function(t){var e,n,i,r,o=new ie.Paths;for(e=0,i=t.length;e<i;e++)for(o.push(t[e].outer),n=0,r=t[e].holes.length;n<r;n++)o.push(t[e].holes[n]);return o},ie.JS.PolyTreeToExPolygons=function(t){var e,n,i,r,o=new ie.ExPolygons;for(n=0,i=t.Childs(),r=i.length;n<r;n++)e=i[n],ie.JS.AddOuterPolyNodeToExPolygons(e,o);return o}}()},function(t,e,n){!function(e,n){t.exports=n()}(0,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";t.exports=n(1)},function(t,e,n){"use strict";t.exports={color:{Color:n(2),math:n(6),interpret:n(3)},controllers:{Controller:n(7),BooleanController:n(8),OptionController:n(10),StringController:n(11),NumberController:n(12),NumberControllerBox:n(13),NumberControllerSlider:n(14),FunctionController:n(20),ColorController:n(21)},dom:{dom:n(9)},gui:{GUI:n(22)},GUI:n(22)}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e,n){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space?this.__state[e]:(m.recalculateRGB(this,e,n),this.__state[e])},set:function(t){"RGB"!==this.__state.space&&(m.recalculateRGB(this,e,n),this.__state.space="RGB"),this.__state[e]=t}})}function a(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space?this.__state[e]:(m.recalculateHSV(this),this.__state[e])},set:function(t){"HSV"!==this.__state.space&&(m.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=t}})}e.__esModule=!0;var s=n(3),l=i(s),u=n(6),h=i(u),c=n(4),d=i(c),f=n(5),p=i(f),m=function(){function t(){if(r(this,t),this.__state=l.default.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return t.prototype.toString=function(){return d.default(this)},t.prototype.toOriginal=function(){return this.__state.conversion.write(this)},t}();m.recalculateRGB=function(t,e,n){if("HEX"===t.__state.space)t.__state[e]=h.default.component_from_hex(t.__state.hex,n);else{if("HSV"!==t.__state.space)throw new Error("Corrupted color state");p.default.extend(t.__state,h.default.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}},m.recalculateHSV=function(t){var e=h.default.rgb_to_hsv(t.r,t.g,t.b);p.default.extend(t.__state,{s:e.s,v:e.v}),p.default.isNaN(e.h)?p.default.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=e.h},m.COMPONENTS=["r","g","b","h","s","v","hex","a"],o(m.prototype,"r",2),o(m.prototype,"g",1),o(m.prototype,"b",0),a(m.prototype,"h"),a(m.prototype,"s"),a(m.prototype,"v"),Object.defineProperty(m.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(m.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=h.default.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}}),e.default=m,t.exports=e.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(4),o=i(r),a=n(5),s=i(a),l=[{litmus:s.default.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString(),0)}},write:o.default},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString(),0)}},write:o.default},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:o.default},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:o.default}}},{litmus:s.default.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:s.default.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:s.default.isObject,conversions:{RGBA_OBJ:{read:function(t){return!!(s.default.isNumber(t.r)&&s.default.isNumber(t.g)&&s.default.isNumber(t.b)&&s.default.isNumber(t.a))&&{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return!!(s.default.isNumber(t.r)&&s.default.isNumber(t.g)&&s.default.isNumber(t.b))&&{space:"RGB",r:t.r,g:t.g,b:t.b}},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return!!(s.default.isNumber(t.h)&&s.default.isNumber(t.s)&&s.default.isNumber(t.v)&&s.default.isNumber(t.a))&&{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return!!(s.default.isNumber(t.h)&&s.default.isNumber(t.s)&&s.default.isNumber(t.v))&&{space:"HSV",h:t.h,s:t.s,v:t.v}},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}],u=void 0,h=void 0,c=function(){h=!1;var t=arguments.length>1?s.default.toArray(arguments):arguments[0];return s.default.each(l,function(e){if(e.litmus(t))return s.default.each(e.conversions,function(e,n){if(u=e.read(t),!1===h&&!1!==u)return h=u,u.conversionName=n,u.conversion=e,s.default.BREAK}),s.default.BREAK}),h};e.default=c,t.exports=e.default},function(t,e,n){"use strict";e.__esModule=!0;var i=n(5),r=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=function(t){if(1===t.a||r.default.isUndefined(t.a)){for(var e=t.hex.toString(16);e.length<6;)e="0"+e;return"#"+e}return"rgba("+Math.round(t.r)+","+Math.round(t.g)+","+Math.round(t.b)+","+t.a+")"},t.exports=e.default},function(t,e){"use strict";e.__esModule=!0;var n=Array.prototype.forEach,i=Array.prototype.slice,r={BREAK:{},extend:function(t){return this.each(i.call(arguments,1),function(e){for(var n in e)this.isUndefined(e[n])||(t[n]=e[n])},this),t},defaults:function(t){return this.each(i.call(arguments,1),function(e){for(var n in e)this.isUndefined(t[n])&&(t[n]=e[n])},this),t},compose:function(){var t=i.call(arguments);return function(){for(var e=i.call(arguments),n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},each:function(t,e,i){if(t)if(n&&t.forEach&&t.forEach===n)t.forEach(e,i);else if(t.length===t.length+0){var r=void 0,o=void 0;for(r=0,o=t.length;r<o;r++)if(r in t&&e.call(i,t[r],r)===this.BREAK)return}else for(var r in t)if(e.call(i,t[r],r)===this.BREAK)return},defer:function(t){setTimeout(t,0)},toArray:function(t){return t.toArray?t.toArray():i.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){return isNaN(t)}),isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return!1===t||!0===t},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}};e.default=r,t.exports=e.default},function(t,e){"use strict";e.__esModule=!0;var n=void 0,i={hsv_to_rgb:function(t,e,n){var i=Math.floor(t/60)%6,r=t/60-Math.floor(t/60),o=n*(1-e),a=n*(1-r*e),s=n*(1-(1-r)*e),l=[[n,s,o],[a,n,o],[o,n,s],[o,a,n],[s,o,n],[n,o,a]][i];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(t,e,n){var i=Math.min(t,e,n),r=Math.max(t,e,n),o=r-i,a=void 0,s=void 0;return 0===r?{h:NaN,s:0,v:0}:(s=o/r,a=t===r?(e-n)/o:e===r?2+(n-t)/o:4+(t-e)/o,a/=6,a<0&&(a+=1),{h:360*a,s:s,v:r/255})},rgb_to_hex:function(t,e,n){var i=this.hex_with_component(0,2,t);return i=this.hex_with_component(i,1,e),i=this.hex_with_component(i,0,n)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(t,e,i){return i<<(n=8*e)|t&~(255<<n)}};e.default=i,t.exports=e.default},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var i=function(){function t(e,i){n(this,t),this.initialValue=e[i],this.domElement=document.createElement("div"),this.object=e,this.property=i,this.__onChange=void 0,this.__onFinishChange=void 0}return t.prototype.onChange=function(t){return this.__onChange=t,this},t.prototype.onFinishChange=function(t){return this.__onFinishChange=t,this},t.prototype.setValue=function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this},t.prototype.getValue=function(){return this.object[this.property]},t.prototype.updateDisplay=function(){return this},t.prototype.isModified=function(){return this.initialValue!==this.getValue()},t}();e.default=i,t.exports=e.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=n(7),s=i(a),l=n(9),u=i(l),h=function(t){function e(n,i){function o(){a.setValue(!a.__prev)}r(this,e),t.call(this,n,i);var a=this;this.__prev=this.getValue(),this.__checkbox=document.createElement("input"),this.__checkbox.setAttribute("type","checkbox"),u.default.bind(this.__checkbox,"change",o,!1),this.domElement.appendChild(this.__checkbox),this.updateDisplay()}return o(e,t),e.prototype.setValue=function(e){var n=t.prototype.setValue.call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n},e.prototype.updateDisplay=function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,t.prototype.updateDisplay.call(this)},e}(s.default);e.default=h,t.exports=e.default},function(t,e,n){"use strict";function i(t){if("0"===t||o.default.isUndefined(t))return 0;var e=t.match(l);return o.default.isNull(e)?0:parseFloat(e[1])}e.__esModule=!0;var r=n(5),o=function(t){return t&&t.__esModule?t:{default:t}}(r),a={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},s={};o.default.each(a,function(t,e){o.default.each(t,function(t){s[t]=e})});var l=/(\d+(\.\d+)?)px/,u={makeSelectable:function(t,e){void 0!==t&&void 0!==t.style&&(t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off")},makeFullscreen:function(t,e,n){var i=n,r=e;o.default.isUndefined(r)&&(r=!0),o.default.isUndefined(i)&&(i=!0),t.style.position="absolute",r&&(t.style.left=0,t.style.right=0),i&&(t.style.top=0,t.style.bottom=0)},fakeEvent:function(t,e,n,i){var r=n||{},a=s[e];if(!a)throw new Error("Event type "+e+" not supported.");var l=document.createEvent(a);switch(a){case"MouseEvents":var u=r.x||r.clientX||0,h=r.y||r.clientY||0;l.initMouseEvent(e,r.bubbles||!1,r.cancelable||!0,window,r.clickCount||1,0,0,u,h,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=l.initKeyboardEvent||l.initKeyEvent;o.default.defaults(r,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(e,r.bubbles||!1,r.cancelable,window,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.keyCode,r.charCode);break;default:l.initEvent(e,r.bubbles||!1,r.cancelable||!0)}o.default.defaults(l,i),t.dispatchEvent(l)},bind:function(t,e,n,i){var r=i||!1;return t.addEventListener?t.addEventListener(e,n,r):t.attachEvent&&t.attachEvent("on"+e,n),u},unbind:function(t,e,n,i){var r=i||!1;return t.removeEventListener?t.removeEventListener(e,n,r):t.detachEvent&&t.detachEvent("on"+e,n),u},addClass:function(t,e){if(void 0===t.className)t.className=e;else if(t.className!==e){var n=t.className.split(/ +/);-1===n.indexOf(e)&&(n.push(e),t.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return u},removeClass:function(t,e){if(e)if(t.className===e)t.removeAttribute("class");else{var n=t.className.split(/ +/),i=n.indexOf(e);-1!==i&&(n.splice(i,1),t.className=n.join(" "))}else t.className=void 0;return u},hasClass:function(t,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(t.className)||!1},getWidth:function(t){var e=getComputedStyle(t);return i(e["border-left-width"])+i(e["border-right-width"])+i(e["padding-left"])+i(e["padding-right"])+i(e.width)},getHeight:function(t){var e=getComputedStyle(t);return i(e["border-top-width"])+i(e["border-bottom-width"])+i(e["padding-top"])+i(e["padding-bottom"])+i(e.height)},getOffset:function(t){var e=t,n={left:0,top:0};if(e.offsetParent)do{n.left+=e.offsetLeft,n.top+=e.offsetTop,e=e.offsetParent}while(e);return n},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}};e.default=u,t.exports=e.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=n(7),s=i(a),l=n(9),u=i(l),h=n(5),c=i(h),d=function(t){function e(n,i,o){r(this,e),t.call(this,n,i);var a=o,s=this;this.__select=document.createElement("select"),c.default.isArray(a)&&function(){var t={};c.default.each(a,function(e){t[e]=e}),a=t}(),c.default.each(a,function(t,e){var n=document.createElement("option");n.innerHTML=e,n.setAttribute("value",t),s.__select.appendChild(n)}),this.updateDisplay(),u.default.bind(this.__select,"change",function(){var t=this.options[this.selectedIndex].value;s.setValue(t)}),this.domElement.appendChild(this.__select)}return o(e,t),e.prototype.setValue=function(e){var n=t.prototype.setValue.call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n},e.prototype.updateDisplay=function(){return this.__select.value=this.getValue(),t.prototype.updateDisplay.call(this)},e}(s.default);e.default=d,t.exports=e.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=n(7),s=i(a),l=n(9),u=i(l),h=function(t){function e(n,i){function o(){s.setValue(s.__input.value)}function a(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}r(this,e),t.call(this,n,i);var s=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),u.default.bind(this.__input,"keyup",o),u.default.bind(this.__input,"change",o),u.default.bind(this.__input,"blur",a),u.default.bind(this.__input,"keydown",function(t){13===t.keyCode&&this.blur()}),this.updateDisplay(),this.domElement.appendChild(this.__input)}return o(e,t),e.prototype.updateDisplay=function(){return u.default.isActive(this.__input)||(this.__input.value=this.getValue()),t.prototype.updateDisplay.call(this)},e}(s.default);e.default=h,t.exports=e.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t){var e=t.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}e.__esModule=!0;var s=n(7),l=i(s),u=n(5),h=i(u),c=function(t){function e(n,i,o){r(this,e),t.call(this,n,i);var s=o||{};this.__min=s.min,this.__max=s.max,this.__step=s.step,h.default.isUndefined(this.__step)?0===this.initialValue?this.__impliedStep=1:this.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(this.initialValue))/Math.LN10))/10:this.__impliedStep=this.__step,this.__precision=a(this.__impliedStep)}return o(e,t),e.prototype.setValue=function(e){var n=e;return void 0!==this.__min&&n<this.__min?n=this.__min:void 0!==this.__max&&n>this.__max&&(n=this.__max),void 0!==this.__step&&n%this.__step!=0&&(n=Math.round(n/this.__step)*this.__step),t.prototype.setValue.call(this,n)},e.prototype.min=function(t){return this.__min=t,this},e.prototype.max=function(t){return this.__max=t,this},e.prototype.step=function(t){return this.__step=t,this.__impliedStep=t,this.__precision=a(t),this},e}(l.default);e.default=c,t.exports=e.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}e.__esModule=!0;var s=n(12),l=i(s),u=n(9),h=i(u),c=n(5),d=i(c),f=function(t){function e(n,i,o){function a(){var t=parseFloat(f.__input.value);d.default.isNaN(t)||f.setValue(t)}function s(){a(),f.__onFinishChange&&f.__onFinishChange.call(f,f.getValue())}function l(t){h.default.bind(window,"mousemove",u),h.default.bind(window,"mouseup",c),p=t.clientY}function u(t){var e=p-t.clientY;f.setValue(f.getValue()+e*f.__impliedStep),p=t.clientY}function c(){h.default.unbind(window,"mousemove",u),h.default.unbind(window,"mouseup",c)}r(this,e),t.call(this,n,i,o),this.__truncationSuspended=!1;var f=this,p=void 0;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),h.default.bind(this.__input,"change",a),h.default.bind(this.__input,"blur",s),h.default.bind(this.__input,"mousedown",l),h.default.bind(this.__input,"keydown",function(t){13===t.keyCode&&(f.__truncationSuspended=!0,this.blur(),f.__truncationSuspended=!1)}),this.updateDisplay(),this.domElement.appendChild(this.__input)}return o(e,t),e.prototype.updateDisplay=function(){return this.__input.value=this.__truncationSuspended?this.getValue():a(this.getValue(),this.__precision),t.prototype.updateDisplay.call(this)},e}(l.default);e.default=f,t.exports=e.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e,n,i,r){return i+(t-e)/(n-e)*(r-i)}e.__esModule=!0;var s=n(12),l=i(s),u=n(9),h=i(u),c=n(15),d=i(c),f=n(16),p=i(f),m=function(t){function e(n,i,o,s,l){function u(t){h.default.bind(window,"mousemove",c),h.default.bind(window,"mouseup",d),c(t)}function c(t){t.preventDefault();var e=h.default.getOffset(f.__background),n=h.default.getWidth(f.__background);return f.setValue(a(t.clientX,e.left,e.left+n,f.__min,f.__max)),!1}function d(){h.default.unbind(window,"mousemove",c),h.default.unbind(window,"mouseup",d),f.__onFinishChange&&f.__onFinishChange.call(f,f.getValue())}r(this,e),t.call(this,n,i,{min:o,max:s,step:l});var f=this;this.__background=document.createElement("div"),this.__foreground=document.createElement("div"),h.default.bind(this.__background,"mousedown",u),h.default.addClass(this.__background,"slider"),h.default.addClass(this.__foreground,"slider-fg"),this.updateDisplay(),this.__background.appendChild(this.__foreground),this.domElement.appendChild(this.__background)}return o(e,t),e.prototype.updateDisplay=function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",t.prototype.updateDisplay.call(this)},e}(l.default);m.useDefaultStyles=function(){d.default.inject(p.default)},e.default=m,t.exports=e.default},function(t,e){"use strict";t.exports={load:function(t,e){var n=e||document,i=n.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=t,n.getElementsByTagName("head")[0].appendChild(i)},inject:function(t,e){var n=e||document,i=document.createElement("style");i.type="text/css",i.innerHTML=t,n.getElementsByTagName("head")[0].appendChild(i)}}},function(t,e,n){var i=n(17);"string"==typeof i&&(i=[[t.id,i,""]]);n(19)(i,{});i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(18)(),e.push([t.id,"/**\n * dat-gui JavaScript Controller Library\n * http://code.google.com/p/dat-gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n.slider {\n  box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden; }\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em; }\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border: 1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em; }\n",""])},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var i={},r=0;r<this.length;r++){var o=this[r][0];"number"==typeof o&&(i[o]=!0)}for(r=0;r<e.length;r++){var a=e[r];"number"==typeof a[0]&&i[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},function(t,e,n){function i(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=c[i.id];if(r){r.refs++;for(var o=0;o<r.parts.length;o++)r.parts[o](i.parts[o]);for(;o<i.parts.length;o++)r.parts.push(s(i.parts[o],e))}else{for(var a=[],o=0;o<i.parts.length;o++)a.push(s(i.parts[o],e));c[i.id]={id:i.id,refs:1,parts:a}}}}function r(t){for(var e=[],n={},i=0;i<t.length;i++){var r=t[i],o=r[0],a=r[1],s=r[2],l=r[3],u={css:a,media:s,sourceMap:l};n[o]?n[o].parts.push(u):e.push(n[o]={id:o,parts:[u]})}return e}function o(){var t=document.createElement("style"),e=p();return t.type="text/css",e.appendChild(t),t}function a(){var t=document.createElement("link"),e=p();return t.rel="stylesheet",e.appendChild(t),t}function s(t,e){var n,i,r;if(e.singleton){var s=v++;n=m||(m=o()),i=l.bind(null,n,s,!1),r=l.bind(null,n,s,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=a(),i=h.bind(null,n),r=function(){n.parentNode.removeChild(n),n.href&&URL.revokeObjectURL(n.href)}):(n=o(),i=u.bind(null,n),r=function(){n.parentNode.removeChild(n)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else r()}}function l(t,e,n,i){var r=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=g(e,r);else{var o=document.createTextNode(r),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(o,a[e]):t.appendChild(o)}}function u(t,e){var n=e.css,i=e.media;e.sourceMap;if(i&&t.setAttribute("media",i),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function h(t,e){var n=e.css,i=(e.media,e.sourceMap);i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var r=new Blob([n],{type:"text/css"}),o=t.href;t.href=URL.createObjectURL(r),o&&URL.revokeObjectURL(o)}var c={},d=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}},f=d(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),p=d(function(){return document.head||document.getElementsByTagName("head")[0]}),m=null,v=0;t.exports=function(t,e){e=e||{},void 0===e.singleton&&(e.singleton=f());var n=r(t);return i(n,e),function(t){for(var o=[],a=0;a<n.length;a++){var s=n[a],l=c[s.id];l.refs--,o.push(l)}if(t){i(r(t),e)}for(var a=0;a<o.length;a++){var l=o[a];if(0===l.refs){for(var u=0;u<l.parts.length;u++)l.parts[u]();delete c[l.id]}}}};var g=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var a=n(7),s=i(a),l=n(9),u=i(l),h=function(t){function e(n,i,o){r(this,e),t.call(this,n,i);var a=this;this.__button=document.createElement("div"),this.__button.innerHTML=void 0===o?"Fire":o,u.default.bind(this.__button,"click",function(t){return t.preventDefault(),a.fire(),!1}),u.default.addClass(this.__button,"button"),this.domElement.appendChild(this.__button)}return o(e,t),e.prototype.fire=function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())},e}(s.default);e.default=h,t.exports=e.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e,n,i){t.style.background="",g.default.each(_,function(r){t.style.cssText+="background: "+r+"linear-gradient("+e+", "+n+" 0%, "+i+" 100%); "})}function s(t){t.style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}e.__esModule=!0;var l=n(7),u=i(l),h=n(9),c=i(h),d=n(2),f=i(d),p=n(3),m=i(p),v=n(5),g=i(v),y=function(t){function e(n,i){function o(t){d(t),c.default.bind(window,"mousemove",d),c.default.bind(window,"mouseup",l)}function l(){c.default.unbind(window,"mousemove",d),c.default.unbind(window,"mouseup",l)}function u(){var t=m.default(this.value);!1!==t?(v.__color.__state=t,v.setValue(v.__color.toOriginal())):this.value=v.__color.toString()}function h(){c.default.unbind(window,"mousemove",p),c.default.unbind(window,"mouseup",h)}function d(t){t.preventDefault();var e=c.default.getWidth(v.__saturation_field),n=c.default.getOffset(v.__saturation_field),i=(t.clientX-n.left+document.body.scrollLeft)/e,r=1-(t.clientY-n.top+document.body.scrollTop)/e;return r>1?r=1:r<0&&(r=0),i>1?i=1:i<0&&(i=0),v.__color.v=r,v.__color.s=i,v.setValue(v.__color.toOriginal()),!1}function p(t){t.preventDefault();var e=c.default.getHeight(v.__hue_field),n=c.default.getOffset(v.__hue_field),i=1-(t.clientY-n.top+document.body.scrollTop)/e;return i>1?i=1:i<0&&(i=0),v.__color.h=360*i,v.setValue(v.__color.toOriginal()),!1}r(this,e),t.call(this,n,i),this.__color=new f.default(this.getValue()),this.__temp=new f.default(0);var v=this;this.domElement=document.createElement("div"),c.default.makeSelectable(this.domElement,!1),this.__selector=document.createElement("div"),this.__selector.className="selector",this.__saturation_field=document.createElement("div"),this.__saturation_field.className="saturation-field",this.__field_knob=document.createElement("div"),this.__field_knob.className="field-knob",this.__field_knob_border="2px solid ",this.__hue_knob=document.createElement("div"),this.__hue_knob.className="hue-knob",this.__hue_field=document.createElement("div"),this.__hue_field.className="hue-field",this.__input=document.createElement("input"),this.__input.type="text",this.__input_textShadow="0 1px 1px ",c.default.bind(this.__input,"keydown",function(t){13===t.keyCode&&u.call(this)}),c.default.bind(this.__input,"blur",u),c.default.bind(this.__selector,"mousedown",function(){c.default.addClass(this,"drag").bind(window,"mouseup",function(){c.default.removeClass(v.__selector,"drag")})});var y=document.createElement("div");g.default.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),g.default.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),g.default.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),g.default.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),g.default.extend(y.style,{width:"100%",height:"100%",background:"none"}),a(y,"top","rgba(0,0,0,0)","#000"),g.default.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"}),s(this.__hue_field),g.default.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"}),c.default.bind(this.__saturation_field,"mousedown",o),c.default.bind(this.__field_knob,"mousedown",o),c.default.bind(this.__hue_field,"mousedown",function(t){p(t),c.default.bind(window,"mousemove",p),c.default.bind(window,"mouseup",h)}),this.__saturation_field.appendChild(y),this.__selector.appendChild(this.__field_knob),this.__selector.appendChild(this.__saturation_field),this.__selector.appendChild(this.__hue_field),this.__hue_field.appendChild(this.__hue_knob),this.domElement.appendChild(this.__input),this.domElement.appendChild(this.__selector),this.updateDisplay()}return o(e,t),e.prototype.updateDisplay=function(){var t=m.default(this.getValue());if(!1!==t){var e=!1;g.default.each(f.default.COMPONENTS,function(n){if(!g.default.isUndefined(t[n])&&!g.default.isUndefined(this.__color.__state[n])&&t[n]!==this.__color.__state[n])return e=!0,{}},this),e&&g.default.extend(this.__color.__state,t)}g.default.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var n=this.__color.v<.5||this.__color.s>.5?255:0,i=255-n;g.default.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+n+","+n+","+n+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,a(this.__saturation_field,"left","#fff",this.__temp.toString()),g.default.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+n+","+n+","+n+")",textShadow:this.__input_textShadow+"rgba("+i+","+i+","+i+",.7)"})},e}(u.default),_=["-moz-","-o-","-webkit-","-ms-",""];e.default=y,t.exports=e.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e,n){var i=document.createElement("li");return e&&i.appendChild(e),n?t.__ul.insertBefore(i,params.before):t.__ul.appendChild(i),t.onResize(),i}function o(t,e){var n=t.__preset_select[t.__preset_select.selectedIndex];n.innerHTML=e?n.value+"*":n.value}function a(t,e,n){if(n.__li=e,n.__gui=t,H.default.extend(n,{options:function(e){return arguments.length>1?(n.remove(),l(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[H.default.toArray(arguments)]})):H.default.isArray(e)||H.default.isObject(e)?(n.remove(),l(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[e]})):void 0},name:function(t){return n.__li.firstElementChild.firstElementChild.innerHTML=t,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof O.default)!function(){var t=new R.default(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});H.default.each(["updateDisplay","onChange","onFinishChange"],function(e){var i=n[e],r=t[e];n[e]=t[e]=function(){var e=Array.prototype.slice.call(arguments);return i.apply(n,e),r.apply(t,e)}}),V.default.addClass(e,"has-slider"),n.domElement.insertBefore(t.domElement,n.domElement.firstElementChild)}();else if(n instanceof R.default){var i=function(e){return H.default.isNumber(n.__min)&&H.default.isNumber(n.__max)?(n.remove(),l(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]})):e};n.min=H.default.compose(i,n.min),n.max=H.default.compose(i,n.max)}else n instanceof L.default?(V.default.bind(e,"click",function(){V.default.fakeEvent(n.__checkbox,"click")}),V.default.bind(n.__checkbox,"click",function(t){t.stopPropagation()})):n instanceof I.default?(V.default.bind(e,"click",function(){V.default.fakeEvent(n.__button,"click")}),V.default.bind(e,"mouseover",function(){V.default.addClass(n.__button,"hover")}),V.default.bind(e,"mouseout",function(){V.default.removeClass(n.__button,"hover")})):n instanceof F.default&&(V.default.addClass(e,"color"),n.updateDisplay=H.default.compose(function(t){return e.style.borderLeftColor=n.__color.toString(),t},n.updateDisplay),n.updateDisplay());n.setValue=H.default.compose(function(e){return t.getRoot().__preset_select&&n.isModified()&&o(t.getRoot(),!0),e},n.setValue)}function s(t,e){var n=t.getRoot(),i=n.__rememberedObjects.indexOf(e.object);if(-1!==i){var r=n.__rememberedObjectIndecesToControllers[i];if(void 0===r&&(r={},n.__rememberedObjectIndecesToControllers[i]=r),r[e.property]=e,n.load&&n.load.remembered){var o=n.load.remembered,a=void 0;if(o[t.preset])a=o[t.preset];else{if(!o[W])return;a=o[W]}if(a[i]&&void 0!==a[i][e.property]){var s=a[i][e.property];e.initialValue=s,e.setValue(s)}}}}function l(t,e,n,i){if(void 0===e[n])throw new Error('Object "'+e+'" has no property "'+n+'"');var o=void 0;if(i.color)o=new F.default(e,n);else{var l=[e,n].concat(i.factoryArgs);o=M.default.apply(t,l)}i.before instanceof T.default&&(i.before=i.before.__li),s(t,o),V.default.addClass(o.domElement,"c");var u=document.createElement("span");V.default.addClass(u,"property-name"),u.innerHTML=o.property;var h=document.createElement("div");h.appendChild(u),h.appendChild(o.domElement);var c=r(t,h,i.before);return V.default.addClass(c,$.CLASS_CONTROLLER_ROW),o instanceof F.default?V.default.addClass(c,"color"):V.default.addClass(c,typeof o.getValue()),a(t,c,o),t.__controllers.push(o),o}function u(t,e){return document.location.href+"."+e}function h(t,e,n){var i=document.createElement("option");i.innerHTML=e,i.value=e,t.__preset_select.appendChild(i),n&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function c(t,e){e.style.display=t.useLocalStorage?"block":"none"}function d(t){var e=t.__save_row=document.createElement("li");V.default.addClass(t.domElement,"has-save"),t.__ul.insertBefore(e,t.__ul.firstChild),V.default.addClass(e,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",V.default.addClass(n,"button gears");var i=document.createElement("span");i.innerHTML="Save",V.default.addClass(i,"button"),V.default.addClass(i,"save");var r=document.createElement("span");r.innerHTML="New",V.default.addClass(r,"button"),V.default.addClass(r,"save-as");var o=document.createElement("span");o.innerHTML="Revert",V.default.addClass(o,"button"),V.default.addClass(o,"revert");var a=t.__preset_select=document.createElement("select");t.load&&t.load.remembered?H.default.each(t.load.remembered,function(e,n){h(t,n,n===t.preset)}):h(t,W,!1),V.default.bind(a,"change",function(){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].innerHTML=t.__preset_select[e].value;t.preset=this.value}),e.appendChild(a),e.appendChild(n),e.appendChild(i),e.appendChild(r),e.appendChild(o),j&&function(){var e=document.getElementById("dg-local-explain"),n=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(u(t,"isLocal"))&&n.setAttribute("checked","checked"),c(t,e),V.default.bind(n,"change",function(){t.useLocalStorage=!t.useLocalStorage,c(t,e)})}();var s=document.getElementById("dg-new-constructor");V.default.bind(s,"keydown",function(t){!t.metaKey||67!==t.which&&67!==t.keyCode||q.hide()}),V.default.bind(n,"click",function(){s.innerHTML=JSON.stringify(t.getSaveObject(),void 0,2),q.show(),s.focus(),s.select()}),V.default.bind(i,"click",function(){t.save()}),V.default.bind(r,"click",function(){var e=prompt("Enter a new preset name.");e&&t.saveAs(e)}),V.default.bind(o,"click",function(){t.revert()})}function f(t){function e(e){return e.preventDefault(),t.width+=r-e.clientX,t.onResize(),r=e.clientX,!1}function n(){V.default.removeClass(t.__closeButton,$.CLASS_DRAG),V.default.unbind(window,"mousemove",e),V.default.unbind(window,"mouseup",n)}function i(i){return i.preventDefault(),r=i.clientX,V.default.addClass(t.__closeButton,$.CLASS_DRAG),V.default.bind(window,"mousemove",e),V.default.bind(window,"mouseup",n),!1}var r=void 0;t.__resize_handle=document.createElement("div"),H.default.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),V.default.bind(t.__resize_handle,"mousedown",i),V.default.bind(t.__closeButton,"mousedown",i),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}function p(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function m(t,e){var n={};return H.default.each(t.__rememberedObjects,function(i,r){var o={},a=t.__rememberedObjectIndecesToControllers[r];H.default.each(a,function(t,n){o[n]=e?t.initialValue:t.getValue()}),n[r]=o}),n}function v(t){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].value===t.preset&&(t.__preset_select.selectedIndex=e)}function g(t){0!==t.length&&z.default(function(){g(t)}),H.default.each(t,function(t){t.updateDisplay()})}var y=n(15),_=i(y),x=n(23),b=i(x),w=n(24),E=i(w),P=n(26),M=i(P),S=n(7),T=i(S),C=n(8),L=i(C),A=n(20),I=i(A),N=n(13),R=i(N),D=n(14),O=i(D),U=n(21),F=i(U),B=n(27),z=i(B),X=n(28),k=i(X),G=n(9),V=i(G),Y=n(5),H=i(Y);_.default.inject(E.default);var W="Default",j=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}}(),q=void 0,J=!0,Z=void 0,Q=!1,K=[],$=function t(e){var n=this,i=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),V.default.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],i=H.default.defaults(i,{autoPlace:!0,width:t.DEFAULT_WIDTH}),i=H.default.defaults(i,{resizable:i.autoPlace,hideable:i.autoPlace}),H.default.isUndefined(i.load)?i.load={preset:W}:i.preset&&(i.load.preset=i.preset),H.default.isUndefined(i.parent)&&i.hideable&&K.push(this),i.resizable=H.default.isUndefined(i.parent)&&i.resizable,i.autoPlace&&H.default.isUndefined(i.scrollable)&&(i.scrollable=!0);var o=j&&"true"===localStorage.getItem(u(this,"isLocal")),a=void 0;if(Object.defineProperties(this,{parent:{get:function(){return i.parent}},scrollable:{get:function(){return i.scrollable}},autoPlace:{get:function(){return i.autoPlace}},preset:{get:function(){return n.parent?n.getRoot().preset:i.load.preset},set:function(t){n.parent?n.getRoot().preset=t:i.load.preset=t,v(this),n.revert()}},width:{get:function(){return i.width},set:function(t){i.width=t,p(n,t)}},name:{get:function(){return i.name},set:function(t){i.name=t,titleRowName&&(titleRowName.innerHTML=i.name)}},closed:{get:function(){return i.closed},set:function(e){i.closed=e,i.closed?V.default.addClass(n.__ul,t.CLASS_CLOSED):V.default.removeClass(n.__ul,t.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=e?t.TEXT_OPEN:t.TEXT_CLOSED)}},load:{get:function(){return i.load}},useLocalStorage:{get:function(){return o},set:function(t){j&&(o=t,t?V.default.bind(window,"unload",a):V.default.unbind(window,"unload",a),localStorage.setItem(u(n,"isLocal"),t))}}}),H.default.isUndefined(i.parent)){if(i.closed=!1,V.default.addClass(this.domElement,t.CLASS_MAIN),V.default.makeSelectable(this.domElement,!1),j&&o){n.useLocalStorage=!0;var s=localStorage.getItem(u(this,"gui"));s&&(i.load=JSON.parse(s))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=t.TEXT_CLOSED,V.default.addClass(this.__closeButton,t.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),V.default.bind(this.__closeButton,"click",function(){n.closed=!n.closed})}else{void 0===i.closed&&(i.closed=!0);var l=document.createTextNode(i.name);V.default.addClass(l,"controller-name");var h=r(n,l),c=function(t){return t.preventDefault(),n.closed=!n.closed,!1};V.default.addClass(this.__ul,t.CLASS_CLOSED),V.default.addClass(h,"title"),V.default.bind(h,"click",c),i.closed||(this.closed=!1)}i.autoPlace&&(H.default.isUndefined(i.parent)&&(J&&(Z=document.createElement("div"),V.default.addClass(Z,"dg"),V.default.addClass(Z,t.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(Z),J=!1),Z.appendChild(this.domElement),V.default.addClass(this.domElement,t.CLASS_AUTO_PLACE)),this.parent||p(n,i.width)),V.default.bind(window,"resize",function(){n.onResize()}),V.default.bind(this.__ul,"webkitTransitionEnd",function(){n.onResize()}),V.default.bind(this.__ul,"transitionend",function(){n.onResize()}),V.default.bind(this.__ul,"oTransitionEnd",function(){n.onResize()}),this.onResize(),i.resizable&&f(this),a=function(){j&&"true"===localStorage.getItem(u(n,"isLocal"))&&localStorage.setItem(u(n,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=a,i.parent||function(){var t=n.getRoot();t.width+=1,H.default.defer(function(){t.width-=1})}()};$.toggleHide=function(){Q=!Q,H.default.each(K,function(t){t.domElement.style.zIndex=Q?-999:999,t.domElement.style.opacity=Q?0:1})},$.CLASS_AUTO_PLACE="a",$.CLASS_AUTO_PLACE_CONTAINER="ac",$.CLASS_MAIN="main",$.CLASS_CONTROLLER_ROW="cr",$.CLASS_TOO_TALL="taller-than-window",$.CLASS_CLOSED="closed",$.CLASS_CLOSE_BUTTON="close-button",$.CLASS_DRAG="drag",$.DEFAULT_WIDTH=245,$.TEXT_CLOSED="Close Controls",$.TEXT_OPEN="Open Controls",V.default.bind(window,"keydown",function(t){"text"===document.activeElement.type||72!==t.which&&72!==t.keyCode||$.toggleHide()},!1),H.default.extend($.prototype,{add:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t,e){return l(this,t,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})}),addColor:function(t,e){return l(this,t,e,{color:!0})},remove:function(t){this.__ul.removeChild(t.__li),this.__controllers.splice(this.__controllers.indexOf(t),1);var e=this;H.default.defer(function(){e.onResize()})},destroy:function(){this.autoPlace&&Z.removeChild(this.domElement)},addFolder:function(t){if(void 0!==this.__folders[t])throw new Error('You already have a folder in this GUI by the name "'+t+'"');var e={name:t,parent:this};e.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[t]&&(e.closed=this.load.folders[t].closed,e.load=this.load.folders[t]);var n=new $(e);this.__folders[t]=n;var i=r(this,n.domElement);return V.default.addClass(i,"folder"),n},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=V.default.getOffset(t.__ul).top,n=0;H.default.each(t.__ul.childNodes,function(e){t.autoPlace&&e===t.__save_row||(n+=V.default.getHeight(e))}),window.innerHeight-e-20<n?(V.default.addClass(t.domElement,$.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-e-20+"px"):(V.default.removeClass(t.domElement,$.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&H.default.defer(function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"}),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},remember:function(){if(H.default.isUndefined(q)&&(q=new k.default,q.domElement.innerHTML=b.default),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;H.default.each(Array.prototype.slice.call(arguments),function(e){0===t.__rememberedObjects.length&&d(t),-1===t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)}),this.autoPlace&&p(this,this.width)},getRoot:function(){for(var t=this;t.parent;)t=t.parent;return t},getSaveObject:function(){var t=this.load;return t.closed=this.closed,this.__rememberedObjects.length>0&&(t.preset=this.preset,t.remembered||(t.remembered={}),t.remembered[this.preset]=m(this)),t.folders={},H.default.each(this.__folders,function(e,n){t.folders[n]=e.getSaveObject()}),t},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=m(this),o(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(t){this.load.remembered||(this.load.remembered={},this.load.remembered[W]=m(this,!0)),this.load.remembered[t]=m(this),this.preset=t,h(this,t,!0),this.saveToLocalStorageIfPossible()},revert:function(t){H.default.each(this.__controllers,function(e){this.getRoot().load.remembered?s(t||this.getRoot(),e):e.setValue(e.initialValue)},this),H.default.each(this.__folders,function(t){t.revert(t)}),t||o(this.getRoot(),!1)},listen:function(t){var e=0===this.__listening.length;this.__listening.push(t),e&&g(this.__listening)}}),t.exports=$},function(t,e){t.exports='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'},function(t,e,n){var i=n(25);"string"==typeof i&&(i=[[t.id,i,""]]);n(19)(i,{});i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(18)(),e.push([t.id,".dg {\n  /** Clear list styles */\n  /* Auto-place container */\n  /* Auto-placed GUI's */\n  /* Line items that don't contain folders. */\n  /** Folder names */\n  /** Hides closed items */\n  /** Controller row */\n  /** Name-half (left) */\n  /** Controller-half (right) */\n  /** Controller placement */\n  /** Shorter number boxes when slider is present. */\n  /** Ensure the entire boolean and function row shows a hand */ }\n  .dg ul {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n    width: 100%;\n    clear: both; }\n  .dg.ac {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 0;\n    z-index: 0; }\n  .dg:not(.ac) .main {\n    /** Exclude mains in ac so that we don't hide close button */\n    overflow: hidden; }\n  .dg.main {\n    -webkit-transition: opacity 0.1s linear;\n    -o-transition: opacity 0.1s linear;\n    -moz-transition: opacity 0.1s linear;\n    transition: opacity 0.1s linear; }\n    .dg.main.taller-than-window {\n      overflow-y: auto; }\n      .dg.main.taller-than-window .close-button {\n        opacity: 1;\n        /* TODO, these are style notes */\n        margin-top: -1px;\n        border-top: 1px solid #2c2c2c; }\n    .dg.main ul.closed .close-button {\n      opacity: 1 !important; }\n    .dg.main:hover .close-button,\n    .dg.main .close-button.drag {\n      opacity: 1; }\n    .dg.main .close-button {\n      /*opacity: 0;*/\n      -webkit-transition: opacity 0.1s linear;\n      -o-transition: opacity 0.1s linear;\n      -moz-transition: opacity 0.1s linear;\n      transition: opacity 0.1s linear;\n      border: 0;\n      position: absolute;\n      line-height: 19px;\n      height: 20px;\n      /* TODO, these are style notes */\n      cursor: pointer;\n      text-align: center;\n      background-color: #000; }\n      .dg.main .close-button:hover {\n        background-color: #111; }\n  .dg.a {\n    float: right;\n    margin-right: 15px;\n    overflow-x: hidden; }\n    .dg.a.has-save > ul {\n      margin-top: 27px; }\n      .dg.a.has-save > ul.closed {\n        margin-top: 0; }\n    .dg.a .save-row {\n      position: fixed;\n      top: 0;\n      z-index: 1002; }\n  .dg li {\n    -webkit-transition: height 0.1s ease-out;\n    -o-transition: height 0.1s ease-out;\n    -moz-transition: height 0.1s ease-out;\n    transition: height 0.1s ease-out; }\n  .dg li:not(.folder) {\n    cursor: auto;\n    height: 27px;\n    line-height: 27px;\n    overflow: hidden;\n    padding: 0 4px 0 5px; }\n  .dg li.folder {\n    padding: 0;\n    border-left: 4px solid transparent; }\n  .dg li.title {\n    cursor: pointer;\n    margin-left: -4px; }\n  .dg .closed li:not(.title),\n  .dg .closed ul li,\n  .dg .closed ul li > * {\n    height: 0;\n    overflow: hidden;\n    border: 0; }\n  .dg .cr {\n    clear: both;\n    padding-left: 3px;\n    height: 27px; }\n  .dg .property-name {\n    cursor: default;\n    float: left;\n    clear: left;\n    width: 40%;\n    overflow: hidden;\n    text-overflow: ellipsis; }\n  .dg .c {\n    float: left;\n    width: 60%; }\n  .dg .c input[type=text] {\n    border: 0;\n    margin-top: 4px;\n    padding: 3px;\n    width: 100%;\n    float: right; }\n  .dg .has-slider input[type=text] {\n    width: 30%;\n    /*display: none;*/\n    margin-left: 0; }\n  .dg .slider {\n    float: left;\n    width: 66%;\n    margin-left: -5px;\n    margin-right: 0;\n    height: 19px;\n    margin-top: 4px; }\n  .dg .slider-fg {\n    height: 100%; }\n  .dg .c input[type=checkbox] {\n    margin-top: 9px; }\n  .dg .c select {\n    margin-top: 5px; }\n  .dg .cr.function,\n  .dg .cr.function .property-name, .dg .cr.function *,\n  .dg .cr.boolean,\n  .dg .cr.boolean * {\n    cursor: pointer; }\n  .dg .selector {\n    display: none;\n    position: absolute;\n    margin-left: -9px;\n    margin-top: 23px;\n    z-index: 10; }\n  .dg .c:hover .selector,\n  .dg .selector.drag {\n    display: block; }\n  .dg li.save-row {\n    padding: 0; }\n    .dg li.save-row .button {\n      display: inline-block;\n      padding: 0px 6px; }\n  .dg.dialogue {\n    background-color: #222;\n    width: 460px;\n    padding: 15px;\n    font-size: 13px;\n    line-height: 15px; }\n\n/* TODO Separate style and structure */\n#dg-new-constructor {\n  padding: 10px;\n  color: #222;\n  font-family: Monaco, monospace;\n  font-size: 10px;\n  border: 0;\n  resize: none;\n  box-shadow: inset 1px 1px 1px #888;\n  word-wrap: break-word;\n  margin: 12px 0;\n  display: block;\n  width: 440px;\n  overflow-y: scroll;\n  height: 100px;\n  position: relative; }\n\n#dg-local-explain {\n  display: none;\n  font-size: 11px;\n  line-height: 17px;\n  border-radius: 3px;\n  background-color: #333;\n  padding: 8px;\n  margin-top: 10px; }\n  #dg-local-explain code {\n    font-size: 10px; }\n\n#dat-gui-save-locally {\n  display: none; }\n\n/** Main type */\n.dg {\n  color: #eee;\n  font: 11px 'Lucida Grande', sans-serif;\n  text-shadow: 0 -1px 0 #111;\n  /** Auto place */\n  /* Controller row, <li> */\n  /** Controllers */ }\n  .dg.main {\n    /** Scrollbar */ }\n    .dg.main::-webkit-scrollbar {\n      width: 5px;\n      background: #1a1a1a; }\n    .dg.main::-webkit-scrollbar-corner {\n      height: 0;\n      display: none; }\n    .dg.main::-webkit-scrollbar-thumb {\n      border-radius: 5px;\n      background: #676767; }\n  .dg li:not(.folder) {\n    background: #1a1a1a;\n    border-bottom: 1px solid #2c2c2c; }\n  .dg li.save-row {\n    line-height: 25px;\n    background: #dad5cb;\n    border: 0; }\n    .dg li.save-row select {\n      margin-left: 5px;\n      width: 108px; }\n    .dg li.save-row .button {\n      margin-left: 5px;\n      margin-top: 1px;\n      border-radius: 2px;\n      font-size: 9px;\n      line-height: 7px;\n      padding: 4px 4px 5px 4px;\n      background: #c5bdad;\n      color: #fff;\n      text-shadow: 0 1px 0 #b0a58f;\n      box-shadow: 0 -1px 0 #b0a58f;\n      cursor: pointer; }\n      .dg li.save-row .button.gears {\n        background: #c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;\n        height: 7px;\n        width: 8px; }\n      .dg li.save-row .button:hover {\n        background-color: #bab19e;\n        box-shadow: 0 -1px 0 #b0a58f; }\n  .dg li.folder {\n    border-bottom: 0; }\n  .dg li.title {\n    padding-left: 16px;\n    background: #000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;\n    cursor: pointer;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.2); }\n  .dg .closed li.title {\n    background-image: url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==); }\n  .dg .cr.boolean {\n    border-left: 3px solid #806787; }\n  .dg .cr.color {\n    border-left: 3px solid; }\n  .dg .cr.function {\n    border-left: 3px solid #e61d5f; }\n  .dg .cr.number {\n    border-left: 3px solid #2FA1D6; }\n    .dg .cr.number input[type=text] {\n      color: #2FA1D6; }\n  .dg .cr.string {\n    border-left: 3px solid #1ed36f; }\n    .dg .cr.string input[type=text] {\n      color: #1ed36f; }\n  .dg .cr.function:hover,\n  .dg .cr.boolean:hover {\n    background: #111; }\n  .dg .c input[type=text] {\n    background: #303030;\n    outline: none; }\n    .dg .c input[type=text]:hover {\n      background: #3c3c3c; }\n    .dg .c input[type=text]:focus {\n      background: #494949;\n      color: #fff; }\n  .dg .c .slider {\n    background: #303030;\n    cursor: ew-resize; }\n  .dg .c .slider-fg {\n    background: #2FA1D6; }\n  .dg .c .slider:hover {\n    background: #3c3c3c; }\n    .dg .c .slider:hover .slider-fg {\n      background: #44abda; }\n",""])},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(10),o=i(r),a=n(13),s=i(a),l=n(14),u=i(l),h=n(11),c=i(h),d=n(20),f=i(d),p=n(8),m=i(p),v=n(5),g=i(v),y=function(t,e){var n=t[e];return g.default.isArray(arguments[2])||g.default.isObject(arguments[2])?new o.default(t,e,arguments[2]):g.default.isNumber(n)?g.default.isNumber(arguments[2])&&g.default.isNumber(arguments[3])?g.default.isNumber(arguments[4])?new u.default(t,e,arguments[2],arguments[3],arguments[4]):new u.default(t,e,arguments[2],arguments[3]):new s.default(t,e,{min:arguments[2],max:arguments[3]}):g.default.isString(n)?new c.default(t,e):g.default.isFunction(n)?new f.default(t,e,""):g.default.isBoolean(n)?new m.default(t,e):void 0};e.default=y,t.exports=e.default},function(t,e){"use strict";e.__esModule=!0,e.default=function(){function t(t){window.setTimeout(t,1e3/60)}return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||t},t.exports=e.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var o=n(9),a=i(o),s=n(5),l=i(s),u=function(){function t(){r(this,t),this.backgroundElement=document.createElement("div"),l.default.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),a.default.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),l.default.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;a.default.bind(this.backgroundElement,"click",function(){e.hide()})}return t.prototype.show=function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),l.default.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})},t.prototype.hide=function(){var t=this,e=function e(){t.domElement.style.display="none",t.backgroundElement.style.display="none",a.default.unbind(t.domElement,"webkitTransitionEnd",e),a.default.unbind(t.domElement,"transitionend",e),a.default.unbind(t.domElement,"oTransitionEnd",e)};a.default.bind(this.domElement,"webkitTransitionEnd",e),a.default.bind(this.domElement,"transitionend",e),a.default.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},t.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-a.default.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-a.default.getHeight(this.domElement)/2+"px"},t}();e.default=u,t.exports=e.default}])})},function(t,e,n){function i(t){return null==t?void 0===t?l:s:u&&u in Object(t)?o(t):a(t)}var r=n(22),o=n(55),a=n(56),s="[object Null]",l="[object Undefined]",u=r?r.toStringTag:void 0;t.exports=i},function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(e,n(213))},function(t,e,n){function i(t){var e=a.call(t,l),n=t[l];try{t[l]=void 0;var i=!0}catch(t){}var r=s.call(t);return i&&(e?t[l]=n:delete t[l]),r}var r=n(22),o=Object.prototype,a=o.hasOwnProperty,s=o.toString,l=r?r.toStringTag:void 0;t.exports=i},function(t,e){function n(t){return r.call(t)}var i=Object.prototype,r=i.toString;t.exports=n},function(t,e,n){function i(t,e,n){function i(e){var n=y,i=_;return y=_=void 0,P=e,b=t.apply(i,n)}function h(t){return P=t,w=setTimeout(f,e),M?i(t):b}function c(t){var n=t-E,i=t-P,r=e-n;return S?u(r,x-i):r}function d(t){var n=t-E,i=t-P;return void 0===E||n>=e||n<0||S&&i>=x}function f(){var t=o();if(d(t))return p(t);w=setTimeout(f,c(t))}function p(t){return w=void 0,T&&y?i(t):(y=_=void 0,b)}function m(){void 0!==w&&clearTimeout(w),P=0,y=E=_=w=void 0}function v(){return void 0===w?b:p(o())}function g(){var t=o(),n=d(t);if(y=arguments,_=this,E=t,n){if(void 0===w)return h(E);if(S)return w=setTimeout(f,e),i(E)}return void 0===w&&(w=setTimeout(f,e)),b}var y,_,x,b,w,E,P=0,M=!1,S=!1,T=!0;if("function"!=typeof t)throw new TypeError(s);return e=a(e)||0,r(n)&&(M=!!n.leading,S="maxWait"in n,x=S?l(a(n.maxWait)||0,e):x,T="trailing"in n?!!n.trailing:T),g.cancel=m,g.flush=v,g}var r=n(24),o=n(60),a=n(61),s="Expected a function",l=Math.max,u=Math.min;t.exports=i},function(t,e){function n(t){return null!=t&&"object"==typeof t}t.exports=n},function(t,e,n){function i(t){return"symbol"==typeof t||o(t)&&r(t)==a}var r=n(53),o=n(58),a="[object Symbol]";t.exports=i},function(t,e,n){var i=n(23),r=function(){return i.Date.now()};t.exports=r},function(t,e,n){function i(t){if("number"==typeof t)return t;if(o(t))return a;if(r(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=r(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(s,"");var n=u.test(t);return n||h.test(t)?c(t.slice(2),n?2:8):l.test(t)?a:+t}var r=n(24),o=n(59),a=NaN,s=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,h=/^0o[0-7]+$/i,c=parseInt;t.exports=i},function(t,e){t.exports="#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n"},function(t,e){t.exports="#ifdef ALPHATEST\n\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_AOMAP\n\n\t// reads channel R, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\n\t#endif\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_AOMAP\n\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n\n#endif"},function(t,e){t.exports="\nvec3 transformed = vec3( position );\n"},function(t,e){t.exports="\nvec3 objectNormal = vec3( normal );\n"},function(t,e){t.exports='float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\n\tif( decayExponent > 0.0 ) {\n\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\n\t\t// based upon Frostbite 3 Moving to Physically-based Rendering\n\t\t// page 32, equation 26: E[window1]\n\t\t// http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr_v2.pdf\n\t\t// this is intended to be used on spot and point lights who are represented as luminous intensity\n\t\t// but who must be converted to luminous irradiance for surface lighting calculation\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n\n#else\n\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\n#endif\n\n\t}\n\n\treturn 1.0;\n\n}\n\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\n\treturn RECIPROCAL_PI * diffuseColor;\n\n} // validated\n\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\n\t// Original approximation by Christophe Schlick \'94\n\t// float fresnel = pow( 1.0 - dotLH, 5.0 );\n\n\t// Optimized variant (presented by Epic at SIGGRAPH \'13)\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n\n} // validated\n\n// Microfacet Models for Refraction through Rough Surfaces - equation (34)\n// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html\n// alpha is "roughness squared" in Disney’s reparameterization\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\n\t// geometry term = G(l)⋅G(v) / 4(n⋅l)(n⋅v)\n\n\tfloat a2 = pow2( alpha );\n\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\n\treturn 1.0 / ( gl * gv );\n\n} // validated\n\n// Moving Frostbite to Physically Based Rendering 2.0 - page 12, listing 2\n// http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr_v2.pdf\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\n\tfloat a2 = pow2( alpha );\n\n\t// dotNL and dotNV are explicitly swapped. This is not a mistake.\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\n\n// Microfacet Models for Refraction through Rough Surfaces - equation (33)\n// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html\n// alpha is "roughness squared" in Disney’s reparameterization\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\n\tfloat a2 = pow2( alpha );\n\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; // avoid alpha = 0 with dotNH = 1\n\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n\n}\n\n// GGX Distribution, Schlick Fresnel, GGX-Smith Visibility\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\n\tfloat alpha = pow2( roughness ); // UE4\'s roughness\n\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\n\tfloat D = D_GGX( alpha, dotNH );\n\n\treturn F * ( G * D );\n\n} // validated\n\n// Rect Area Light\n\n// Area light computation code adapted from:\n// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines\n// By: Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt\n// https://drive.google.com/file/d/0BzvWIdpUpRx_d09ndGVjNVJzZjA/view\n// https://eheitzresearch.wordpress.com/415-2/\n// http://blog.selfshadow.com/sandbox/ltc.html\n\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\n\tfloat theta = acos( dot( N, V ) );\n\n\t// Parameterization of texture:\n\t// sqrt(roughness) -> [0,1]\n\t// theta -> [0, PI/2]\n\tvec2 uv = vec2(\n\t\tsqrt( saturate( roughness ) ),\n\t\tsaturate( theta / ( 0.5 * PI ) ) );\n\n\t// Ensure we don\'t have nonlinearities at the look-up table\'s edges\n\t// see: http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter24.html\n\t//      "Shader Analysis" section\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\n\treturn uv;\n\n}\n\n// Real-Time Area Lighting: a Journey from Research to Production\n// By: Stephen Hill & Eric Heitz\n// http://advances.realtimerendering.com/s2016/s2016_ltc_rnd.pdf\n// An approximation for the form factor of a clipped rectangle.\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\n\tfloat l = length( f );\n\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n\n}\n\n// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines\n// also Real-Time Area Lighting: a Journey from Research to Production\n// http://advances.realtimerendering.com/s2016/s2016_ltc_rnd.pdf\n// Normalization by 2*PI is incorporated in this function itself.\n// theta/sin(theta) is approximated by rational polynomial\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\n\tfloat x = dot( v1, v2 );\n\n\tfloat y = abs( x );\n\tfloat a = 0.86267 + (0.49788 + 0.01436 * y ) * y;\n\tfloat b = 3.45068 + (4.18814 + y) * y;\n\tfloat v = a / b;\n\n\tfloat theta_sintheta = (x > 0.0) ? v : 0.5 * inversesqrt( 1.0 - x * x ) - v;\n\n\treturn cross( v1, v2 ) * theta_sintheta;\n\n}\n\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\n\t// bail if point is on back side of plane of light\n\t// assumes ccw winding order of light vertices\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\n\t// construct orthonormal basis around N\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 ); // negated from paper; possibly due to a different assumed handedness of world coordinate system\n\n\t// compute transform\n\tmat3 mat = mInv * transpose( mat3( T1, T2, N ) );\n\n\t// transform rect\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\n\t// project rect onto sphere\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\n\t// calculate vector form factor\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\n\t// adjust for horizon clipping\n\tvec3 result = vec3( LTC_ClippedSphereFormFactor( vectorFormFactor ) );\n\n\treturn result;\n\n}\n\n// End Rect Area Light\n\n// ref: https://www.unrealengine.com/blog/physically-based-shading-on-mobile - environmentBRDF for GGX on mobile\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\n\tvec4 r = roughness * c0 + c1;\n\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\n\treturn specularColor * AB.x + AB.y;\n\n} // validated\n\n\nfloat G_BlinnPhong_Implicit( /* const in float dotNL, const in float dotNV */ ) {\n\n\t// geometry term is (n dot l)(n dot v) / 4(n dot l)(n dot v)\n\treturn 0.25;\n\n}\n\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n\n}\n\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\n\t//float dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\t//float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\n\tfloat G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );\n\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\n\treturn F * ( G * D );\n\n} // validated\n\n// source: http://simonstechblog.blogspot.ca/2011/12/microfacet-brdf.html\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\n\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n'},function(t,e){t.exports="#ifdef USE_BUMPMAP\n\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\n\t// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\n\t// http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\n\n\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n\tvec2 dHdxy_fwd() {\n\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n\t\treturn vec2( dBx, dBy );\n\n\t}\n\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\t\t// normalized\n\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\n\t}\n\n#endif\n"},function(t,e){t.exports="#if NUM_CLIPPING_PLANES > 0\n\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\n\t}\n\t\t\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\n\t\tbool clipped = true;\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\t\tvec4 plane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\n\t\tif ( clipped ) discard;\n\t\n\t#endif\n\n#endif\n"},function(t,e){t.exports="#if NUM_CLIPPING_PLANES > 0\n\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n\n#endif\n"},function(t,e){t.exports="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n"},function(t,e){t.exports="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n\n"},function(t,e){t.exports="#ifdef USE_COLOR\n\n\tdiffuseColor.rgb *= vColor;\n\n#endif"},function(t,e){t.exports="#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif"},function(t,e){t.exports="#ifdef USE_COLOR\n\n\tvColor.xyz = color.xyz;\n\n#endif"},function(t,e){t.exports="#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\n\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\n// expects values in the range of [0,1]x[0,1], returns values in the [0,1] range.\n// do not collapse into a single function per: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\n\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\n\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n}\n\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n\n}\n\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\n\treturn - distance * planeNormal + point;\n\n}\n\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n\n}\n\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n\n}\n\nmat3 transpose( const in mat3 v ) {\n\n\tmat3 tmp;\n\ttmp[0] = vec3(v[0].x, v[1].x, v[2].x);\n\ttmp[1] = vec3(v[0].y, v[1].y, v[2].y);\n\ttmp[2] = vec3(v[0].z, v[1].z, v[2].z);\n\n\treturn tmp;\n\n}\n"},function(t,e){t.exports="#ifdef ENVMAP_TYPE_CUBE_UV\n\n#define cubeUV_textureSize (1024.0)\n\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\n\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\t// Clamp the value to the max mip level counts. hard coded to 6 mips\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\n\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\t// float powScale = exp2(roughnessLevel + mipLevel);\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\t// float scale =  1.0 / exp2(roughnessLevel + 2.0 + mipLevel);\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\t// float mipOffset = 0.75*(1.0 - 1.0/exp2(mipLevel))/exp2(roughnessLevel);\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\n\tfloat rcpPowScale = 1.0 / powScale;\n\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\n\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\n\t// round to nearest mipmap if we are not interpolating.\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\n\t// Tri linear interpolation.\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\n\tvec4 result = mix(color10, color20, t);\n\n\treturn vec4(result.rgb, 1.0);\n}\n\n#endif\n"},function(t,e){t.exports="#ifdef FLIP_SIDED\n\n\tobjectNormal = -objectNormal;\n\n#endif\n\nvec3 transformedNormal = normalMatrix * objectNormal;\n"},function(t,e){t.exports="#ifdef USE_DISPLACEMENTMAP\n\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_DISPLACEMENTMAP\n\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n\n#endif\n"},function(t,e){t.exports="#if defined( DITHERING )\n\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n\n#endif\n"},function(t,e){t.exports="#if defined( DITHERING )\n\n\t// based on https://www.shadertoy.com/view/MslGR8\n\tvec3 dithering( vec3 color ) {\n\t\t//Calculate grid position\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\n\t\t//Shift the individual colors differently, thus making it even harder to see the dithering pattern\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\n\t\t//modify shift acording to grid position.\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\n\t\t//shift the color by dither_shift\n\t\treturn color + dither_shift_RGB;\n\t}\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_EMISSIVEMAP\n\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_EMISSIVEMAP\n\n\tuniform sampler2D emissiveMap;\n\n#endif\n"},function(t,e){t.exports="  gl_FragColor = linearToOutputTexel( gl_FragColor );\n"},function(t,e){t.exports="// For a discussion of what this is, please read this: http://lousodrome.net/blog/light/2013/05/26/gamma-correct-and-hdr-rendering-in-a-32-bits-buffer/\n\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\n\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\n\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\n\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n//  return vec4( value.brg, ( 3.0 + 128.0 ) / 256.0 );\n}\n\n// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\n\n// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\n\n// LogLuv reference: http://graphicrants.blogspot.ca/2009/04/rgbm-color-encoding.html\n\n// M matrix, for encoding\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\n\n// Inverse M matrix, for decoding\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n"},function(t,e){t.exports="#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n\t\t// Transforming Normal Vectors with the Inverse Transformation\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#else\n\n\t\tvec3 reflectVec = vReflect;\n\n\t#endif\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\n\t\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\n\t#else\n\n\t\tvec4 envColor = vec4( 0.0 );\n\n\t#endif\n\n\tenvColor = envMapTexelToLinear( envColor );\n\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n\t#endif\n\n#endif\n"},function(t,e){t.exports="#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n\n#ifdef USE_ENVMAP\n\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\n\t#else\n\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\n\t#endif\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tvWorldPosition = worldPosition.xyz;\n\n\t#else\n\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\n\t\t#else\n\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#endif\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_FOG\n\n\t#ifdef FOG_EXP2\n\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\n\t#else\n\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\n\t#endif\n\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_FOG\n\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\n\t#ifdef FOG_EXP2\n\n\t\tuniform float fogDensity;\n\n\t#else\n\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\n\t#endif\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_FOG\n\n  varying float fogDepth;\n\n#endif\n"},function(t,e){t.exports="\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif"},function(t,e){t.exports="#ifdef TOON\n\n\tuniform sampler2D gradientMap;\n\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\n\t\t// dotNL will be from -1.0 to 1.0\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\n\t\t#ifdef USE_GRADIENTMAP\n\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\n\t\t#else\n\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\n\t\t#endif\n\n\n\t}\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_LIGHTMAP\n\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity; // factor of PI should not be present; included here to prevent breakage\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_LIGHTMAP\n\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n\n#endif"},function(t,e){t.exports="vec3 diffuse = vec3( 1.0 );\n\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\n\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\n\nvLightFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\n\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n\n#if NUM_POINT_LIGHTS > 0\n\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if NUM_SPOT_LIGHTS > 0\n\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\t}\n\n#endif\n\n/*\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\n\t\t// TODO (abelnation): implement\n\n\t}\n\n#endif\n*/\n\n#if NUM_DIR_LIGHTS > 0\n\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if NUM_HEMI_LIGHTS > 0\n\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\n\t\t#endif\n\n\t}\n\n#endif\n"},function(t,e){t.exports="uniform vec3 ambientLightColor;\n\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\n\tvec3 irradiance = ambientLightColor;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI;\n\n\t#endif\n\n\treturn irradiance;\n\n}\n\n#if NUM_DIR_LIGHTS > 0\n\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\n\t}\n\n#endif\n\n\n#if NUM_POINT_LIGHTS > 0\n\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\n\t// directLight is an out parameter as having it as a return value caused compiler errors on some devices\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\n\t\tfloat lightDistance = length( lVector );\n\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\n\t}\n\n#endif\n\n\n#if NUM_SPOT_LIGHTS > 0\n\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\n\t// directLight is an out parameter as having it as a return value caused compiler errors on some devices\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\n\t\tif ( angleCos > spotLight.coneCos ) {\n\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\n\t\t} else {\n\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\n\t\t}\n\t}\n\n#endif\n\n\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\n\t// Pre-computed values of LinearTransformedCosine approximation of BRDF\n\t// BRDF approximation Texture is 64x64\n\tuniform sampler2D ltcMat; // RGBA Float\n\tuniform sampler2D ltcMag; // Alpha Float (only has w component)\n\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n\n#endif\n\n\n#if NUM_HEMI_LIGHTS > 0\n\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tirradiance *= PI;\n\n\t\t#endif\n\n\t\treturn irradiance;\n\n\t}\n\n#endif\n\n\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\n\tvec3 getLightProbeIndirectIrradiance( /*const in SpecularLightProbe specularLightProbe,*/ const in GeometricContext geometry, const in int maxMIPLevel ) {\n\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\n\t\t\t// TODO: replace with properly filtered cubemaps and access the irradiance LOD level, be it the last LOD level\n\t\t\t// of a specular cubemap, or just the default level of a specially created irradiance cubemap.\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\n\t\t\t#else\n\n\t\t\t\t// force the bias high to get the last LOD level as it is the most blurred.\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\n\t\t#else\n\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\n\t\t#endif\n\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\n\t}\n\n\t// taken from here: http://casual-effects.blogspot.ca/2011/08/plausible-environment-lighting-in-two.html\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\n\t\t//float envMapWidth = pow( 2.0, maxMIPLevelScalar );\n\t\t//float desiredMIPLevel = log2( envMapWidth * sqrt( 3.0 ) ) - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\n\t\t// clamp to allowable LOD ranges.\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\n\t}\n\n\tvec3 getLightProbeIndirectRadiance( /*const in SpecularLightProbe specularLightProbe,*/ const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\n\t\t#endif\n\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\n\t\t\t#else\n\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\n\t\t\t#else\n\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\n\t\t\t#else\n\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#endif\n\n\t\treturn envMapColor.rgb * envMapIntensity;\n\n\t}\n\n#endif\n"},function(t,e){t.exports="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n"},function(t,e){t.exports="varying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n\nstruct BlinnPhongMaterial {\n\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n\n};\n\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tvoid RE_Direct_RectArea_BlinnPhong( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = BlinnExponentToGGXRoughness( material.specularShininess );\n\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight; // counterclockwise\n\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\n\t\tfloat norm = texture2D( ltcMag, uv ).a;\n\n\t\tvec4 t = texture2D( ltcMat, uv );\n\n\t\tmat3 mInv = mat3(\n\t\t\tvec3(   1,   0, t.y ),\n\t\t\tvec3(   0, t.z,   0 ),\n\t\t\tvec3( t.w,   0, t.x )\n\t\t);\n\n\t\treflectedLight.directSpecular += lightColor * material.specularColor * norm * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords ); // no fresnel\n\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1 ), rectCoords );\n\n\t}\n\n#endif\n\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\t#ifdef TOON\n\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\n\t#else\n\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\n\t#endif\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI; // punctual light\n\n\t#endif\n\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n\n}\n\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n\n#define Material_LightProbeLOD( material )\t(0)\n"},function(t,e){t.exports="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat ); // Burley clearcoat model\n\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n"},function(t,e){t.exports="struct PhysicalMaterial {\n\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n\n};\n\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\n\n// Clear coat directional hemishperical reflectance (this approximation should be improved)\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n\n}\n\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight; // counterclockwise\n\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\n\t\tfloat norm = texture2D( ltcMag, uv ).a;\n\n\t\tvec4 t = texture2D( ltcMat, uv );\n\n\t\tmat3 mInv = mat3(\n\t\t\tvec3(   1,   0, t.y ),\n\t\t\tvec3(   0, t.z,   0 ),\n\t\t\tvec3( t.w,   0, t.x )\n\t\t);\n\n\t\treflectedLight.directSpecular += lightColor * material.specularColor * norm * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords ); // no fresnel\n\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1 ), rectCoords );\n\n\t}\n\n#endif\n\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\n\tvec3 irradiance = dotNL * directLight.color;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI; // punctual light\n\n\t#endif\n\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n\t#ifndef STANDARD\n\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\n\t#endif\n\n}\n\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\n\t#ifndef STANDARD\n\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\n\t#endif\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\n\n// ref: http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr_v2.pdf\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n\n}\n"},function(t,e){t.exports="/**\n * This is a template that can be used to light a material, it uses pluggable\n * RenderEquations (RE)for specific lighting scenarios.\n *\n * Instructions for use:\n * - Ensure that both RE_Direct, RE_IndirectDiffuse and RE_IndirectSpecular are defined\n * - If you have defined an RE_IndirectSpecular, you need to also provide a Material_LightProbeLOD. <---- ???\n * - Create a material parameter that is to be passed as the third parameter to your lighting functions.\n *\n * TODO:\n * - Add area light support.\n * - Add sphere light support.\n * - Add diffuse light probe (irradiance cubemap) support.\n */\n\nGeometricContext geometry;\n\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\n\nIncidentLight directLight;\n\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tPointLight pointLight;\n\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tpointLight = pointLights[ i ];\n\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\n#endif\n\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tSpotLight spotLight;\n\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tspotLight = spotLights[ i ];\n\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\n#endif\n\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tDirectionalLight directionalLight;\n\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tdirectionalLight = directionalLights[ i ];\n\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\n#endif\n\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\n\tRectAreaLight rectAreaLight;\n\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\n\t}\n\n#endif\n\n#if defined( RE_IndirectDiffuse )\n\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\n\t#ifdef USE_LIGHTMAP\n\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tlightMapIrradiance *= PI; // factor of PI should not be present; included here to prevent breakage\n\n\t\t#endif\n\n\t\tirradiance += lightMapIrradiance;\n\n\t#endif\n\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\n\t\t}\n\n\t#endif\n\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\t// TODO, replace 8 with the real maxMIPLevel\n\t\tirradiance += getLightProbeIndirectIrradiance( /*lightProbe,*/ geometry, 8 );\n\n\t#endif\n\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n\n#endif\n\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\n\t// TODO, replace 8 with the real maxMIPLevel\n\tvec3 radiance = getLightProbeIndirectRadiance( /*specularLightProbe,*/ geometry, Material_BlinnShininessExponent( material ), 8 );\n\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( /*specularLightProbe,*/ geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n\n#endif\n"},function(t,e){t.exports="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n\n#endif"},function(t,e){t.exports="#ifdef USE_LOGDEPTHBUF\n\n\tuniform float logDepthBufFC;\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\n\t#endif\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\n\t#endif\n\n\tuniform float logDepthBufFC;\n\n#endif"},function(t,e){t.exports="#ifdef USE_LOGDEPTHBUF\n\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\n\t#else\n\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\n\t#endif\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_MAP\n\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_MAP\n\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n\n#endif\n"},function(t,e){t.exports="float metalnessFactor = metalness;\n\n#ifdef USE_METALNESSMAP\n\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\n\t// reads channel B, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\tmetalnessFactor *= texelMetalness.b;\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_METALNESSMAP\n\n\tuniform sampler2D metalnessMap;\n\n#endif"},function(t,e){t.exports="#ifdef USE_MORPHNORMALS\n\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_MORPHTARGETS\n\n\t#ifndef USE_MORPHNORMALS\n\n\tuniform float morphTargetInfluences[ 8 ];\n\n\t#else\n\n\tuniform float morphTargetInfluences[ 4 ];\n\n\t#endif\n\n#endif"},function(t,e){t.exports="#ifdef USE_MORPHTARGETS\n\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n\t#ifndef USE_MORPHNORMALS\n\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n\t#endif\n\n#endif\n"},function(t,e){t.exports="#ifdef DOUBLE_SIDED\n\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n#else\n\tfloat flipNormal = 1.0;\n#endif\n"},function(t,e){t.exports="#ifdef FLAT_SHADED\n\n\t// Workaround for Adreno/Nexus5 not able able to do dFdx( vViewPosition ) ...\n\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n\n#else\n\n\tvec3 normal = normalize( vNormal ) * flipNormal;\n\n#endif\n\n#ifdef USE_NORMALMAP\n\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\n#elif defined( USE_BUMPMAP )\n\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_NORMALMAP\n\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\n\t// Per-Pixel Tangent Space Normal Mapping\n\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\n\t}\n\n#endif\n"},function(t,e){t.exports="vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\n\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 1.0 - 2.0 * rgb.xyz;\n}\n\nconst float PackUpscale = 256. / 255.; // fraction -> 0..1 (including 1)\nconst float UnpackDownscale = 255. / 256.; // 0..1 -> fraction (excluding 1)\n\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\n\nconst float ShiftRight8 = 1. / 256.;\n\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8; // tidy overflow\n\treturn r * PackUpscale;\n}\n\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\n\n// NOTE: viewZ/eyeZ is < 0 when in front of the camera per OpenGL conventions\n\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\n\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n"},function(t,e){t.exports="#ifdef PREMULTIPLIED_ALPHA\n\n\t// Get get normal blending with premultipled, use with CustomBlending, OneFactor, OneMinusSrcAlphaFactor, AddEquation.\n\tgl_FragColor.rgb *= gl_FragColor.a;\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_SKINNING\n\n\tvec4 mvPosition = modelViewMatrix * skinned;\n\n#else\n\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n\n#endif\n\ngl_Position = projectionMatrix * mvPosition;\n"},function(t,e){t.exports="float roughnessFactor = roughness;\n\n#ifdef USE_ROUGHNESSMAP\n\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\n\t// reads channel G, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\troughnessFactor *= texelRoughness.g;\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_ROUGHNESSMAP\n\n\tuniform sampler2D roughnessMap;\n\n#endif"},function(t,e){t.exports="#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHTS > 0\n\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHTS > 0\n\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\n\t#endif\n\n\t#if NUM_POINT_LIGHTS > 0\n\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): create uniforms for area light shadows\n\n\t#endif\n\t*/\n\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\n\t}\n\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\n\t\tvec2 f = fract( uv * size + 0.5 );\n\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\n\t\treturn c;\n\n\t}\n\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\n\t\t// if ( something && something ) breaks ATI OpenGL shader compiler\n\t\t// if ( all( something, something ) ) using this instead\n\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n\t\tbool frustumTest = all( frustumTestVec );\n\n\t\tif ( frustumTest ) {\n\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\n\t\t\treturn (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#else // no percentage-closer filtering:\n\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n\t\t#endif\n\n\t\t}\n\n\t\treturn 1.0;\n\n\t}\n\n\t// cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D\n\t// vector suitable for 2D texture mapping. This code uses the following layout for the\n\t// 2D texture:\n\t//\n\t// xzXZ\n\t//  y Y\n\t//\n\t// Y - Positive y direction\n\t// y - Negative y direction\n\t// X - Positive x direction\n\t// x - Negative x direction\n\t// Z - Positive z direction\n\t// z - Negative z direction\n\t//\n\t// Source and test bed:\n\t// https://gist.github.com/tschw/da10c43c467ce8afd0c4\n\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\n\t\t// Number of texels to avoid at the edge of each square\n\n\t\tvec3 absV = abs( v );\n\n\t\t// Intersect unit cube\n\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\n\t\t// Apply scale to avoid seams\n\n\t\t// two texels less per square (one texel will do for NEAREST)\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\n\t\t// Unwrap\n\n\t\t// space: -1 ... 1 range for each square\n\t\t//\n\t\t// #X##\t\tdim    := ( 4 , 2 )\n\t\t//  # #\t\tcenter := ( 1 , 1 )\n\n\t\tvec2 planar = v.xy;\n\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\n\t\tif ( absV.z >= almostOne ) {\n\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\n\t\t} else if ( absV.x >= almostOne ) {\n\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\n\t\t} else if ( absV.y >= almostOne ) {\n\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\n\t\t}\n\n\t\t// Transform to UV space\n\n\t\t// scale := 0.5 / dim\n\t\t// translate := ( center + 0.5 ) / dim\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\n\t}\n\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\n\t\t// for point lights, the uniform @vShadowCoord is re-purposed to hold\n\t\t// the distance from the light to the world-space position of the fragment.\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\n\t\t// bd3D = base direction 3D\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t// dp = distance from light to fragment position\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#else // no percentage-closer filtering\n\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\n\t\t#endif\n\n\t}\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHTS > 0\n\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHTS > 0\n\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\n\t#endif\n\n\t#if NUM_POINT_LIGHTS > 0\n\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): uniforms for area light shadows\n\n\t#endif\n\t*/\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHTS > 0\n\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\n\t}\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHTS > 0\n\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\n\t}\n\n\t#endif\n\n\t#if NUM_POINT_LIGHTS > 0\n\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\n\t}\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): update vAreaShadowCoord with area light info\n\n\t#endif\n\t*/\n\n#endif\n"},function(t,e){t.exports="float getShadowMask() {\n\n\tfloat shadow = 1.0;\n\n\t#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHTS > 0\n\n\tDirectionalLight directionalLight;\n\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\n\t}\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHTS > 0\n\n\tSpotLight spotLight;\n\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\n\t}\n\n\t#endif\n\n\t#if NUM_POINT_LIGHTS > 0\n\n\tPointLight pointLight;\n\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\n\t}\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): update shadow for Area light\n\n\t#endif\n\t*/\n\n\t#endif\n\n\treturn shadow;\n\n}\n"},function(t,e){t.exports="#ifdef USE_SKINNING\n\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif"},function(t,e){t.exports="#ifdef USE_SKINNING\n\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\n\t#ifdef BONE_TEXTURE\n\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\n\t\t\ty = dy * ( y + 0.5 );\n\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\n\t\t\treturn bone;\n\n\t\t}\n\n\t#else\n\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\n\t\t}\n\n\t#endif\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_SKINNING\n\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n\n#endif\n"},function(t,e){t.exports="#ifdef USE_SKINNING\n\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\n#endif\n"},function(t,e){t.exports="float specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n\n#else\n\n\tspecularStrength = 1.0;\n\n#endif"},function(t,e){t.exports="#ifdef USE_SPECULARMAP\n\n\tuniform sampler2D specularMap;\n\n#endif"},function(t,e){t.exports="#if defined( TONE_MAPPING )\n\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n\n#endif\n"},function(t,e){t.exports="#define saturate(a) clamp( a, 0.0, 1.0 )\n\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\n\n// exposure only\nvec3 LinearToneMapping( vec3 color ) {\n\n\treturn toneMappingExposure * color;\n\n}\n\n// source: https://www.cs.utah.edu/~reinhard/cdrom/\nvec3 ReinhardToneMapping( vec3 color ) {\n\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n\n}\n\n// source: http://filmicgames.com/archives/75\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\n\t// John Hable's filmic operator from Uncharted 2 video game\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n\n}\n\n// source: http://filmicgames.com/archives/75\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\n\t// optimized filmic operator by Jim Hejl and Richard Burgess-Dawson\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n\n}\n"},function(t,e){t.exports="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvarying vec2 vUv2;\n\n#endif"},function(t,e){t.exports="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\n#endif"},function(t,e){t.exports="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvUv2 = uv2;\n\n#endif"},function(t,e){t.exports="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\n\tvarying vec2 vUv;\n\n#endif"},function(t,e){t.exports="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n\n#endif\n"},function(t,e){t.exports="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n\n#endif"},function(t,e){t.exports="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\n\t#ifdef USE_SKINNING\n\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\n\t#else\n\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\n\t#endif\n\n#endif\n"},function(t,e){t.exports="uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\n\nvarying vec3 vWorldPosition;\n\n#include <common>\n\nvoid main() {\n\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n\n}\n"},function(t,e){t.exports="varying vec3 vWorldPosition;\n\n#include <common>\n\nvoid main() {\n\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\n}\n"},function(t,e){t.exports="#if DEPTH_PACKING == 3200\n\n\tuniform float opacity;\n\n#endif\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tdiffuseColor.a = opacity;\n\n\t#endif\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\t#include <logdepthbuf_fragment>\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\n\t#elif DEPTH_PACKING == 3201\n\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\n\t#endif\n\n}\n"},function(t,e){t.exports="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <skinbase_vertex>\n\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n}\n"},function(t,e){t.exports="uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\n\nvoid main () {\n\n\t#include <clipping_planes_fragment>\n\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n\n}\n"},function(t,e){t.exports="varying vec4 vWorldPosition;\n\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvWorldPosition = worldPosition;\n\n}\n"},function(t,e){t.exports="uniform sampler2D tEquirect;\nuniform float tFlip;\n\nvarying vec3 vWorldPosition;\n\n#include <common>\n\nvoid main() {\n\n\t// \tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n}\n"},function(t,e){t.exports="varying vec3 vWorldPosition;\n\n#include <common>\n\nvoid main() {\n\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\n}\n"},function(t,e){t.exports="uniform vec3 diffuse;\nuniform float opacity;\n\nuniform float dashSize;\nuniform float totalSize;\n\nvarying float vLineDistance;\n\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\n\t\tdiscard;\n\n\t}\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\n\toutgoingLight = diffuseColor.rgb; // simple shader\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n"},function(t,e){t.exports="uniform float scale;\nattribute float lineDistance;\n\nvarying float vLineDistance;\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <color_vertex>\n\n\tvLineDistance = scale * lineDistance;\n\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n}\n"},function(t,e){t.exports="uniform vec3 diffuse;\nuniform float opacity;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\n\t// accumulation (baked indirect lighting only)\n\t#ifdef USE_LIGHTMAP\n\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\n\t#endif\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n"},function(t,e){t.exports="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_ENVMAP\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n\n}\n"},function(t,e){t.exports="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\nvarying vec3 vLightFront;\n\n#ifdef DOUBLE_SIDED\n\n\tvarying vec3 vLightBack;\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\n\t#include <lightmap_fragment>\n\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\n\t#else\n\n\t\treflectedLight.directDiffuse = vLightFront;\n\n\t#endif\n\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n"},function(t,e){t.exports="#define LAMBERT\n\nvarying vec3 vLightFront;\n\n#ifdef DOUBLE_SIDED\n\n\tvarying vec3 vLightBack;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n"},function(t,e){t.exports="#define PHONG\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n"},function(t,e){t.exports="#define PHONG\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n"},function(t,e){t.exports="#define PHYSICAL\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n"},function(t,e){t.exports="#define PHYSICAL\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n"},function(t,e){t.exports="#define NORMAL\n\nuniform float opacity;\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\n\tvarying vec3 vViewPosition;\n\n#endif\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n\nvoid main() {\n\n\t#include <logdepthbuf_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\n}\n"},function(t,e){t.exports="#define NORMAL\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\n\tvarying vec3 vViewPosition;\n\n#endif\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\n\tvViewPosition = - mvPosition.xyz;\n\n#endif\n\n}\n"},function(t,e){t.exports="uniform vec3 diffuse;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\n\toutgoingLight = diffuseColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n"},function(t,e){t.exports="uniform float size;\nuniform float scale;\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n"},function(t,e){t.exports="uniform float opacity;\n\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n\nvoid main() {\n\n\tgl_FragColor = vec4( 0.0, 0.0, 0.0, opacity * ( 1.0 - getShadowMask() ) );\n\n}\n"},function(t,e){t.exports="#include <shadowmap_pars_vertex>\n\nvoid main() {\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\n}\n"},function(t,e){(function(){function t(t){return Array.isArray(t)&&(t=new SVG.Array(t)),t.toString().replace(/^\s+/,"").replace(/\s+$/,"").replace(/\s+/g," ")}function e(t){if(!Array.isArray(t))return t;for(var e=0,n=t.length,i=[];e<n;e++)i.push(t[e]);return i.join(" ")}function n(){var t=function(){};"function"==typeof arguments[arguments.length-1]&&(t=arguments[arguments.length-1],Array.prototype.splice.call(arguments,arguments.length-1,1));for(var e in arguments)for(var n in arguments[e])t(arguments[e][n],n,arguments[e])}SVG.Filter=SVG.invent({create:"filter",inherit:SVG.Parent,extend:{source:"SourceGraphic",sourceAlpha:"SourceAlpha",background:"BackgroundImage",backgroundAlpha:"BackgroundAlpha",fill:"FillPaint",stroke:"StrokePaint",autoSetIn:!0,put:function(t,e){return this.add(t,e),!t.attr("in")&&this.autoSetIn&&t.attr("in",this.source),t.attr("result")||t.attr("result",t),t},blend:function(t,e,n){return this.put(new SVG.BlendEffect(t,e,n))},colorMatrix:function(t,e){return this.put(new SVG.ColorMatrixEffect(t,e))},convolveMatrix:function(t){return this.put(new SVG.ConvolveMatrixEffect(t))},componentTransfer:function(t){return this.put(new SVG.ComponentTransferEffect(t))},composite:function(t,e,n){return this.put(new SVG.CompositeEffect(t,e,n))},flood:function(t,e){return this.put(new SVG.FloodEffect(t,e))},offset:function(t,e){return this.put(new SVG.OffsetEffect(t,e))},image:function(t){return this.put(new SVG.ImageEffect(t))},merge:function(){var t=[void 0];for(var e in arguments)t.push(arguments[e]);return this.put(new(SVG.MergeEffect.bind.apply(SVG.MergeEffect,t)))},gaussianBlur:function(t,e){return this.put(new SVG.GaussianBlurEffect(t,e))},morphology:function(t,e){return this.put(new SVG.MorphologyEffect(t,e))},diffuseLighting:function(t,e,n){return this.put(new SVG.DiffuseLightingEffect(t,e,n))},displacementMap:function(t,e,n,i,r){return this.put(new SVG.DisplacementMapEffect(t,e,n,i,r))},specularLighting:function(t,e,n,i){return this.put(new SVG.SpecularLightingEffect(t,e,n,i))},tile:function(){return this.put(new SVG.TileEffect)},turbulence:function(t,e,n,i,r){return this.put(new SVG.TurbulenceEffect(t,e,n,i,r))},toString:function(){return"url(#"+this.attr("id")+")"}}}),SVG.extend(SVG.Defs,{filter:function(t){var e=this.put(new SVG.Filter);return"function"==typeof t&&t.call(e,e),e}}),SVG.extend(SVG.Container,{filter:function(t){return this.defs().filter(t)}}),SVG.extend(SVG.Element,SVG.G,SVG.Nested,{filter:function(t){return this.filterer=t instanceof SVG.Element?t:this.doc().filter(t),this.doc()&&this.filterer.doc()!==this.doc()&&this.doc().defs().add(this.filterer),this.attr("filter",this.filterer),this.filterer},unfilter:function(t){return this.filterer&&!0===t&&this.filterer.remove(),delete this.filterer,this.attr("filter",null)}}),SVG.Effect=SVG.invent({create:function(){this.constructor.call(this)},inherit:SVG.Element,extend:{in:function(t){return null==t?this.parent()&&this.parent().select('[result="'+this.attr("in")+'"]').get(0)||this.attr("in"):this.attr("in",t)},result:function(t){return null==t?this.attr("result"):this.attr("result",t)},toString:function(){return this.result()}}}),SVG.ParentEffect=SVG.invent({create:function(){this.constructor.call(this)},inherit:SVG.Parent,extend:{in:function(t){return null==t?this.parent()&&this.parent().select('[result="'+this.attr("in")+'"]').get(0)||this.attr("in"):this.attr("in",t)},result:function(t){return null==t?this.attr("result"):this.attr("result",t)},toString:function(){return this.result()}}});var i={blend:function(t,e){return this.parent()&&this.parent().blend(this,t,e)},colorMatrix:function(t,e){return this.parent()&&this.parent().colorMatrix(t,e).in(this)},convolveMatrix:function(t){return this.parent()&&this.parent().convolveMatrix(t).in(this)},componentTransfer:function(t){return this.parent()&&this.parent().componentTransfer(t).in(this)},composite:function(t,e){return this.parent()&&this.parent().composite(this,t,e)},flood:function(t,e){return this.parent()&&this.parent().flood(t,e)},offset:function(t,e){return this.parent()&&this.parent().offset(t,e).in(this)},image:function(t){return this.parent()&&this.parent().image(t)},merge:function(){return this.parent()&&this.parent().merge.apply(this.parent(),[this].concat(arguments))},gaussianBlur:function(t,e){return this.parent()&&this.parent().gaussianBlur(t,e).in(this)},morphology:function(t,e){return this.parent()&&this.parent().morphology(t,e).in(this)},diffuseLighting:function(t,e,n){return this.parent()&&this.parent().diffuseLighting(t,e,n).in(this)},displacementMap:function(t,e,n,i){return this.parent()&&this.parent().displacementMap(this,t,e,n,i)},specularLighting:function(t,e,n,i){return this.parent()&&this.parent().specularLighting(t,e,n,i).in(this)},tile:function(){return this.parent()&&this.parent().tile().in(this)},turbulence:function(t,e,n,i,r){return this.parent()&&this.parent().turbulence(t,e,n,i,r).in(this)}};SVG.extend(SVG.Effect,i),SVG.extend(SVG.ParentEffect,i),SVG.ChildEffect=SVG.invent({create:function(){this.constructor.call(this)},inherit:SVG.Element,extend:{in:function(t){this.attr("in",t)}}});var r={blend:function(t,e,n){this.attr({in:t,in2:e,mode:n||"normal"})},colorMatrix:function(e,n){"matrix"==e&&(n=t(n)),this.attr({type:e,values:void 0===n?null:n})},convolveMatrix:function(e){e=t(e),this.attr({order:Math.sqrt(e.split(" ").length),kernelMatrix:e})},composite:function(t,e,n){this.attr({in:t,in2:e,operator:n})},flood:function(t,e){this.attr("flood-color",t),null!=e&&this.attr("flood-opacity",e)},offset:function(t,e){this.attr({dx:t,dy:e})},image:function(t){this.attr("href",t,SVG.xlink)},displacementMap:function(t,e,n,i,r){this.attr({in:t,in2:e,scale:n,xChannelSelector:i,yChannelSelector:r})},gaussianBlur:function(t,n){null!=t||null!=n?this.attr("stdDeviation",e(Array.prototype.slice.call(arguments))):this.attr("stdDeviation","0 0")},morphology:function(t,e){this.attr({operator:t,radius:e})},tile:function(){},turbulence:function(t,e,n,i,r){this.attr({numOctaves:e,seed:n,stitchTiles:i,baseFrequency:t,type:r})}},o={merge:function(){var t;if(arguments[0]instanceof SVG.Set){var e=this;arguments[0].each(function(t){this instanceof SVG.MergeNode?e.put(this):(this instanceof SVG.Effect||this instanceof SVG.ParentEffect)&&e.put(new SVG.MergeNode(this))})}else{t=Array.isArray(arguments[0])?arguments[0]:arguments;for(var n=0;n<t.length;n++)t[n]instanceof SVG.MergeNode?this.put(t[n]):this.put(new SVG.MergeNode(t[n]))}},componentTransfer:function(t){if(this.rgb=new SVG.Set,["r","g","b","a"].forEach(function(t){this[t]=new(SVG["Func"+t.toUpperCase()])("identity"),this.rgb.add(this[t]),this.node.appendChild(this[t].node)}.bind(this)),t){t.rgb&&(["r","g","b"].forEach(function(e){this[e].attr(t.rgb)}.bind(this)),delete t.rgb);for(var e in t)this[e].attr(t[e])}},diffuseLighting:function(t,e,n){this.attr({surfaceScale:t,diffuseConstant:e,kernelUnitLength:n})},specularLighting:function(t,e,n,i){this.attr({surfaceScale:t,diffuseConstant:e,specularExponent:n,kernelUnitLength:i})}},a={distantLight:function(t,e){this.attr({azimuth:t,elevation:e})},pointLight:function(t,e,n){this.attr({x:t,y:e,z:n})},spotLight:function(t,e,n,i,r,o){this.attr({x:t,y:e,z:n,pointsAtX:i,pointsAtY:r,pointsAtZ:o})},mergeNode:function(t){this.attr("in",t)}};["r","g","b","a"].forEach(function(t){a["Func"+t.toUpperCase()]=function(t){switch(this.attr("type",t),t){case"table":this.attr("tableValues",arguments[1]);break;case"linear":this.attr("slope",arguments[1]),this.attr("intercept",arguments[2]);break;case"gamma":this.attr("amplitude",arguments[1]),this.attr("exponent",arguments[2]),this.attr("offset",arguments[2])}}}),n(r,function(t,e){var n=e.charAt(0).toUpperCase()+e.slice(1),i={};SVG[n+"Effect"]=SVG.invent({create:function(){this.constructor.call(this,SVG.create("fe"+n)),t.apply(this,arguments),this.result(this.attr("id")+"Out")},inherit:SVG.Effect,extend:i})}),n(o,function(t,e){var n=e.charAt(0).toUpperCase()+e.slice(1),i={};SVG[n+"Effect"]=SVG.invent({create:function(){this.constructor.call(this,SVG.create("fe"+n)),t.apply(this,arguments),this.result(this.attr("id")+"Out")},inherit:SVG.ParentEffect,extend:i})}),n(a,function(t,e){var n=e.charAt(0).toUpperCase()+e.slice(1),i={};SVG[n]=SVG.invent({create:function(){this.constructor.call(this,SVG.create("fe"+n)),t.apply(this,arguments)},inherit:SVG.ChildEffect,extend:i})}),SVG.extend(SVG.MergeEffect,{in:function(t){return t instanceof SVG.MergeNode?this.add(t,0):this.add(new SVG.MergeNode(t),0),this}}),SVG.extend(SVG.CompositeEffect,SVG.BlendEffect,SVG.DisplacementMapEffect,{in2:function(t){return null==t?this.parent()&&this.parent().select('[result="'+this.attr("in2")+'"]').get(0)||this.attr("in2"):this.attr("in2",t)}}),SVG.filter={sepiatone:[.343,.669,.119,0,0,.249,.626,.13,0,0,.172,.334,.111,0,0,0,0,0,1,0]}}).call(this)},function(t,e,n){"use strict";function i(t,e,n,i,o,a){r.a.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=void 0!==o?o:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}n.d(e,"a",function(){return i});var r=n(26),o=n(6);i.prototype=Object.assign(Object.create(r.a.prototype),{constructor:i,isOrthographicCamera:!0,copy:function(t){return r.a.prototype.copy.call(this,t),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,i,r,o){this.view={fullWidth:t,fullHeight:e,offsetX:n,offsetY:i,width:r,height:o},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2,r=n-t,o=n+t,a=i+e,s=i-e;if(null!==this.view){var l=this.zoom/(this.view.width/this.view.fullWidth),u=this.zoom/(this.view.height/this.view.fullHeight),h=(this.right-this.left)/this.view.width,c=(this.top-this.bottom)/this.view.height;r+=h*(this.view.offsetX/l),o=r+h*(this.view.width/l),a-=c*(this.view.offsetY/u),s=a-c*(this.view.height/u)}this.projectionMatrix.makeOrthographic(r,o,a,s,this.near,this.far)},toJSON:function(t){var e=o.a.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}})},function(t,e,n){"use strict";function i(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}n.d(e,"a",function(){return i});var r=n(4);Object.assign(i.prototype,{computeGroups:function(t){for(var e,n=[],i=void 0,r=t.faces,o=0;o<r.length;o++){var a=r[o];a.materialIndex!==i&&(i=a.materialIndex,void 0!==e&&(e.count=3*o-e.start,n.push(e)),e={start:3*o,materialIndex:i})}void 0!==e&&(e.count=3*o-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e,n=t.faces,i=t.vertices,o=t.faceVertexUvs,a=o[0]&&o[0].length>0,s=o[1]&&o[1].length>0,l=t.morphTargets,u=l.length;if(u>0){e=[];for(var h=0;h<u;h++)e[h]=[];this.morphTargets.position=e}var c,d=t.morphNormals,f=d.length;if(f>0){c=[];for(var h=0;h<f;h++)c[h]=[];this.morphTargets.normal=c}for(var p=t.skinIndices,m=t.skinWeights,v=p.length===i.length,g=m.length===i.length,h=0;h<n.length;h++){var y=n[h];this.vertices.push(i[y.a],i[y.b],i[y.c]);var _=y.vertexNormals;if(3===_.length)this.normals.push(_[0],_[1],_[2]);else{var x=y.normal;this.normals.push(x,x,x)}var b=y.vertexColors;if(3===b.length)this.colors.push(b[0],b[1],b[2]);else{var w=y.color;this.colors.push(w,w,w)}if(!0===a){var E=o[0][h];void 0!==E?this.uvs.push(E[0],E[1],E[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",h),this.uvs.push(new r.a,new r.a,new r.a))}if(!0===s){var E=o[1][h];void 0!==E?this.uvs2.push(E[0],E[1],E[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",h),this.uvs2.push(new r.a,new r.a,new r.a))}for(var P=0;P<u;P++){var M=l[P].vertices;e[P].push(M[y.a],M[y.b],M[y.c])}for(var P=0;P<f;P++){var S=d[P].vertexNormals[h];c[P].push(S.a,S.b,S.c)}v&&this.skinIndices.push(p[y.a],p[y.b],p[y.c]),g&&this.skinWeights.push(m[y.a],m[y.b],m[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}})},function(t,e,n){"use strict";function i(){this.mask=1}n.d(e,"a",function(){return i}),Object.assign(i.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},test:function(t){return 0!=(this.mask&t.mask)}})},function(t,e,n){"use strict";function i(t,e,n,i,a,s){o.b.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:a,depthSegments:s},this.fromBufferGeometry(new r(t,e,n,i,a,s)),this.mergeVertices()}function r(t,e,n,i,r,o){function u(t,e,n,i,r,o,a,s,u,g,y){var _,x,b=o/u,w=a/g,E=o/2,P=a/2,M=s/2,S=u+1,T=g+1,C=0,L=0,A=new l.a;for(x=0;x<T;x++){var I=x*w-P;for(_=0;_<S;_++){var N=_*b-E;A[t]=N*i,A[e]=I*r,A[n]=M,d.push(A.x,A.y,A.z),A[t]=0,A[e]=0,A[n]=s>0?1:-1,f.push(A.x,A.y,A.z),p.push(_/u),p.push(1-x/g),C+=1}}for(x=0;x<g;x++)for(_=0;_<u;_++){var R=m+_+S*x,D=m+_+S*(x+1),O=m+(_+1)+S*(x+1),U=m+(_+1)+S*x;c.push(R,D,U),c.push(D,O,U),L+=6}h.addGroup(v,L,y),v+=L,m+=C}a.a.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:o};var h=this;i=Math.floor(i)||1,r=Math.floor(r)||1,o=Math.floor(o)||1;var c=[],d=[],f=[],p=[],m=0,v=0;u("z","y","x",-1,-1,n,e,t,o,r,0),u("z","y","x",1,-1,n,e,-t,o,r,1),u("x","z","y",1,1,t,n,e,i,o,2),u("x","z","y",1,-1,t,n,-e,i,o,3),u("x","y","z",1,-1,t,e,n,i,r,4),u("x","y","z",-1,-1,t,e,-n,i,r,5),this.setIndex(c),this.addAttribute("position",new s.a(d,3)),this.addAttribute("normal",new s.a(f,3)),this.addAttribute("uv",new s.a(p,2))}n.d(e,"a",function(){return r});var o=n(18),a=n(7),s=n(12),l=n(0);i.prototype=Object.create(o.b.prototype),i.prototype.constructor=i,r.prototype=Object.create(a.a.prototype),r.prototype.constructor=r},function(t,e,n){"use strict";function i(t){t=t||1;var e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new l.a;i.addAttribute("position",new s.a(e,3)),i.addAttribute("color",new s.a(n,3));var u=new a.a({vertexColors:o.a});r.a.call(this,i,u)}n.d(e,"a",function(){return i});var r=n(34),o=n(1),a=n(29),s=n(12),l=n(7);i.prototype=Object.create(r.a.prototype),i.prototype.constructor=i},function(t,e,n){"use strict";function i(t,e){r.a.call(this),this.type="Light",this.color=new o.a(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}n.d(e,"a",function(){return i});var r=n(6),o=n(3);i.prototype=Object.assign(Object.create(r.a.prototype),{constructor:i,isLight:!0,copy:function(t){return r.a.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=r.a.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}})},function(t,e,n){"use strict";function i(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new o.a(512,512),this.map=null,this.matrix=new r.a}n.d(e,"a",function(){return i});var r=n(5),o=n(4);Object.assign(i.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}})},function(t,e,n){"use strict";function i(t,e,n,i){r.a.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==i?i:1,this.shadow=new a.a(new o.a(90,1,.5,500))}n.d(e,"a",function(){return i});var r=n(178),o=n(17),a=n(179);i.prototype=Object.assign(Object.create(r.a.prototype),{constructor:i,isPointLight:!0,copy:function(t){return r.a.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}})},function(t,e,n){"use strict";function i(t){r.a.call(this),this.type="MeshDepthMaterial",this.depthPacking=o._22,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(t)}n.d(e,"a",function(){return i});var r=n(9),o=n(1);i.prototype=Object.create(r.a.prototype),i.prototype.constructor=i,i.prototype.isMeshDepthMaterial=!0,i.prototype.copy=function(t){return r.a.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}},function(t,e,n){"use strict";function i(t){r.a.call(this),this.type="MeshLambertMaterial",this.color=new a.a(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new a.a(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=o.b,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}n.d(e,"a",function(){return i});var r=n(9),o=n(1),a=n(3);i.prototype=Object.create(r.a.prototype),i.prototype.constructor=i,i.prototype.isMeshLambertMaterial=!0,i.prototype.copy=function(t){return r.a.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this}},function(t,e,n){"use strict";function i(t){r.a.call(this),this.type="MeshPhongMaterial",this.color=new s.a(16777215),this.specular=new s.a(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new s.a(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new a.a(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=o.b,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}n.d(e,"a",function(){return i});var r=n(9),o=n(1),a=n(4),s=n(3);i.prototype=Object.create(r.a.prototype),i.prototype.constructor=i,i.prototype.isMeshPhongMaterial=!0,i.prototype.copy=function(t){return r.a.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this}},function(t,e,n){"use strict";function i(t,e){this.min=void 0!==t?t:new r.a(1/0,1/0),this.max=void 0!==e?e:new r.a(-1/0,-1/0)}n.d(e,"a",function(){return i});var r=n(4);Object.assign(i.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new r.a;return function(e,n){var i=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){var e=t||new r.a;return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){var e=t||new r.a;return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return(e||new r.a).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return(e||new r.a).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new r.a;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}})},function(t,e,n){"use strict";function i(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||i.DefaultOrder}n.d(e,"a",function(){return i});var r=n(14),o=n(0),a=n(5),s=n(2);i.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],i.DefaultOrder="XYZ",Object.defineProperties(i.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback()}}}),Object.assign(i.prototype,{isEuler:!0,set:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._order=i||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var i=s.a.clamp,r=t.elements,o=r[0],a=r[4],l=r[8],u=r[1],h=r[5],c=r[9],d=r[2],f=r[6],p=r[10];return e=e||this._order,"XYZ"===e?(this._y=Math.asin(i(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-c,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,h),this._z=0)):"YXZ"===e?(this._x=Math.asin(-i(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(l,p),this._z=Math.atan2(u,h)):(this._y=Math.atan2(-d,o),this._z=0)):"ZXY"===e?(this._x=Math.asin(i(f,-1,1)),Math.abs(f)<.99999?(this._y=Math.atan2(-d,p),this._z=Math.atan2(-a,h)):(this._y=0,this._z=Math.atan2(u,o))):"ZYX"===e?(this._y=Math.asin(-i(d,-1,1)),Math.abs(d)<.99999?(this._x=Math.atan2(f,p),this._z=Math.atan2(u,o)):(this._x=0,this._z=Math.atan2(-a,h))):"YZX"===e?(this._z=Math.asin(i(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(-c,h),this._y=Math.atan2(-d,o)):(this._x=0,this._y=Math.atan2(l,p))):"XZY"===e?(this._z=Math.asin(-i(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(f,h),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-c,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:function(){var t=new a.a;return function(e,n,i){return t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,n,i)}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new r.a;return function(e){return t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new o.a(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}})},function(t,e,n){"use strict";function i(t,e){this.start=void 0!==t?t:new r.a,this.end=void 0!==e?e:new r.a}n.d(e,"a",function(){return i});var r=n(0),o=n(2);Object.assign(i.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return(t||new r.a).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return(t||new r.a).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){var n=e||new r.a;return this.delta(n).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new r.a,e=new r.a;return function(n,i){t.subVectors(n,this.start),e.subVectors(this.end,this.start);var r=e.dot(e),a=e.dot(t),s=a/r;return i&&(s=o.a.clamp(s,0,1)),s}}(),closestPointToPoint:function(t,e,n){var i=this.closestPointToPointParameter(t,e),o=n||new r.a;return this.delta(o).multiplyScalar(i).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}})},function(t,e,n){"use strict";function i(t,e,n){this.a=void 0!==t?t:new r.a,this.b=void 0!==e?e:new r.a,this.c=void 0!==n?n:new r.a}n.d(e,"a",function(){return i});var r=n(0),o=n(186),a=n(20);Object.assign(i,{normal:function(){var t=new r.a;return function(e,n,i,o){var a=o||new r.a;a.subVectors(i,n),t.subVectors(e,n),a.cross(t);var s=a.lengthSq();return s>0?a.multiplyScalar(1/Math.sqrt(s)):a.set(0,0,0)}}(),barycoordFromPoint:function(){var t=new r.a,e=new r.a,n=new r.a;return function(i,o,a,s,l){t.subVectors(s,o),e.subVectors(a,o),n.subVectors(i,o);var u=t.dot(t),h=t.dot(e),c=t.dot(n),d=e.dot(e),f=e.dot(n),p=u*d-h*h,m=l||new r.a;if(0===p)return m.set(-2,-1,-1);var v=1/p,g=(d*c-h*f)*v,y=(u*f-h*c)*v;return m.set(1-g-y,y,g)}}(),containsPoint:function(){var t=new r.a;return function(e,n,r,o){var a=i.barycoordFromPoint(e,n,r,o,t);return a.x>=0&&a.y>=0&&a.x+a.y<=1}}()}),Object.assign(i.prototype,{set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new r.a,e=new r.a;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function(t){return(t||new r.a).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return i.normal(this.a,this.b,this.c,t)},plane:function(t){return(t||new a.a).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return i.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return i.containsPoint(t,this.a,this.b,this.c)},closestPointToPoint:function(){var t=new a.a,e=[new o.a,new o.a,new o.a],n=new r.a,i=new r.a;return function(o,a){var s=a||new r.a,l=1/0;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(o,n),!0===this.containsPoint(n))s.copy(n);else{e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a);for(var u=0;u<e.length;u++){e[u].closestPointToPoint(n,!0,i);var h=n.distanceToSquared(i);h<l&&(l=h,s.copy(i))}}return s}}(),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}})},function(t,e,n){"use strict";function i(t,e,n){if(1===n)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new c.a(t,e);s.a.call(this),this.type="Line",this.geometry=void 0!==t?t:new h.a,this.material=void 0!==e?e:new u.a({color:16777215*Math.random()})}n.d(e,"a",function(){return i});var r=n(10),o=n(33),a=n(5),s=n(6),l=n(0),u=n(29),h=n(7),c=n(34);i.prototype=Object.assign(Object.create(s.a.prototype),{constructor:i,isLine:!0,raycast:function(){var t=new a.a,e=new o.a,n=new r.a;return function(i,r){var o=i.linePrecision,a=o*o,s=this.geometry,u=this.matrixWorld;if(null===s.boundingSphere&&s.computeBoundingSphere(),n.copy(s.boundingSphere),n.applyMatrix4(u),!1!==i.ray.intersectsSphere(n)){t.getInverse(u),e.copy(i.ray).applyMatrix4(t);var h=new l.a,c=new l.a,d=new l.a,f=new l.a,p=this&&this.isLineSegments?2:1;if(s.isBufferGeometry){var m=s.index,v=s.attributes,g=v.position.array;if(null!==m)for(var y=m.array,_=0,x=y.length-1;_<x;_+=p){var b=y[_],w=y[_+1];h.fromArray(g,3*b),c.fromArray(g,3*w);var E=e.distanceSqToSegment(h,c,f,d);if(!(E>a)){f.applyMatrix4(this.matrixWorld);var P=i.ray.origin.distanceTo(f);P<i.near||P>i.far||r.push({distance:P,point:d.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}else for(var _=0,x=g.length/3-1;_<x;_+=p){h.fromArray(g,3*_),c.fromArray(g,3*_+3);var E=e.distanceSqToSegment(h,c,f,d);if(!(E>a)){f.applyMatrix4(this.matrixWorld);var P=i.ray.origin.distanceTo(f);P<i.near||P>i.far||r.push({distance:P,point:d.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}}else if(s.isGeometry)for(var M=s.vertices,S=M.length,_=0;_<S-1;_+=p){var E=e.distanceSqToSegment(M[_],M[_+1],f,d);if(!(E>a)){f.applyMatrix4(this.matrixWorld);var P=i.ray.origin.distanceTo(f);P<i.near||P>i.far||r.push({distance:P,point:d.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}})},function(t,e){void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),void 0===Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&function(){Object.assign=function(t){"use strict";if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(void 0!==i&&null!==i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}}()},function(t,e,n){"use strict";function i(t,e,n){this.uuid=l.a.generateUUID(),this.width=t,this.height=e,this.scissor=new s.a(0,0,t,e),this.scissorTest=!1,this.viewport=new s.a(0,0,t,e),n=n||{},void 0===n.minFilter&&(n.minFilter=a.D),this.texture=new o.a(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}n.d(e,"a",function(){return i});var r=n(8),o=n(15),a=n(1),s=n(11),l=n(2);Object.assign(i.prototype,r.a.prototype,{isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}})},function(t,e,n){"use strict";function i(t){function e(){return null===At?Vt:1}function n(){le.init(),le.scissor(Ot.copy(Yt).multiplyScalar(Vt)),le.viewport(Ft.copy(Wt).multiplyScalar(Vt)),le.buffers.color.setClear(zt.r,zt.g,zt.b,Xt,bt)}function i(){Lt=null,Dt=null,Rt="",Nt=-1,le.reset()}function k(t){t.preventDefault(),i(),n(),ue.clear(),fe.clear()}function G(t){var e=t.target;e.removeEventListener("dispose",G),V(e)}function V(t){Y(t),ue.remove(t)}function Y(t){var e=ue.get(t).program;t.program=void 0,void 0!==e&&pe.releaseProgram(e)}function H(t,e,n){t.render(function(t){Ct.renderBufferImmediate(t,e,n)})}function W(t,e){return Math.abs(e[0])-Math.abs(t[0])}function j(t,e,n,i){if(n&&n.isInstancedBufferGeometry&&null===ae.get("ANGLE_instanced_arrays"))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");void 0===i&&(i=0),le.initAttributes();var r=n.attributes,o=e.getAttributes(),a=t.defaultAttributeValues;for(var s in o){var l=o[s];if(l>=0){var u=r[s];if(void 0!==u){var h=u.normalized,c=u.itemSize,d=ce.get(u),f=d.buffer,p=d.type,m=d.bytesPerElement;if(u.isInterleavedBufferAttribute){var v=u.data,g=v.stride,y=u.offset;v&&v.isInstancedInterleavedBuffer?(le.enableAttributeAndDivisor(l,v.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=v.meshPerAttribute*v.count)):le.enableAttribute(l),re.bindBuffer(re.ARRAY_BUFFER,f),re.vertexAttribPointer(l,c,p,h,g*m,(i*g+y)*m)}else u.isInstancedBufferAttribute?(le.enableAttributeAndDivisor(l,u.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=u.meshPerAttribute*u.count)):le.enableAttribute(l),re.bindBuffer(re.ARRAY_BUFFER,f),re.vertexAttribPointer(l,c,p,h,0,i*c*m)}else if(void 0!==a){var _=a[s];if(void 0!==_)switch(_.length){case 2:re.vertexAttrib2fv(l,_);break;case 3:re.vertexAttrib3fv(l,_);break;case 4:re.vertexAttrib4fv(l,_);break;default:re.vertexAttrib1fv(l,_)}}}}le.disableUnusedAttributes()}function q(t,e,n){if(t.visible){if(t.layers.test(e.layers))if(t.isLight)Et.push(t);else if(t.isSprite)t.frustumCulled&&!jt.intersectsSprite(t)||St.push(t);else if(t.isLensFlare)Tt.push(t);else if(t.isImmediateRenderObject)n&&Kt.setFromMatrixPosition(t.matrixWorld).applyMatrix4(Qt),Pt.push(t,null,t.material,Kt.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||jt.intersectsObject(t))){n&&Kt.setFromMatrixPosition(t.matrixWorld).applyMatrix4(Qt);var i=fe.update(t),r=t.material;if(Array.isArray(r))for(var o=i.groups,a=0,s=o.length;a<s;a++){var l=o[a],u=r[l.materialIndex];u&&u.visible&&Pt.push(t,i,u,Kt.z,l)}else r.visible&&Pt.push(t,i,r,Kt.z,null)}for(var h=t.children,a=0,s=h.length;a<s;a++)q(h[a],e,n)}}function J(t,e,n,i){for(var r=0,o=t.length;r<o;r++){var a=t[r],s=a.object,l=a.geometry,u=void 0===i?a.material:i,h=a.group;if(s.onBeforeRender(Ct,e,n,l,u,h),n.isArrayCamera&&n.enabled)for(var c=n.cameras,d=0,f=c.length;d<f;d++){var p=c[d],m=p.bounds;Ct.setViewport(m.x*kt*Vt,m.y*Gt*Vt,m.z*kt*Vt,m.w*Gt*Vt),Ct.setScissor(m.x*kt*Vt,m.y*Gt*Vt,m.z*kt*Vt,m.w*Gt*Vt),Ct.setScissorTest(!0),Z(s,e,p,l,u,h)}else Z(s,e,n,l,u,h);s.onAfterRender(Ct,e,n,l,u,h)}}function Z(t,e,n,i,r,o){if(t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){le.setMaterial(r);var a=K(n,e.fog,r,t);Rt="",H(t,a,r)}else Ct.renderBufferDirect(n,e.fog,i,r,t,o)}function Q(t,e,n){var i=ue.get(t),r=pe.getParameters(t,ee,e,qt.numPlanes,qt.numIntersection,n),o=pe.getProgramCode(t,r),a=i.program,s=!0;if(void 0===a)t.addEventListener("dispose",G);else if(a.code!==o)Y(t);else{if(void 0!==r.shaderID)return;s=!1}if(s){if(r.shaderID){var u=c.a[r.shaderID];i.__webglShader={name:t.type,uniforms:h.a.clone(u.uniforms),vertexShader:u.vertexShader,fragmentShader:u.fragmentShader}}else i.__webglShader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.__webglShader=i.__webglShader,a=pe.acquireProgram(t,r,o),i.program=a,t.program=a}var d=a.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var f=0;f<Ct.maxMorphTargets;f++)d["morphTarget"+f]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(var f=0;f<Ct.maxMorphNormals;f++)d["morphNormal"+f]>=0&&t.numSupportedMorphNormals++}var p=i.__webglShader.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(i.numClippingPlanes=qt.numPlanes,i.numIntersection=qt.numIntersection,p.clippingPlanes=qt.uniform),i.fog=e,i.lightsHash=ee.hash,t.lights&&(p.ambientLightColor.value=ee.ambient,p.directionalLights.value=ee.directional,p.spotLights.value=ee.spot,p.rectAreaLights.value=ee.rectArea,p.pointLights.value=ee.point,p.hemisphereLights.value=ee.hemi,p.directionalShadowMap.value=ee.directionalShadowMap,p.directionalShadowMatrix.value=ee.directionalShadowMatrix,p.spotShadowMap.value=ee.spotShadowMap,p.spotShadowMatrix.value=ee.spotShadowMatrix,p.pointShadowMap.value=ee.pointShadowMap,p.pointShadowMatrix.value=ee.pointShadowMatrix);var m=i.program.getUniforms(),v=l.a.seqWithValue(m.seq,p);i.uniformsList=v}function K(t,e,n,i){Bt=0;var a=ue.get(n);if(Jt&&(Zt||t!==Dt)){var h=t===Dt&&n.id===Nt;qt.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,t,a,h)}!1===n.needsUpdate&&(void 0===a.program?n.needsUpdate=!0:n.fog&&a.fog!==e?n.needsUpdate=!0:n.lights&&a.lightsHash!==ee.hash?n.needsUpdate=!0:void 0===a.numClippingPlanes||a.numClippingPlanes===qt.numPlanes&&a.numIntersection===qt.numIntersection||(n.needsUpdate=!0)),n.needsUpdate&&(Q(n,e,i),n.needsUpdate=!1);var c=!1,d=!1,f=!1,p=a.program,m=p.getUniforms(),v=a.__webglShader.uniforms;if(p.id!==Lt&&(re.useProgram(p.program),Lt=p.id,c=!0,d=!0,f=!0),n.id!==Nt&&(Nt=n.id,d=!0),c||t!==Dt){if(m.setValue(re,"projectionMatrix",t.projectionMatrix),se.logarithmicDepthBuffer&&m.setValue(re,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),t!==Dt&&(Dt=t,d=!0,f=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap){var g=m.map.cameraPosition;void 0!==g&&g.setValue(re,Kt.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&m.setValue(re,"viewMatrix",t.matrixWorldInverse),m.setValue(re,"toneMappingExposure",Ct.toneMappingExposure),m.setValue(re,"toneMappingWhitePoint",Ct.toneMappingWhitePoint)}if(n.skinning){m.setOptional(re,i,"bindMatrix"),m.setOptional(re,i,"bindMatrixInverse");var y=i.skeleton;if(y){var _=y.bones;if(se.floatVertexTextures){if(void 0===y.boneTexture){var x=Math.sqrt(4*_.length);x=o.a.nextPowerOfTwo(Math.ceil(x)),x=Math.max(x,4);var b=new Float32Array(x*x*4);b.set(y.boneMatrices);var w=new s.a(b,x,x,r.s,r.t);y.boneMatrices=b,y.boneTexture=w,y.boneTextureSize=x}m.setValue(re,"boneTexture",y.boneTexture),m.setValue(re,"boneTextureSize",y.boneTextureSize)}else m.setOptional(re,y,"boneMatrices")}}return d&&(n.lights&&ht(v,f),e&&n.fog&&it(v,e),(n.isMeshBasicMaterial||n.isMeshLambertMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.isMeshNormalMaterial||n.isMeshDepthMaterial)&&$(v,n),n.isLineBasicMaterial?tt(v,n):n.isLineDashedMaterial?(tt(v,n),et(v,n)):n.isPointsMaterial?nt(v,n):n.isMeshLambertMaterial?rt(v,n):n.isMeshToonMaterial?at(v,n):n.isMeshPhongMaterial?ot(v,n):n.isMeshPhysicalMaterial?lt(v,n):n.isMeshStandardMaterial?st(v,n):n.isMeshDepthMaterial?n.displacementMap&&(v.displacementMap.value=n.displacementMap,v.displacementScale.value=n.displacementScale,v.displacementBias.value=n.displacementBias):n.isMeshNormalMaterial&&ut(v,n),void 0!==v.ltcMat&&(v.ltcMat.value=u.a.LTC_MAT_TEXTURE),void 0!==v.ltcMag&&(v.ltcMag.value=u.a.LTC_MAG_TEXTURE),l.a.upload(re,a.uniformsList,v,Ct)),m.setValue(re,"modelViewMatrix",i.modelViewMatrix),m.setValue(re,"normalMatrix",i.normalMatrix),m.setValue(re,"modelMatrix",i.matrixWorld),p}function $(t,e){t.opacity.value=e.opacity,t.diffuse.value=e.color,e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),t.map.value=e.map,t.specularMap.value=e.specularMap,t.alphaMap.value=e.alphaMap,e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity);var n;if(e.map?n=e.map:e.specularMap?n=e.specularMap:e.displacementMap?n=e.displacementMap:e.normalMap?n=e.normalMap:e.bumpMap?n=e.bumpMap:e.roughnessMap?n=e.roughnessMap:e.metalnessMap?n=e.metalnessMap:e.alphaMap?n=e.alphaMap:e.emissiveMap&&(n=e.emissiveMap),void 0!==n){n.isWebGLRenderTarget&&(n=n.texture);var i=n.offset,r=n.repeat;t.offsetRepeat.value.set(i.x,i.y,r.x,r.y)}t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio}function tt(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}function et(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}function nt(t,e){if(t.diffuse.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size*Vt,t.scale.value=.5*Gt,t.map.value=e.map,null!==e.map){var n=e.map.offset,i=e.map.repeat;t.offsetRepeat.value.set(n.x,n.y,i.x,i.y)}}function it(t,e){t.fogColor.value=e.color,e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}function rt(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}function ot(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function at(t,e){ot(t,e),e.gradientMap&&(t.gradientMap.value=e.gradientMap)}function st(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}function lt(t,e){t.clearCoat.value=e.clearCoat,t.clearCoatRoughness.value=e.clearCoatRoughness,st(t,e)}function ut(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function ht(t,e){t.ambientLightColor.needsUpdate=e,t.directionalLights.needsUpdate=e,t.pointLights.needsUpdate=e,t.spotLights.needsUpdate=e,t.rectAreaLights.needsUpdate=e,t.hemisphereLights.needsUpdate=e}function ct(t){for(var e=0,n=0,i=t.length;n<i;n++){var r=t[n];r.castShadow&&(ee.shadows[e]=r,e++)}ee.shadows.length=e}function dt(t,e){var n,i,r,o,a,s,l,u,h=0,c=0,d=0,f=e.matrixWorldInverse,p=0,m=0,v=0,g=0,y=0;for(n=0,i=t.length;n<i;n++)if(r=t[n],a=r.color,s=r.intensity,l=r.distance,u=r.shadow&&r.shadow.map?r.shadow.map.texture:null,r.isAmbientLight)h+=a.r*s,c+=a.g*s,d+=a.b*s;else if(r.isDirectionalLight){var _=me.get(r);_.color.copy(r.color).multiplyScalar(r.intensity),_.direction.setFromMatrixPosition(r.matrixWorld),Kt.setFromMatrixPosition(r.target.matrixWorld),_.direction.sub(Kt),_.direction.transformDirection(f),_.shadow=r.castShadow,r.castShadow&&(o=r.shadow,_.shadowBias=o.bias,_.shadowRadius=o.radius,_.shadowMapSize=o.mapSize),ee.directionalShadowMap[p]=u,ee.directionalShadowMatrix[p]=r.shadow.matrix,ee.directional[p]=_,p++}else if(r.isSpotLight){var _=me.get(r);_.position.setFromMatrixPosition(r.matrixWorld),_.position.applyMatrix4(f),_.color.copy(a).multiplyScalar(s),_.distance=l,_.direction.setFromMatrixPosition(r.matrixWorld),Kt.setFromMatrixPosition(r.target.matrixWorld),_.direction.sub(Kt),_.direction.transformDirection(f),_.coneCos=Math.cos(r.angle),_.penumbraCos=Math.cos(r.angle*(1-r.penumbra)),_.decay=0===r.distance?0:r.decay,_.shadow=r.castShadow,r.castShadow&&(o=r.shadow,_.shadowBias=o.bias,_.shadowRadius=o.radius,_.shadowMapSize=o.mapSize),ee.spotShadowMap[v]=u,ee.spotShadowMatrix[v]=r.shadow.matrix,ee.spot[v]=_,v++}else if(r.isRectAreaLight){var _=me.get(r);_.color.copy(a).multiplyScalar(s/(r.width*r.height)),_.position.setFromMatrixPosition(r.matrixWorld),_.position.applyMatrix4(f),te.identity(),$t.copy(r.matrixWorld),$t.premultiply(f),te.extractRotation($t),_.halfWidth.set(.5*r.width,0,0),_.halfHeight.set(0,.5*r.height,0),_.halfWidth.applyMatrix4(te),_.halfHeight.applyMatrix4(te),ee.rectArea[g]=_,g++}else if(r.isPointLight){var _=me.get(r);_.position.setFromMatrixPosition(r.matrixWorld),_.position.applyMatrix4(f),_.color.copy(r.color).multiplyScalar(r.intensity),_.distance=r.distance,_.decay=0===r.distance?0:r.decay,_.shadow=r.castShadow,r.castShadow&&(o=r.shadow,_.shadowBias=o.bias,_.shadowRadius=o.radius,_.shadowMapSize=o.mapSize),ee.pointShadowMap[m]=u,ee.pointShadowMatrix[m]=r.shadow.matrix,ee.point[m]=_,m++}else if(r.isHemisphereLight){var _=me.get(r);_.direction.setFromMatrixPosition(r.matrixWorld),_.direction.transformDirection(f),_.direction.normalize(),_.skyColor.copy(r.color).multiplyScalar(s),_.groundColor.copy(r.groundColor).multiplyScalar(s),ee.hemi[y]=_,y++}ee.ambient[0]=h,ee.ambient[1]=c,ee.ambient[2]=d,ee.directional.length=p,ee.spot.length=v,ee.rectArea.length=g,ee.point.length=m,ee.hemi.length=y,ee.hash=p+","+m+","+v+","+g+","+y+","+ee.shadows.length}function ft(){var t=Bt;return t>=se.maxTextures&&console.warn("WebGLRenderer: trying to use "+t+" texture units while this GPU supports only "+se.maxTextures),Bt+=1,t}function pt(t){var e;if(t===r.x)return re.REPEAT;if(t===r.y)return re.CLAMP_TO_EDGE;if(t===r.z)return re.MIRRORED_REPEAT;if(t===r.A)return re.NEAREST;if(t===r.B)return re.NEAREST_MIPMAP_NEAREST;if(t===r.C)return re.NEAREST_MIPMAP_LINEAR;if(t===r.D)return re.LINEAR;if(t===r.E)return re.LINEAR_MIPMAP_NEAREST;if(t===r.F)return re.LINEAR_MIPMAP_LINEAR;if(t===r.v)return re.UNSIGNED_BYTE;if(t===r.G)return re.UNSIGNED_SHORT_4_4_4_4;if(t===r.H)return re.UNSIGNED_SHORT_5_5_5_1;if(t===r.I)return re.UNSIGNED_SHORT_5_6_5;if(t===r.J)return re.BYTE;if(t===r.K)return re.SHORT;if(t===r.L)return re.UNSIGNED_SHORT;if(t===r.M)return re.INT;if(t===r.N)return re.UNSIGNED_INT;if(t===r.t)return re.FLOAT;if(t===r.w&&null!==(e=ae.get("OES_texture_half_float")))return e.HALF_FLOAT_OES;if(t===r.O)return re.ALPHA;if(t===r.P)return re.RGB;if(t===r.s)return re.RGBA;if(t===r.Q)return re.LUMINANCE;if(t===r.R)return re.LUMINANCE_ALPHA;if(t===r.S)return re.DEPTH_COMPONENT;if(t===r.T)return re.DEPTH_STENCIL;if(t===r.i)return re.FUNC_ADD;if(t===r.U)return re.FUNC_SUBTRACT;if(t===r.V)return re.FUNC_REVERSE_SUBTRACT;if(t===r.W)return re.ZERO;if(t===r.X)return re.ONE;if(t===r.Y)return re.SRC_COLOR;if(t===r.Z)return re.ONE_MINUS_SRC_COLOR;if(t===r.g)return re.SRC_ALPHA;if(t===r.h)return re.ONE_MINUS_SRC_ALPHA;if(t===r._0)return re.DST_ALPHA;if(t===r._1)return re.ONE_MINUS_DST_ALPHA;if(t===r._2)return re.DST_COLOR;if(t===r._3)return re.ONE_MINUS_DST_COLOR;if(t===r._4)return re.SRC_ALPHA_SATURATE;if((t===r._5||t===r._6||t===r._7||t===r._8)&&null!==(e=ae.get("WEBGL_compressed_texture_s3tc"))){if(t===r._5)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===r._6)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===r._7)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===r._8)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((t===r._9||t===r._10||t===r._11||t===r._12)&&null!==(e=ae.get("WEBGL_compressed_texture_pvrtc"))){if(t===r._9)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===r._10)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===r._11)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===r._12)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(t===r._13&&null!==(e=ae.get("WEBGL_compressed_texture_etc1")))return e.COMPRESSED_RGB_ETC1_WEBGL;if((t===r._14||t===r._15)&&null!==(e=ae.get("EXT_blend_minmax"))){if(t===r._14)return e.MIN_EXT;if(t===r._15)return e.MAX_EXT}return t===r._16&&null!==(e=ae.get("WEBGL_depth_texture"))?e.UNSIGNED_INT_24_8_WEBGL:0}console.log("THREE.WebGLRenderer",r.n),t=t||{};var mt=void 0!==t.canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),vt=void 0!==t.context?t.context:null,gt=void 0!==t.alpha&&t.alpha,yt=void 0===t.depth||t.depth,_t=void 0===t.stencil||t.stencil,xt=void 0!==t.antialias&&t.antialias,bt=void 0===t.premultipliedAlpha||t.premultipliedAlpha,wt=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,Et=[],Pt=null,Mt=new Float32Array(8),St=[],Tt=[];this.domElement=mt,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=r.o,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var Ct=this,Lt=null,At=null,It=null,Nt=-1,Rt="",Dt=null,Ot=new z.a,Ut=null,Ft=new z.a,Bt=0,zt=new X.a(0),Xt=0,kt=mt.width,Gt=mt.height,Vt=1,Yt=new z.a(0,0,kt,Gt),Ht=!1,Wt=new z.a(0,0,kt,Gt),jt=new B.a,qt=new F.a,Jt=!1,Zt=!1,Qt=new a.a,Kt=new U.a,$t=new a.a,te=new a.a,ee={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[]},ne={geometries:0,textures:0},ie={frame:0,calls:0,vertices:0,faces:0,points:0};this.info={render:ie,memory:ne,programs:null};var re;try{var oe={alpha:gt,depth:yt,stencil:_t,antialias:xt,premultipliedAlpha:bt,preserveDrawingBuffer:wt};if(null===(re=vt||mt.getContext("webgl",oe)||mt.getContext("experimental-webgl",oe)))throw null!==mt.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";void 0===re.getShaderPrecisionFormat&&(re.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),mt.addEventListener("webglcontextlost",k,!1)}catch(t){console.error("THREE.WebGLRenderer: "+t)}var ae=new O.a(re);ae.get("WEBGL_depth_texture"),ae.get("OES_texture_float"),ae.get("OES_texture_float_linear"),ae.get("OES_texture_half_float"),ae.get("OES_texture_half_float_linear"),ae.get("OES_standard_derivatives"),ae.get("ANGLE_instanced_arrays"),ae.get("OES_element_index_uint")&&(D.a.MaxIndex=4294967296);var se=new R.a(re,ae,t),le=new N.a(re,ae,pt),ue=new I.a,he=new A.a(re,ae,le,ue,se,pt,ne),ce=new w.a(re),de=new S.a(re,ce,ne),fe=new C.a(re,de,ie),pe=new L.a(this,se),me=new T.a,ve=new E.a;this.info.programs=pe.programs;var ge,ye,_e,xe,be=new M.a(re,ae,ie),we=new P.a(re,ae,ie);n(),this.context=re,this.capabilities=se,this.extensions=ae,this.properties=ue,this.state=le;var Ee=new p.a(this,ee,fe,se);this.shadowMap=Ee;var Pe=new f.a(this,St),Me=new d.a(this,Tt);this.getContext=function(){return re},this.getContextAttributes=function(){return re.getContextAttributes()},this.forceContextLoss=function(){var t=ae.get("WEBGL_lose_context");t&&t.loseContext()},this.getMaxAnisotropy=function(){return se.getMaxAnisotropy()},this.getPrecision=function(){return se.precision},this.getPixelRatio=function(){return Vt},this.setPixelRatio=function(t){void 0!==t&&(Vt=t,this.setSize(Wt.z,Wt.w,!1))},this.getSize=function(){return{width:kt,height:Gt}},this.setSize=function(t,e,n){kt=t,Gt=e,mt.width=t*Vt,mt.height=e*Vt,!1!==n&&(mt.style.width=t+"px",mt.style.height=e+"px"),this.setViewport(0,0,t,e)},this.setViewport=function(t,e,n,i){le.viewport(Wt.set(t,e,n,i))},this.setScissor=function(t,e,n,i){le.scissor(Yt.set(t,e,n,i))},this.setScissorTest=function(t){le.setScissorTest(Ht=t)},this.getClearColor=function(){return zt},this.setClearColor=function(t,e){zt.set(t),Xt=void 0!==e?e:1,le.buffers.color.setClear(zt.r,zt.g,zt.b,Xt,bt)},this.getClearAlpha=function(){return Xt},this.setClearAlpha=function(t){Xt=t,le.buffers.color.setClear(zt.r,zt.g,zt.b,Xt,bt)},this.clear=function(t,e,n){var i=0;(void 0===t||t)&&(i|=re.COLOR_BUFFER_BIT),(void 0===e||e)&&(i|=re.DEPTH_BUFFER_BIT),(void 0===n||n)&&(i|=re.STENCIL_BUFFER_BIT),re.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,n,i){this.setRenderTarget(t),this.clear(e,n,i)},this.resetGLState=i,this.dispose=function(){mt.removeEventListener("webglcontextlost",k,!1),ve.dispose()},this.renderBufferImmediate=function(t,e,n){le.initAttributes();var i=ue.get(t);t.hasPositions&&!i.position&&(i.position=re.createBuffer()),t.hasNormals&&!i.normal&&(i.normal=re.createBuffer()),t.hasUvs&&!i.uv&&(i.uv=re.createBuffer()),t.hasColors&&!i.color&&(i.color=re.createBuffer());var o=e.getAttributes();if(t.hasPositions&&(re.bindBuffer(re.ARRAY_BUFFER,i.position),re.bufferData(re.ARRAY_BUFFER,t.positionArray,re.DYNAMIC_DRAW),le.enableAttribute(o.position),re.vertexAttribPointer(o.position,3,re.FLOAT,!1,0,0)),t.hasNormals){if(re.bindBuffer(re.ARRAY_BUFFER,i.normal),!n.isMeshPhongMaterial&&!n.isMeshStandardMaterial&&!n.isMeshNormalMaterial&&n.shading===r.p)for(var a=0,s=3*t.count;a<s;a+=9){var l=t.normalArray,u=(l[a+0]+l[a+3]+l[a+6])/3,h=(l[a+1]+l[a+4]+l[a+7])/3,c=(l[a+2]+l[a+5]+l[a+8])/3;l[a+0]=u,l[a+1]=h,l[a+2]=c,l[a+3]=u,l[a+4]=h,l[a+5]=c,l[a+6]=u,l[a+7]=h,l[a+8]=c}re.bufferData(re.ARRAY_BUFFER,t.normalArray,re.DYNAMIC_DRAW),le.enableAttribute(o.normal),re.vertexAttribPointer(o.normal,3,re.FLOAT,!1,0,0)}t.hasUvs&&n.map&&(re.bindBuffer(re.ARRAY_BUFFER,i.uv),re.bufferData(re.ARRAY_BUFFER,t.uvArray,re.DYNAMIC_DRAW),le.enableAttribute(o.uv),re.vertexAttribPointer(ce.uv,2,re.FLOAT,!1,0,0)),t.hasColors&&n.vertexColors!==r.f&&(re.bindBuffer(re.ARRAY_BUFFER,i.color),re.bufferData(re.ARRAY_BUFFER,t.colorArray,re.DYNAMIC_DRAW),le.enableAttribute(o.color),re.vertexAttribPointer(o.color,3,re.FLOAT,!1,0,0)),le.disableUnusedAttributes(),re.drawArrays(re.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,n,i,o,a,s){le.setMaterial(o);var l=K(t,n,o,a),u=i.id+"_"+l.id+"_"+(!0===o.wireframe),h=!1;u!==Rt&&(Rt=u,h=!0);var c=a.morphTargetInfluences;if(void 0!==c){for(var d=[],f=0,p=c.length;f<p;f++){var m=c[f];d.push([m,f])}d.sort(W),d.length>8&&(d.length=8);for(var v=i.morphAttributes,f=0,p=d.length;f<p;f++){var m=d[f];if(Mt[f]=m[0],0!==m[0]){var g=m[1];!0===o.morphTargets&&v.position&&i.addAttribute("morphTarget"+f,v.position[g]),!0===o.morphNormals&&v.normal&&i.addAttribute("morphNormal"+f,v.normal[g])}else!0===o.morphTargets&&i.removeAttribute("morphTarget"+f),!0===o.morphNormals&&i.removeAttribute("morphNormal"+f)}for(var f=d.length,y=Mt.length;f<y;f++)Mt[f]=0;l.getUniforms().setValue(re,"morphTargetInfluences",Mt),h=!0}var g=i.index,_=i.attributes.position,x=1;!0===o.wireframe&&(g=de.getWireframeAttribute(i),x=2);var b=be;null!==g&&(b=we,b.setIndex(g)),h&&(j(o,l,i),null!==g&&re.bindBuffer(re.ELEMENT_ARRAY_BUFFER,ce.get(g).buffer));var w=0;null!==g?w=g.count:void 0!==_&&(w=_.count);var E=i.drawRange.start*x,P=i.drawRange.count*x,M=null!==s?s.start*x:0,S=null!==s?s.count*x:1/0,T=Math.max(E,M),C=Math.min(w,E+P,M+S)-1,L=Math.max(0,C-T+1);if(0!==L){if(a.isMesh)if(!0===o.wireframe)le.setLineWidth(o.wireframeLinewidth*e()),b.setMode(re.LINES);else switch(a.drawMode){case r.k:b.setMode(re.TRIANGLES);break;case r.q:b.setMode(re.TRIANGLE_STRIP);break;case r.r:b.setMode(re.TRIANGLE_FAN)}else if(a.isLine){var A=o.linewidth;void 0===A&&(A=1),le.setLineWidth(A*e()),a.isLineSegments?b.setMode(re.LINES):a.isLineLoop?b.setMode(re.LINE_LOOP):b.setMode(re.LINE_STRIP)}else a.isPoints&&b.setMode(re.POINTS);i&&i.isInstancedBufferGeometry?i.maxInstancedCount>0&&b.renderInstances(i,T,L):b.render(T,L)}},this.compile=function(t,e){Et=[],t.traverse(function(t){t.isLight&&Et.push(t)}),dt(Et,e),t.traverse(function(e){if(e.material)if(Array.isArray(e.material))for(var n=0;n<e.material.length;n++)Q(e.material[n],t.fog,e);else Q(e.material,t.fog,e)})},this.render=function(t,e,n,i){if(void 0!==e&&!0!==e.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");Rt="",Nt=-1,Dt=null,!0===t.autoUpdate&&t.updateMatrixWorld(),e.onBeforeRender(Ct),null===e.parent&&e.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld),Qt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),jt.setFromMatrix(Qt),Et.length=0,St.length=0,Tt.length=0,Zt=this.localClippingEnabled,Jt=qt.init(this.clippingPlanes,Zt,e),Pt=ve.get(t,e),Pt.init(),q(t,e,Ct.sortObjects),Pt.finish(),!0===Ct.sortObjects&&Pt.sort(),Jt&&qt.beginShadows(),ct(Et),Ee.render(t,e),dt(Et,e),Jt&&qt.endShadows(),ie.frame++,ie.calls=0,ie.vertices=0,ie.faces=0,ie.points=0,void 0===n&&(n=null),this.setRenderTarget(n);var o=t.background;null===o?le.buffers.color.setClear(zt.r,zt.g,zt.b,Xt,bt):o&&o.isColor&&(le.buffers.color.setClear(o.r,o.g,o.b,1,bt),i=!0),(this.autoClear||i)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),o&&o.isCubeTexture?(void 0===_e&&(_e=new x.a,xe=new v.a(new g.a(5,5,5),new m.a({uniforms:c.a.cube.uniforms,vertexShader:c.a.cube.vertexShader,fragmentShader:c.a.cube.fragmentShader,side:r.l,depthTest:!1,depthWrite:!1,fog:!1}))),_e.projectionMatrix.copy(e.projectionMatrix),_e.matrixWorld.extractRotation(e.matrixWorld),_e.matrixWorldInverse.getInverse(_e.matrixWorld),xe.material.uniforms.tCube.value=o,xe.modelViewMatrix.multiplyMatrices(_e.matrixWorldInverse,xe.matrixWorld),fe.update(xe),Ct.renderBufferDirect(_e,null,xe.geometry,xe.material,xe,null)):o&&o.isTexture&&(void 0===ge&&(ge=new b.a(-1,1,1,-1,0,1),ye=new v.a(new y.b(2,2),new _.a({depthTest:!1,depthWrite:!1,fog:!1}))),ye.material.map=o,fe.update(ye),Ct.renderBufferDirect(ge,null,ye.geometry,ye.material,ye,null));var a=Pt.opaque,s=Pt.transparent;if(t.overrideMaterial){var l=t.overrideMaterial;a.length&&J(a,t,e,l),s.length&&J(s,t,e,l)}else a.length&&J(a,t,e),s.length&&J(s,t,e);Pe.render(t,e),Me.render(t,e,Ft),n&&he.updateRenderTargetMipmap(n),le.buffers.depth.setTest(!0),le.buffers.depth.setMask(!0),le.buffers.color.setMask(!0),e.isArrayCamera&&e.enabled&&Ct.setScissorTest(!1),e.onAfterRender(Ct)},this.setFaceCulling=function(t,e){le.setCullFace(t),le.setFlipSided(e===r.u)},this.allocTextureUnit=ft,this.setTexture2D=function(){var t=!1;return function(e,n){e&&e.isWebGLRenderTarget&&(t||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),he.setTexture2D(e,n)}}(),this.setTexture=function(){var t=!1;return function(e,n){t||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),t=!0),he.setTexture2D(e,n)}}(),this.setTextureCube=function(){var t=!1;return function(e,n){e&&e.isWebGLRenderTargetCube&&(t||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?he.setTextureCube(e,n):he.setTextureCubeDynamic(e,n)}}(),this.getRenderTarget=function(){return At},this.setRenderTarget=function(t){At=t,t&&void 0===ue.get(t).__webglFramebuffer&&he.setupRenderTarget(t);var e,n=t&&t.isWebGLRenderTargetCube;if(t){var i=ue.get(t);e=n?i.__webglFramebuffer[t.activeCubeFace]:i.__webglFramebuffer,Ot.copy(t.scissor),Ut=t.scissorTest,Ft.copy(t.viewport)}else e=null,Ot.copy(Yt).multiplyScalar(Vt),Ut=Ht,Ft.copy(Wt).multiplyScalar(Vt);if(It!==e&&(re.bindFramebuffer(re.FRAMEBUFFER,e),It=e),le.scissor(Ot),le.setScissorTest(Ut),le.viewport(Ft),n){var r=ue.get(t.texture);re.framebufferTexture2D(re.FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,r.__webglTexture,t.activeMipMapLevel)}},this.readRenderTargetPixels=function(t,e,n,i,o,a){if(!1===(t&&t.isWebGLRenderTarget))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");var s=ue.get(t).__webglFramebuffer;if(s){var l=!1;s!==It&&(re.bindFramebuffer(re.FRAMEBUFFER,s),l=!0);try{var u=t.texture,h=u.format,c=u.type;if(h!==r.s&&pt(h)!==re.getParameter(re.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(c===r.v||pt(c)===re.getParameter(re.IMPLEMENTATION_COLOR_READ_TYPE)||c===r.t&&(ae.get("OES_texture_float")||ae.get("WEBGL_color_buffer_float"))||c===r.w&&ae.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");re.checkFramebufferStatus(re.FRAMEBUFFER)===re.FRAMEBUFFER_COMPLETE?e>=0&&e<=t.width-i&&n>=0&&n<=t.height-o&&re.readPixels(e,n,i,o,pt(h),pt(c),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{l&&re.bindFramebuffer(re.FRAMEBUFFER,It)}}}}n.d(e,"a",function(){return i});var r=n(1),o=n(2),a=n(5),s=n(40),l=n(39),u=n(38),h=n(16),c=n(37),d=n(209),f=n(210),p=n(206),m=n(31),v=n(35),g=n(176),y=n(28),_=n(30),x=n(17),b=n(173),w=n(192),E=n(204),P=n(198),M=n(193),S=n(197),T=n(199),C=n(200),L=n(202),A=n(208),I=n(203),N=n(207),R=n(194),D=n(7),O=n(196),U=n(0),F=n(195),B=n(32),z=n(11),X=n(3)},function(t,e,n){"use strict";function i(t){function e(e,n){var i=e.array,r=e.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW,o=t.createBuffer();t.bindBuffer(n,o),t.bufferData(n,i,r),e.onUploadCallback();var a=t.FLOAT;return i instanceof Float32Array?a=t.FLOAT:i instanceof Float64Array?console.warn("Unsupported data buffer format: Float64Array"):i instanceof Uint16Array?a=t.UNSIGNED_SHORT:i instanceof Int16Array?a=t.SHORT:i instanceof Uint32Array?a=t.UNSIGNED_INT:i instanceof Int32Array?a=t.INT:i instanceof Int8Array?a=t.BYTE:i instanceof Uint8Array&&(a=t.UNSIGNED_BYTE),{buffer:o,type:a,bytesPerElement:i.BYTES_PER_ELEMENT,version:e.version}}function n(e,n,i){var r=n.array,o=n.updateRange;t.bindBuffer(i,e),!1===n.dynamic?t.bufferData(i,r,t.STATIC_DRAW):-1===o.count?t.bufferSubData(i,0,r):0===o.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(i,o.offset*r.BYTES_PER_ELEMENT,r.subarray(o.offset,o.offset+o.count)),o.count=0)}function i(t){return t.isInterleavedBufferAttribute&&(t=t.data),a[t.uuid]}function r(e){var n=a[e.uuid];n&&(t.deleteBuffer(n.buffer),delete a[e.uuid])}function o(t,i){t.isInterleavedBufferAttribute&&(t=t.data);var r=a[t.uuid];void 0===r?a[t.uuid]=e(t,i):r.version<t.version&&(n(r.buffer,t,i),r.version=t.version)}var a={};return{get:i,remove:r,update:o}}n.d(e,"a",function(){return i})},function(t,e,n){"use strict";function i(t,e,n){function i(t){a=t}function r(e,i){t.drawArrays(a,e,i),n.calls++,n.vertices+=i,a===t.TRIANGLES&&(n.faces+=i/3)}function o(i,r,o){var s=e.get("ANGLE_instanced_arrays");if(null===s)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");var l=i.attributes.position;l.isInterleavedBufferAttribute?(o=l.data.count,s.drawArraysInstancedANGLE(a,0,o,i.maxInstancedCount)):s.drawArraysInstancedANGLE(a,r,o,i.maxInstancedCount),n.calls++,n.vertices+=o*i.maxInstancedCount,a===t.TRIANGLES&&(n.faces+=i.maxInstancedCount*o/3)}var a;this.setMode=i,this.render=r,this.renderInstances=o}n.d(e,"a",function(){return i})},function(t,e,n){"use strict";function i(t,e,n){function i(){if(void 0!==o)return o;var n=e.get("EXT_texture_filter_anisotropic");return o=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function r(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var o,a=void 0!==n.precision?n.precision:"highp",s=r(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var l=!0===n.logarithmicDepthBuffer&&!!e.get("EXT_frag_depth"),u=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),h=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),c=t.getParameter(t.MAX_TEXTURE_SIZE),d=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),f=t.getParameter(t.MAX_VERTEX_ATTRIBS),p=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),m=t.getParameter(t.MAX_VARYING_VECTORS),v=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),g=h>0,y=!!e.get("OES_texture_float");return{getMaxAnisotropy:i,getMaxPrecision:r,precision:a,logarithmicDepthBuffer:l,maxTextures:u,maxVertexTextures:h,maxTextureSize:c,maxCubemapSize:d,maxAttributes:f,maxVertexUniforms:p,maxVaryings:m,maxFragmentUniforms:v,vertexTextures:g,floatFragmentTextures:y,floatVertexTextures:g&&y}}n.d(e,"a",function(){return i})},function(t,e,n){"use strict";function i(){function t(){c.value!==i&&(c.value=i,c.needsUpdate=a>0),n.numPlanes=a,n.numIntersection=0}function e(t,e,i,r){var o=null!==t?t.length:0,a=null;if(0!==o){if(a=c.value,!0!==r||null===a){var s=i+4*o,l=e.matrixWorldInverse;h.getNormalMatrix(l),(null===a||a.length<s)&&(a=new Float32Array(s));for(var d=0,f=i;d!==o;++d,f+=4)u.copy(t[d]).applyMatrix4(l,h),u.normal.toArray(a,f),a[f+3]=u.constant}c.value=a,c.needsUpdate=!0}return n.numPlanes=o,a}var n=this,i=null,a=0,s=!1,l=!1,u=new o.a,h=new r.a,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(t,n,r){var o=0!==t.length||n||0!==a||s;return s=n,i=e(t,r,0),a=t.length,o},this.beginShadows=function(){l=!0,e(null)},this.endShadows=function(){l=!1,t()},this.setState=function(n,r,o,u,h,d){if(!s||null===n||0===n.length||l&&!o)l?e(null):t();else{var f=l?0:a,p=4*f,m=h.clippingState||null;c.value=m,m=e(n,u,p,d);for(var v=0;v!==p;++v)m[v]=i[v];h.clippingState=m,this.numIntersection=r?this.numPlanes:0,this.numPlanes+=f}}}n.d(e,"a",function(){return i});var r=n(13),o=n(20)},function(t,e,n){"use strict";function i(t){var e={};return{get:function(n){if(void 0!==e[n])return e[n];var i;switch(n){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":i=t.getExtension("WEBGL_compressed_texture_etc1");break;default:i=t.getExtension(n)}return null===i&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=i,i}}}n.d(e,"a",function(){return i})},function(t,e,n){"use strict";function i(t,e,i){function s(t){var n=t.target,r=c[n.id];null!==r.index&&e.remove(r.index);for(var o in r.attributes)e.remove(r.attributes[o]);n.removeEventListener("dispose",s),delete c[n.id];var a=d[n.id];a&&(e.remove(a),delete d[n.id]),a=d[r.id],a&&(e.remove(a),delete d[r.id]),i.geometries--}function l(t,e){var n=c[e.id];return n||(e.addEventListener("dispose",s),e.isBufferGeometry?n=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new o.a).setFromObject(t)),n=e._bufferGeometry),c[e.id]=n,i.geometries++,n)}function u(n){var i=n.index,r=n.attributes;null!==i&&e.update(i,t.ELEMENT_ARRAY_BUFFER);for(var o in r)e.update(r[o],t.ARRAY_BUFFER);var a=n.morphAttributes;for(var o in a)for(var s=a[o],l=0,u=s.length;l<u;l++)e.update(s[l],t.ARRAY_BUFFER)}function h(i){var o=d[i.id];if(o)return o;var s=[],l=i.index,u=i.attributes;if(null!==l)for(var h=l.array,c=0,f=h.length;c<f;c+=3){var p=h[c+0],m=h[c+1],v=h[c+2];s.push(p,m,m,v,v,p)}else for(var h=u.position.array,c=0,f=h.length/3-1;c<f;c+=3){var p=c+0,m=c+1,v=c+2;s.push(p,m,m,v,v,p)}return o=new(n.i(a.a)(s)>65535?r.b:r.c)(s,1),e.update(o,t.ELEMENT_ARRAY_BUFFER),d[i.id]=o,o}var c={},d={};return{get:l,update:u,getWireframeAttribute:h}}n.d(e,"a",function(){return i});var r=n(12),o=n(7),a=n(41)},function(t,e,n){"use strict";function i(t,e,n){function i(t){s=t}function r(n){n.array instanceof Uint32Array&&e.get("OES_element_index_uint")?(l=t.UNSIGNED_INT,u=4):n.array instanceof Uint16Array?(l=t.UNSIGNED_SHORT,u=2):(l=t.UNSIGNED_BYTE,u=1)}function o(e,i){t.drawElements(s,i,l,e*u),n.calls++,n.vertices+=i,s===t.TRIANGLES&&(n.faces+=i/3)}function a(i,r,o){var a=e.get("ANGLE_instanced_arrays");if(null===a)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");a.drawElementsInstancedANGLE(s,o,l,r*u,i.maxInstancedCount),n.calls++,n.vertices+=o*i.maxInstancedCount,s===t.TRIANGLES&&(n.faces+=i.maxInstancedCount*o/3)}var s,l,u;this.setMode=i,this.setIndex=r,this.render=o,this.renderInstances=a}n.d(e,"a",function(){return i})},function(t,e,n){"use strict";function i(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new o.a,color:new r.a,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new a.a};break;case"SpotLight":n={position:new o.a,direction:new o.a,color:new r.a,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new a.a};break;case"PointLight":n={position:new o.a,color:new r.a,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new a.a};break;case"HemisphereLight":n={direction:new o.a,skyColor:new r.a,groundColor:new r.a};break;case"RectAreaLight":n={color:new r.a,position:new o.a,halfWidth:new o.a,halfHeight:new o.a}}return t[e.id]=n,n}}}n.d(e,"a",function(){return i});var r=n(3),o=n(0),a=n(4)},function(t,e,n){"use strict";function i(t,e,n){function i(t){var i=n.frame,r=t.geometry,a=e.get(t,r);return o[a.id]!==i&&(r.isGeometry&&a.updateFromObject(t),e.update(a),o[a.id]=i),a}function r(){o={}}var o={};return{update:i,clear:r}}n.d(e,"a",function(){return i})},function(t,e,n){"use strict";function i(t){switch(t){case y._17:return["Linear","( value )"];case y._26:return["sRGB","( value )"];case y._27:return["RGBE","( value )"];case y._28:return["RGBM","( value, 7.0 )"];case y._29:return["RGBM","( value, 16.0 )"];case y._30:return["RGBD","( value, 256.0 )"];case y._23:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}}function r(t,e){var n=i(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function o(t,e){var n=i(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function a(t,e){var n;switch(e){case y.o:n="Linear";break;case y._31:n="Reinhard";break;case y._32:n="Uncharted2";break;case y._33:n="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function s(t,e,n){return t=t||{},[t.derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(h).join("\n")}function l(t){var e=[];for(var n in t){var i=t[n];!1!==i&&e.push("#define "+n+" "+i)}return e.join("\n")}function u(t,e,n){for(var i={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),o=0;o<r;o++){var a=t.getActiveAttrib(e,o),s=a.name;i[s]=t.getAttribLocation(e,s)}return i}function h(t){return""!==t}function c(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function d(t){function e(t,e){var n=g.a[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return d(n)}var n=/^[ \t]*#include +<([\w\d.]+)>/gm;return t.replace(n,e)}function f(t){function e(t,e,n,i){for(var r="",o=parseInt(e);o<parseInt(n);o++)r+=i.replace(/\[ i \]/g,"[ "+o+" ]");return r}var n=/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;return t.replace(n,e)}function p(t,e,i,p){var x=t.context,b=i.extensions,w=i.defines,E=i.__webglShader.vertexShader,P=i.__webglShader.fragmentShader,M="SHADOWMAP_TYPE_BASIC";p.shadowMapType===y._21?M="SHADOWMAP_TYPE_PCF":p.shadowMapType===y._34&&(M="SHADOWMAP_TYPE_PCF_SOFT");var S="ENVMAP_TYPE_CUBE",T="ENVMAP_MODE_REFLECTION",C="ENVMAP_BLENDING_MULTIPLY";if(p.envMap){switch(i.envMap.mapping){case y._19:case y._35:S="ENVMAP_TYPE_CUBE";break;case y._24:case y._25:S="ENVMAP_TYPE_CUBE_UV";break;case y._36:case y._37:S="ENVMAP_TYPE_EQUIREC";break;case y._38:S="ENVMAP_TYPE_SPHERE"}switch(i.envMap.mapping){case y._35:case y._37:T="ENVMAP_MODE_REFRACTION"}switch(i.combine){case y.b:C="ENVMAP_BLENDING_MULTIPLY";break;case y._39:C="ENVMAP_BLENDING_MIX";break;case y._40:C="ENVMAP_BLENDING_ADD"}}var L,A,I=t.gammaFactor>0?t.gammaFactor:1,N=s(b,p,t.extensions),R=l(w),D=x.createProgram();i.isRawShaderMaterial?(L=[R,"\n"].filter(h).join("\n"),A=[N,R,"\n"].filter(h).join("\n")):(L=["precision "+p.precision+" float;","precision "+p.precision+" int;","#define SHADER_NAME "+i.__webglShader.name,R,p.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+I,"#define MAX_BONES "+p.maxBones,p.useFog&&p.fog?"#define USE_FOG":"",p.useFog&&p.fogExp?"#define FOG_EXP2":"",p.map?"#define USE_MAP":"",p.envMap?"#define USE_ENVMAP":"",p.envMap?"#define "+T:"",p.lightMap?"#define USE_LIGHTMAP":"",p.aoMap?"#define USE_AOMAP":"",p.emissiveMap?"#define USE_EMISSIVEMAP":"",p.bumpMap?"#define USE_BUMPMAP":"",p.normalMap?"#define USE_NORMALMAP":"",p.displacementMap&&p.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",p.specularMap?"#define USE_SPECULARMAP":"",p.roughnessMap?"#define USE_ROUGHNESSMAP":"",p.metalnessMap?"#define USE_METALNESSMAP":"",p.alphaMap?"#define USE_ALPHAMAP":"",p.vertexColors?"#define USE_COLOR":"",p.flatShading?"#define FLAT_SHADED":"",p.skinning?"#define USE_SKINNING":"",p.useVertexTexture?"#define BONE_TEXTURE":"",p.morphTargets?"#define USE_MORPHTARGETS":"",p.morphNormals&&!1===p.flatShading?"#define USE_MORPHNORMALS":"",p.doubleSided?"#define DOUBLE_SIDED":"",p.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+p.numClippingPlanes,p.shadowMapEnabled?"#define USE_SHADOWMAP":"",p.shadowMapEnabled?"#define "+M:"",p.sizeAttenuation?"#define USE_SIZEATTENUATION":"",p.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",p.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(h).join("\n"),A=[N,"precision "+p.precision+" float;","precision "+p.precision+" int;","#define SHADER_NAME "+i.__webglShader.name,R,p.alphaTest?"#define ALPHATEST "+p.alphaTest:"","#define GAMMA_FACTOR "+I,p.useFog&&p.fog?"#define USE_FOG":"",p.useFog&&p.fogExp?"#define FOG_EXP2":"",p.map?"#define USE_MAP":"",p.envMap?"#define USE_ENVMAP":"",p.envMap?"#define "+S:"",p.envMap?"#define "+T:"",p.envMap?"#define "+C:"",p.lightMap?"#define USE_LIGHTMAP":"",p.aoMap?"#define USE_AOMAP":"",p.emissiveMap?"#define USE_EMISSIVEMAP":"",p.bumpMap?"#define USE_BUMPMAP":"",p.normalMap?"#define USE_NORMALMAP":"",p.specularMap?"#define USE_SPECULARMAP":"",p.roughnessMap?"#define USE_ROUGHNESSMAP":"",p.metalnessMap?"#define USE_METALNESSMAP":"",p.alphaMap?"#define USE_ALPHAMAP":"",p.vertexColors?"#define USE_COLOR":"",p.gradientMap?"#define USE_GRADIENTMAP":"",p.flatShading?"#define FLAT_SHADED":"",p.doubleSided?"#define DOUBLE_SIDED":"",p.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+p.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(p.numClippingPlanes-p.numClipIntersection),p.shadowMapEnabled?"#define USE_SHADOWMAP":"",p.shadowMapEnabled?"#define "+M:"",p.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",p.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",p.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",p.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",p.envMap&&t.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",p.toneMapping!==y._41?"#define TONE_MAPPING":"",p.toneMapping!==y._41?g.a.tonemapping_pars_fragment:"",p.toneMapping!==y._41?a("toneMapping",p.toneMapping):"",p.dithering?"#define DITHERING":"",p.outputEncoding||p.mapEncoding||p.envMapEncoding||p.emissiveMapEncoding?g.a.encodings_pars_fragment:"",p.mapEncoding?r("mapTexelToLinear",p.mapEncoding):"",p.envMapEncoding?r("envMapTexelToLinear",p.envMapEncoding):"",p.emissiveMapEncoding?r("emissiveMapTexelToLinear",p.emissiveMapEncoding):"",p.outputEncoding?o("linearToOutputTexel",p.outputEncoding):"",p.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"","\n"].filter(h).join("\n")),E=d(E,p),E=c(E,p),P=d(P,p),P=c(P,p),i.isShaderMaterial||(E=f(E),P=f(P));var O=L+E,U=A+P,F=n.i(v.a)(x,x.VERTEX_SHADER,O),B=n.i(v.a)(x,x.FRAGMENT_SHADER,U);x.attachShader(D,F),x.attachShader(D,B),void 0!==i.index0AttributeName?x.bindAttribLocation(D,0,i.index0AttributeName):!0===p.morphTargets&&x.bindAttribLocation(D,0,"position"),x.linkProgram(D);var z=x.getProgramInfoLog(D),X=x.getShaderInfoLog(F),k=x.getShaderInfoLog(B),G=!0,V=!0;!1===x.getProgramParameter(D,x.LINK_STATUS)?(G=!1,console.error("THREE.WebGLProgram: shader error: ",x.getError(),"gl.VALIDATE_STATUS",x.getProgramParameter(D,x.VALIDATE_STATUS),"gl.getProgramInfoLog",z,X,k)):""!==z?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",z):""!==X&&""!==k||(V=!1),V&&(this.diagnostics={runnable:G,material:i,programLog:z,vertexShader:{log:X,prefix:L},fragmentShader:{log:k,prefix:A}}),x.deleteShader(F),x.deleteShader(B);var Y;this.getUniforms=function(){return void 0===Y&&(Y=new m.a(x,D,t)),Y};var H;return this.getAttributes=function(){return void 0===H&&(H=u(x,D)),H},this.destroy=function(){x.deleteProgram(D),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=_++,this.code=e,this.usedTimes=1,this.program=D,this.vertexShader=F,this.fragmentShader=B,this}n.d(e,"a",function(){return p});var m=n(39),v=n(205),g=n(36),y=n(1),_=0},function(t,e,n){"use strict";function i(t,e){function n(t){var n=t.skeleton,i=n.bones;if(e.floatVertexTextures)return 1024;var r=e.maxVertexUniforms,o=Math.floor((r-20)/4),a=Math.min(o,i.length);return a<i.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+i.length+" bones. This GPU supports "+a+"."),0):a}function i(t,e){var n;return t?t.isTexture?n=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=t.texture.encoding):n=r._17,n===r._17&&e&&(n=r._23),n}var a=[],s={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},l=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];this.getParameters=function(o,a,l,u,h,c){var d=s[o.type],f=c.isSkinnedMesh?n(c):0,p=t.getPrecision();null!==o.precision&&(p=e.getMaxPrecision(o.precision))!==o.precision&&console.warn("THREE.WebGLProgram.getParameters:",o.precision,"not supported, using",p,"instead.");var m=t.getRenderTarget();return{shaderID:d,precision:p,supportsVertexTextures:e.vertexTextures,outputEncoding:i(m?m.texture:null,t.gammaOutput),map:!!o.map,mapEncoding:i(o.map,t.gammaInput),envMap:!!o.envMap,envMapMode:o.envMap&&o.envMap.mapping,envMapEncoding:i(o.envMap,t.gammaInput),envMapCubeUV:!!o.envMap&&(o.envMap.mapping===r._24||o.envMap.mapping===r._25),lightMap:!!o.lightMap,aoMap:!!o.aoMap,emissiveMap:!!o.emissiveMap,emissiveMapEncoding:i(o.emissiveMap,t.gammaInput),bumpMap:!!o.bumpMap,normalMap:!!o.normalMap,displacementMap:!!o.displacementMap,roughnessMap:!!o.roughnessMap,metalnessMap:!!o.metalnessMap,specularMap:!!o.specularMap,alphaMap:!!o.alphaMap,gradientMap:!!o.gradientMap,combine:o.combine,vertexColors:o.vertexColors,fog:!!l,useFog:o.fog,fogExp:l&&l.isFogExp2,flatShading:o.shading===r.p,sizeAttenuation:o.sizeAttenuation,logarithmicDepthBuffer:e.logarithmicDepthBuffer,skinning:o.skinning&&f>0,maxBones:f,useVertexTexture:e.floatVertexTextures,morphTargets:o.morphTargets,morphNormals:o.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numClippingPlanes:u,numClipIntersection:h,dithering:o.dithering,shadowMapEnabled:t.shadowMap.enabled&&c.receiveShadow&&a.shadows.length>0,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:o.premultipliedAlpha,alphaTest:o.alphaTest,doubleSided:o.side===r.m,flipSided:o.side===r.l,depthPacking:void 0!==o.depthPacking&&o.depthPacking}},this.getProgramCode=function(t,e){var n=[];if(e.shaderID?n.push(e.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var i in t.defines)n.push(i),n.push(t.defines[i]);for(var r=0;r<l.length;r++)n.push(e[l[r]]);return n.join()},this.acquireProgram=function(e,n,i){for(var r,s=0,l=a.length;s<l;s++){var u=a[s];if(u.code===i){r=u,++r.usedTimes;break}}return void 0===r&&(r=new o.a(t,i,e,n),a.push(r)),r},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=a.indexOf(t);a[e]=a[a.length-1],a.pop(),t.destroy()}},this.programs=a}n.d(e,"a",function(){return i});var r=n(1),o=n(201)},function(t,e,n){"use strict";function i(){function t(t){var e=t.uuid,n=i[e];return void 0===n&&(n={},i[e]=n),n}function e(t){delete i[t.uuid]}function n(){i={}}var i={};return{get:t,remove:e,clear:n}}n.d(e,"a",function(){return i})},function(t,e,n){"use strict";function i(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program&&e.program&&t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function r(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function o(){function t(){s=-1,u=-1}function e(t,e,n,i,r){var o,h;n.transparent?(o=l,h=++u):(o=a,h=++s);var c=o[h];c?(c.id=t.id,c.object=t,c.geometry=e,c.material=n,c.program=n.program,c.renderOrder=t.renderOrder,c.z=i,c.group=r):(c={id:t.id,object:t,geometry:e,material:n,program:n.program,renderOrder:t.renderOrder,z:i,group:r},o.push(c))}function n(){a.length=s+1,l.length=u+1}function o(){a.sort(i),l.sort(r)}var a=[],s=-1,l=[],u=-1;return{opaque:a,transparent:l,init:t,push:e,finish:n,sort:o}}function a(){function t(t,e){var i=t.id+","+e.id,r=n[i];return void 0===r&&(r=new o,n[i]=r),r}function e(){n={}}var n={};return{get:t,dispose:e}}n.d(e,"a",function(){return a})},function(t,e,n){"use strict";function i(t){for(var e=t.split("\n"),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}function r(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),!1===t.getShaderParameter(r,t.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(r)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(r),i(n)),r}n.d(e,"a",function(){return r})},function(t,e,n){"use strict";function i(t,e,n,i){function m(e,n,i,o){var a=e.geometry,s=null,l=L,u=e.customDepthMaterial;if(i&&(l=A,u=e.customDistanceMaterial),u)s=u;else{var h=!1;n.morphTargets&&(a&&a.isBufferGeometry?h=a.morphAttributes&&a.morphAttributes.position&&a.morphAttributes.position.length>0:a&&a.isGeometry&&(h=a.morphTargets&&a.morphTargets.length>0)),e.isSkinnedMesh&&!1===n.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e);var c=e.isSkinnedMesh&&n.skinning,d=0;h&&(d|=S),c&&(d|=T),s=l[d]}if(t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var f=s.uuid,p=n.uuid,m=I[f];void 0===m&&(m={},I[f]=m);var v=m[p];void 0===v&&(v=s.clone(),m[p]=v),s=v}s.visible=n.visible,s.wireframe=n.wireframe;var g=n.side;return V.renderSingleSided&&g==r.m&&(g=r.d),V.renderReverseSided&&(g===r.d?g=r.l:g===r.l&&(g=r.d)),s.side=g,s.clipShadows=n.clipShadows,s.clippingPlanes=n.clippingPlanes,s.wireframeLinewidth=n.wireframeLinewidth,s.linewidth=n.linewidth,i&&void 0!==s.uniforms.lightPos&&s.uniforms.lightPos.value.copy(o),s}function v(e,i,r,o){if(!1!==e.visible){if(e.layers.test(i.layers)&&(e.isMesh||e.isLine||e.isPoints)&&e.castShadow&&(!e.frustumCulled||_.intersectsObject(e))){e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld);var a=n.update(e),s=e.material;if(Array.isArray(s))for(var l=a.groups,u=0,h=l.length;u<h;u++){var c=l[u],d=s[c.materialIndex];if(d&&d.visible){var f=m(e,d,o,M);t.renderBufferDirect(r,null,a,f,e,c)}}else if(s.visible){var f=m(e,s,o,M);t.renderBufferDirect(r,null,a,f,e,null)}}for(var p=e.children,g=0,y=p.length;g<y;g++)v(p[g],i,r,o)}}var g=t.context,y=t.state,_=new p.a,x=new f.a,b=e.shadows,w=new d.a,E=new d.a(i.maxTextureSize,i.maxTextureSize),P=new c.a,M=new c.a,S=1,T=2,C=1+(S|T),L=new Array(C),A=new Array(C),I={},N=[new c.a(1,0,0),new c.a(-1,0,0),new c.a(0,0,1),new c.a(0,0,-1),new c.a(0,1,0),new c.a(0,-1,0)],R=[new c.a(0,1,0),new c.a(0,1,0),new c.a(0,1,0),new c.a(0,1,0),new c.a(0,0,1),new c.a(0,0,-1)],D=[new h.a,new h.a,new h.a,new h.a,new h.a,new h.a],O=new u.a;O.depthPacking=r._20,O.clipping=!0;for(var U=l.a.distanceRGBA,F=s.a.clone(U.uniforms),B=0;B!==C;++B){var z=0!=(B&S),X=0!=(B&T),k=O.clone();k.morphTargets=z,k.skinning=X,L[B]=k;var G=new a.a({defines:{USE_SHADOWMAP:""},uniforms:F,vertexShader:U.vertexShader,fragmentShader:U.fragmentShader,morphTargets:z,skinning:X,clipping:!0});A[B]=G}var V=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=r._21,this.renderReverseSided=!0,this.renderSingleSided=!0,this.render=function(e,n){if(!1!==V.enabled&&(!1!==V.autoUpdate||!1!==V.needsUpdate)&&0!==b.length){y.disable(g.BLEND),y.buffers.color.setClear(1,1,1,1),y.buffers.depth.setTest(!0),y.setScissorTest(!1);for(var i,a,s=0,l=b.length;s<l;s++){var u=b[s],h=u.shadow;if(void 0!==h){var c=h.camera,d=h.matrix;if(M.setFromMatrixPosition(u.matrixWorld),c.position.copy(M),w.copy(h.mapSize),w.min(E),u&&u.isPointLight){i=6,a=!0;var f=w.x,p=w.y;D[0].set(2*f,p,f,p),D[1].set(0,p,f,p),D[2].set(3*f,p,f,p),D[3].set(f,p,f,p),D[4].set(3*f,0,f,p),D[5].set(f,0,f,p),w.x*=4,w.y*=2,d.makeTranslation(-M.x,-M.y,-M.z)}else i=1,a=!1,P.setFromMatrixPosition(u.target.matrixWorld),c.lookAt(P),c.updateMatrixWorld(),c.matrixWorldInverse.getInverse(c.matrixWorld),d.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),d.multiply(c.projectionMatrix),d.multiply(c.matrixWorldInverse);if(null===h.map){var m={minFilter:r.A,magFilter:r.A,format:r.s};h.map=new o.a(w.x,w.y,m),h.map.texture.name=u.name+".shadowMap",c.updateProjectionMatrix()}h.isSpotLightShadow&&h.update(u);var S=h.map;t.setRenderTarget(S),t.clear();for(var T=0;T<i;T++){if(a){P.copy(c.position),P.add(N[T]),c.up.copy(R[T]),c.lookAt(P),c.updateMatrixWorld(),c.matrixWorldInverse.getInverse(c.matrixWorld);var C=D[T];y.viewport(C)}x.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse),_.setFromMatrix(x),v(e,n,c,a)}}else console.warn("THREE.WebGLShadowMap:",u,"has no shadow.")}var L=t.getClearColor(),A=t.getClearAlpha();t.setClearColor(L,A),V.needsUpdate=!1}}}n.d(e,"a",function(){return i});var r=n(1),o=n(190),a=n(31),s=n(16),l=n(37),u=n(181),h=n(11),c=n(0),d=n(4),f=n(5),p=n(32)},function(t,e,n){"use strict";function i(t,e,n){function i(){var e=!1,n=new o.a,i=null,r=new o.a;return{setMask:function(n){i===n||e||(t.colorMask(n,n,n,n),i=n)},setLocked:function(t){e=t},setClear:function(e,i,o,a,s){!0===s&&(e*=a,i*=a,o*=a),n.set(e,i,o,a),!1===r.equals(n)&&(t.clearColor(e,i,o,a),r.copy(n))},reset:function(){e=!1,i=null,r.set(0,0,0,1)}}}function a(){var e=!1,n=null,i=null,o=null;return{setTest:function(e){e?p(t.DEPTH_TEST):m(t.DEPTH_TEST)},setMask:function(i){n===i||e||(t.depthMask(i),n=i)},setFunc:function(e){if(i!==e){if(e)switch(e){case r._42:t.depthFunc(t.NEVER);break;case r._43:t.depthFunc(t.ALWAYS);break;case r._44:t.depthFunc(t.LESS);break;case r.j:t.depthFunc(t.LEQUAL);break;case r._45:t.depthFunc(t.EQUAL);break;case r._46:t.depthFunc(t.GEQUAL);break;case r._47:t.depthFunc(t.GREATER);break;case r._48:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);i=e}},setLocked:function(t){e=t},setClear:function(e){o!==e&&(t.clearDepth(e),o=e)},reset:function(){e=!1,n=null,i=null,o=null}}}function s(){var e=!1,n=null,i=null,r=null,o=null,a=null,s=null,l=null,u=null;return{setTest:function(e){e?p(t.STENCIL_TEST):m(t.STENCIL_TEST)},setMask:function(i){n===i||e||(t.stencilMask(i),n=i)},setFunc:function(e,n,a){i===e&&r===n&&o===a||(t.stencilFunc(e,n,a),i=e,r=n,o=a)},setOp:function(e,n,i){a===e&&s===n&&l===i||(t.stencilOp(e,n,i),a=e,s=n,l=i)},setLocked:function(t){e=t},setClear:function(e){u!==e&&(t.clearStencil(e),u=e)},reset:function(){e=!1,n=null,i=null,r=null,o=null,a=null,s=null,l=null,u=null}}}function l(e,n,i){var r=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(var a=0;a<i;a++)t.texImage2D(n+a,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,r);return o}function u(){N.setClear(0,0,0,1),R.setClear(1),D.setClear(0),p(t.DEPTH_TEST),R.setFunc(r.j),_(!1),x(r._49),p(t.CULL_FACE),p(t.BLEND),g(r.c)}function h(){for(var t=0,e=U.length;t<e;t++)U[t]=0}function c(n){if(U[n]=1,0===F[n]&&(t.enableVertexAttribArray(n),F[n]=1),0!==B[n]){e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,0),B[n]=0}}function d(n,i){if(U[n]=1,0===F[n]&&(t.enableVertexAttribArray(n),F[n]=1),B[n]!==i){e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,i),B[n]=i}}function f(){for(var e=0,n=F.length;e!==n;++e)F[e]!==U[e]&&(t.disableVertexAttribArray(e),F[e]=0)}function p(e){!0!==z[e]&&(t.enable(e),z[e]=!0)}function m(e){!1!==z[e]&&(t.disable(e),z[e]=!1)}function v(){if(null===X&&(X=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")))for(var n=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),i=0;i<n.length;i++)X.push(n[i]);return X}function g(e,i,o,a,s,l,u,h){e!==r._50?p(t.BLEND):m(t.BLEND),e===k&&h===q||(e===r._51?h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE)):e===r._52?h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR)):e===r._53?h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR)):h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)),k=e,q=h),e===r._54?(s=s||i,l=l||o,u=u||a,i===G&&s===H||(t.blendEquationSeparate(n(i),n(s)),G=i,H=s),o===V&&a===Y&&l===W&&u===j||(t.blendFuncSeparate(n(o),n(a),n(l),n(u)),V=o,Y=a,W=l,j=u)):(G=null,V=null,Y=null,H=null,W=null,j=null)}function y(e){e.side===r.m?m(t.CULL_FACE):p(t.CULL_FACE),_(e.side===r.l),!0===e.transparent?g(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha):g(r._50),R.setFunc(e.depthFunc),R.setTest(e.depthTest),R.setMask(e.depthWrite),N.setMask(e.colorWrite),w(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)}function _(e){J!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),J=e)}function x(e){e!==r._55?(p(t.CULL_FACE),e!==Z&&(e===r._49?t.cullFace(t.BACK):e===r._56?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):m(t.CULL_FACE),Z=e}function b(e){e!==Q&&(it&&t.lineWidth(e),Q=e)}function w(e,n,i){e?(p(t.POLYGON_OFFSET_FILL),K===n&&$===i||(t.polygonOffset(n,i),K=n,$=i)):m(t.POLYGON_OFFSET_FILL)}function E(){return tt}function P(e){tt=e,e?p(t.SCISSOR_TEST):m(t.SCISSOR_TEST)}function M(e){void 0===e&&(e=t.TEXTURE0+et-1),rt!==e&&(t.activeTexture(e),rt=e)}function S(e,n){null===rt&&M();var i=ot[rt];void 0===i&&(i={type:void 0,texture:void 0},ot[rt]=i),i.type===e&&i.texture===n||(t.bindTexture(e,n||lt[e]),i.type=e,i.texture=n)}function T(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error(t)}}function C(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error(t)}}function L(e){!1===at.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),at.copy(e))}function A(e){!1===st.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),st.copy(e))}function I(){for(var e=0;e<F.length;e++)1===F[e]&&(t.disableVertexAttribArray(e),F[e]=0);z={},X=null,rt=null,ot={},k=null,J=null,Z=null,N.reset(),R.reset(),D.reset()}var N=new i,R=new a,D=new s,O=t.getParameter(t.MAX_VERTEX_ATTRIBS),U=new Uint8Array(O),F=new Uint8Array(O),B=new Uint8Array(O),z={},X=null,k=null,G=null,V=null,Y=null,H=null,W=null,j=null,q=!1,J=null,Z=null,Q=null,K=null,$=null,tt=null,et=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),nt=parseFloat(/^WebGL\ ([0-9])/.exec(t.getParameter(t.VERSION))[1]),it=parseFloat(nt)>=1,rt=null,ot={},at=new o.a,st=new o.a,lt={};return lt[t.TEXTURE_2D]=l(t.TEXTURE_2D,t.TEXTURE_2D,1),lt[t.TEXTURE_CUBE_MAP]=l(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),{buffers:{color:N,depth:R,stencil:D},init:u,initAttributes:h,enableAttribute:c,enableAttributeAndDivisor:d,disableUnusedAttributes:f,enable:p,disable:m,getCompressedTextureFormats:v,setBlending:g,setMaterial:y,setFlipSided:_,setCullFace:x,setLineWidth:b,setPolygonOffset:w,getScissorTest:E,setScissorTest:P,activeTexture:M,bindTexture:S,compressedTexImage2D:T,texImage2D:C,scissor:L,viewport:A,reset:I}}n.d(e,"a",function(){return i});var r=n(1),o=n(11)},function(t,e,n){"use strict";function i(t,e,n,i,a,s,l){function u(t,e){if(t.width>e||t.height>e){var n=e/Math.max(t.width,t.height),i=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");i.width=Math.floor(t.width*n),i.height=Math.floor(t.height*n);return i.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,i.width,i.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+i.width+"x"+i.height,t),i}return t}function h(t){return o.a.isPowerOfTwo(t.width)&&o.a.isPowerOfTwo(t.height)}function c(t){if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement){var e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");e.width=o.a.nearestPowerOfTwo(t.width),e.height=o.a.nearestPowerOfTwo(t.height);return e.getContext("2d").drawImage(t,0,0,e.width,e.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+t.width+"x"+t.height+"). Resized to "+e.width+"x"+e.height,t),e}return t}function d(t){return t.wrapS!==r.y||t.wrapT!==r.y||t.minFilter!==r.A&&t.minFilter!==r.D}function f(e){return e===r.A||e===r.B||e===r.C?t.NEAREST:t.LINEAR}function p(t){var e=t.target;e.removeEventListener("dispose",p),v(e),l.textures--}function m(t){var e=t.target;e.removeEventListener("dispose",m),g(e),l.textures--}function v(e){var n=i.get(e);if(e.image&&n.__image__webglTextureCube)t.deleteTexture(n.__image__webglTextureCube);else{if(void 0===n.__webglInit)return;t.deleteTexture(n.__webglTexture)}i.remove(e)}function g(e){var n=i.get(e),r=i.get(e.texture);if(e){if(void 0!==r.__webglTexture&&t.deleteTexture(r.__webglTexture),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLRenderTargetCube)for(var o=0;o<6;o++)t.deleteFramebuffer(n.__webglFramebuffer[o]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[o]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer);i.remove(e.texture),i.remove(e)}}function y(e,r){var o=i.get(e);if(e.version>0&&o.__version!==e.version){var a=e.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else{if(!1!==a.complete)return void w(o,e,r);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e)}}n.activeTexture(t.TEXTURE0+r),n.bindTexture(t.TEXTURE_2D,o.__webglTexture)}function _(e,o){var c=i.get(e);if(6===e.image.length)if(e.version>0&&c.__version!==e.version){c.__image__webglTextureCube||(e.addEventListener("dispose",p),c.__image__webglTextureCube=t.createTexture(),l.textures++),n.activeTexture(t.TEXTURE0+o),n.bindTexture(t.TEXTURE_CUBE_MAP,c.__image__webglTextureCube),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var d=e&&e.isCompressedTexture,f=e.image[0]&&e.image[0].isDataTexture,m=[],v=0;v<6;v++)m[v]=d||f?f?e.image[v].image:e.image[v]:u(e.image[v],a.maxCubemapSize);var g=m[0],y=h(g),_=s(e.format),x=s(e.type);b(t.TEXTURE_CUBE_MAP,e,y);for(var v=0;v<6;v++)if(d)for(var w,E=m[v].mipmaps,P=0,M=E.length;P<M;P++)w=E[P],e.format!==r.s&&e.format!==r.P?n.getCompressedTextureFormats().indexOf(_)>-1?n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,P,_,w.width,w.height,0,w.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,P,_,w.width,w.height,0,_,x,w.data);else f?n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,_,m[v].width,m[v].height,0,_,x,m[v].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,_,_,x,m[v]);e.generateMipmaps&&y&&t.generateMipmap(t.TEXTURE_CUBE_MAP),c.__version=e.version,e.onUpdate&&e.onUpdate(e)}else n.activeTexture(t.TEXTURE0+o),n.bindTexture(t.TEXTURE_CUBE_MAP,c.__image__webglTextureCube)}function x(e,r){n.activeTexture(t.TEXTURE0+r),n.bindTexture(t.TEXTURE_CUBE_MAP,i.get(e).__webglTexture)}function b(n,o,l){var u;if(l?(t.texParameteri(n,t.TEXTURE_WRAP_S,s(o.wrapS)),t.texParameteri(n,t.TEXTURE_WRAP_T,s(o.wrapT)),t.texParameteri(n,t.TEXTURE_MAG_FILTER,s(o.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,s(o.minFilter))):(t.texParameteri(n,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(n,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),o.wrapS===r.y&&o.wrapT===r.y||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",o),t.texParameteri(n,t.TEXTURE_MAG_FILTER,f(o.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,f(o.minFilter)),o.minFilter!==r.A&&o.minFilter!==r.D&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",o)),u=e.get("EXT_texture_filter_anisotropic")){if(o.type===r.t&&null===e.get("OES_texture_float_linear"))return;if(o.type===r.w&&null===e.get("OES_texture_half_float_linear"))return;(o.anisotropy>1||i.get(o).__currentAnisotropy)&&(t.texParameterf(n,u.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,a.getMaxAnisotropy())),i.get(o).__currentAnisotropy=o.anisotropy)}}function w(e,i,o){void 0===e.__webglInit&&(e.__webglInit=!0,i.addEventListener("dispose",p),e.__webglTexture=t.createTexture(),l.textures++),n.activeTexture(t.TEXTURE0+o),n.bindTexture(t.TEXTURE_2D,e.__webglTexture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,i.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,i.unpackAlignment);var f=u(i.image,a.maxTextureSize);d(i)&&!1===h(f)&&(f=c(f));var m=h(f),v=s(i.format),g=s(i.type);b(t.TEXTURE_2D,i,m);var y,_=i.mipmaps;if(i.isDepthTexture){var x=t.DEPTH_COMPONENT;if(i.type===r.t){if(!L)throw new Error("Float Depth Texture only supported in WebGL2.0");x=t.DEPTH_COMPONENT32F}else L&&(x=t.DEPTH_COMPONENT16);i.format===r.S&&x===t.DEPTH_COMPONENT&&i.type!==r.L&&i.type!==r.N&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=r.L,g=s(i.type)),i.format===r.T&&(x=t.DEPTH_STENCIL,i.type!==r._16&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=r._16,g=s(i.type))),n.texImage2D(t.TEXTURE_2D,0,x,f.width,f.height,0,v,g,null)}else if(i.isDataTexture)if(_.length>0&&m){for(var w=0,E=_.length;w<E;w++)y=_[w],n.texImage2D(t.TEXTURE_2D,w,v,y.width,y.height,0,v,g,y.data);i.generateMipmaps=!1}else n.texImage2D(t.TEXTURE_2D,0,v,f.width,f.height,0,v,g,f.data);else if(i.isCompressedTexture)for(var w=0,E=_.length;w<E;w++)y=_[w],i.format!==r.s&&i.format!==r.P?n.getCompressedTextureFormats().indexOf(v)>-1?n.compressedTexImage2D(t.TEXTURE_2D,w,v,y.width,y.height,0,y.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(t.TEXTURE_2D,w,v,y.width,y.height,0,v,g,y.data);else if(_.length>0&&m){for(var w=0,E=_.length;w<E;w++)y=_[w],n.texImage2D(t.TEXTURE_2D,w,v,v,g,y);i.generateMipmaps=!1}else n.texImage2D(t.TEXTURE_2D,0,v,v,g,f);i.generateMipmaps&&m&&t.generateMipmap(t.TEXTURE_2D),e.__version=i.version,i.onUpdate&&i.onUpdate(i)}function E(e,r,o,a){var l=s(r.texture.format),u=s(r.texture.type);n.texImage2D(a,0,l,r.width,r.height,0,l,u,null),t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,o,a,i.get(r.texture).__webglTexture,0),t.bindFramebuffer(t.FRAMEBUFFER,null)}function P(e,n){t.bindRenderbuffer(t.RENDERBUFFER,e),n.depthBuffer&&!n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)):n.depthBuffer&&n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)):t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,n.width,n.height),t.bindRenderbuffer(t.RENDERBUFFER,null)}function M(e,n){if(n&&n.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported!");if(t.bindFramebuffer(t.FRAMEBUFFER,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),y(n.depthTexture,0);var o=i.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===r.S)t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,o,0);else{if(n.depthTexture.format!==r.T)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,o,0)}}function S(e){var n=i.get(e),r=!0===e.isWebGLRenderTargetCube;if(e.depthTexture){if(r)throw new Error("target.depthTexture not supported in Cube render targets");M(n.__webglFramebuffer,e)}else if(r){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)t.bindFramebuffer(t.FRAMEBUFFER,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=t.createRenderbuffer(),P(n.__webglDepthbuffer[o],e)}else t.bindFramebuffer(t.FRAMEBUFFER,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),P(n.__webglDepthbuffer,e);t.bindFramebuffer(t.FRAMEBUFFER,null)}function T(e){var r=i.get(e),o=i.get(e.texture);e.addEventListener("dispose",m),o.__webglTexture=t.createTexture(),l.textures++;var a=!0===e.isWebGLRenderTargetCube,s=h(e);if(a){r.__webglFramebuffer=[];for(var u=0;u<6;u++)r.__webglFramebuffer[u]=t.createFramebuffer()}else r.__webglFramebuffer=t.createFramebuffer();if(a){n.bindTexture(t.TEXTURE_CUBE_MAP,o.__webglTexture),b(t.TEXTURE_CUBE_MAP,e.texture,s);for(var u=0;u<6;u++)E(r.__webglFramebuffer[u],e,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+u);e.texture.generateMipmaps&&s&&t.generateMipmap(t.TEXTURE_CUBE_MAP),n.bindTexture(t.TEXTURE_CUBE_MAP,null)}else n.bindTexture(t.TEXTURE_2D,o.__webglTexture),b(t.TEXTURE_2D,e.texture,s),E(r.__webglFramebuffer,e,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),e.texture.generateMipmaps&&s&&t.generateMipmap(t.TEXTURE_2D),n.bindTexture(t.TEXTURE_2D,null);e.depthBuffer&&S(e)}function C(e){var o=e.texture;if(o.generateMipmaps&&h(e)&&o.minFilter!==r.A&&o.minFilter!==r.D){var a=e&&e.isWebGLRenderTargetCube?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,s=i.get(o).__webglTexture;n.bindTexture(a,s),t.generateMipmap(a),n.bindTexture(a,null)}}var L="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext;this.setTexture2D=y,this.setTextureCube=_,this.setTextureCubeDynamic=x,this.setupRenderTarget=T,this.updateRenderTargetMipmap=C}n.d(e,"a",function(){return i});var r=n(1),o=n(2)},function(t,e,n){"use strict";function i(t,e){function n(){var t=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),e=new Uint16Array([0,1,2,0,2,3]);s=m.createBuffer(),l=m.createBuffer(),m.bindBuffer(m.ARRAY_BUFFER,s),m.bufferData(m.ARRAY_BUFFER,t,m.STATIC_DRAW),m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,l),m.bufferData(m.ELEMENT_ARRAY_BUFFER,e,m.STATIC_DRAW),f=m.createTexture(),p=m.createTexture(),v.bindTexture(m.TEXTURE_2D,f),m.texImage2D(m.TEXTURE_2D,0,m.RGB,16,16,0,m.RGB,m.UNSIGNED_BYTE,null),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.NEAREST),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.NEAREST),v.bindTexture(m.TEXTURE_2D,p),m.texImage2D(m.TEXTURE_2D,0,m.RGBA,16,16,0,m.RGBA,m.UNSIGNED_BYTE,null),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.NEAREST),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.NEAREST),u={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if ( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if ( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if ( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},h=i(u),c={vertex:m.getAttribLocation(h,"position"),uv:m.getAttribLocation(h,"uv")},d={renderType:m.getUniformLocation(h,"renderType"),map:m.getUniformLocation(h,"map"),occlusionMap:m.getUniformLocation(h,"occlusionMap"),opacity:m.getUniformLocation(h,"opacity"),color:m.getUniformLocation(h,"color"),scale:m.getUniformLocation(h,"scale"),rotation:m.getUniformLocation(h,"rotation"),screenPosition:m.getUniformLocation(h,"screenPosition")}}function i(e){var n=m.createProgram(),i=m.createShader(m.FRAGMENT_SHADER),r=m.createShader(m.VERTEX_SHADER),o="precision "+t.getPrecision()+" float;\n";return m.shaderSource(i,o+e.fragmentShader),m.shaderSource(r,o+e.vertexShader),m.compileShader(i),m.compileShader(r),m.attachShader(n,i),m.attachShader(n,r),m.linkProgram(n),n}var s,l,u,h,c,d,f,p,m=t.context,v=t.state;this.render=function(i,u,g){if(0!==e.length){var y=new a.a,_=g.w/g.z,x=.5*g.z,b=.5*g.w,w=16/g.w,E=new o.a(w*_,w),P=new a.a(1,1,0),M=new o.a(1,1),S=new r.a;S.min.set(g.x,g.y),S.max.set(g.x+(g.z-16),g.y+(g.w-16)),void 0===h&&n(),m.useProgram(h),v.initAttributes(),v.enableAttribute(c.vertex),v.enableAttribute(c.uv),v.disableUnusedAttributes(),m.uniform1i(d.occlusionMap,0),m.uniform1i(d.map,1),m.bindBuffer(m.ARRAY_BUFFER,s),m.vertexAttribPointer(c.vertex,2,m.FLOAT,!1,16,0),m.vertexAttribPointer(c.uv,2,m.FLOAT,!1,16,8),m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,l),v.disable(m.CULL_FACE),v.buffers.depth.setMask(!1);for(var T=0,C=e.length;T<C;T++){w=16/g.w,E.set(w*_,w);var L=e[T];if(y.set(L.matrixWorld.elements[12],L.matrixWorld.elements[13],L.matrixWorld.elements[14]),y.applyMatrix4(u.matrixWorldInverse),y.applyMatrix4(u.projectionMatrix),P.copy(y),M.x=g.x+P.x*x+x-8,M.y=g.y+P.y*b+b-8,!0===S.containsPoint(M)){v.activeTexture(m.TEXTURE0),v.bindTexture(m.TEXTURE_2D,null),v.activeTexture(m.TEXTURE1),v.bindTexture(m.TEXTURE_2D,f),m.copyTexImage2D(m.TEXTURE_2D,0,m.RGB,M.x,M.y,16,16,0),m.uniform1i(d.renderType,0),m.uniform2f(d.scale,E.x,E.y),m.uniform3f(d.screenPosition,P.x,P.y,P.z),v.disable(m.BLEND),v.enable(m.DEPTH_TEST),m.drawElements(m.TRIANGLES,6,m.UNSIGNED_SHORT,0),v.activeTexture(m.TEXTURE0),v.bindTexture(m.TEXTURE_2D,p),m.copyTexImage2D(m.TEXTURE_2D,0,m.RGBA,M.x,M.y,16,16,0),m.uniform1i(d.renderType,1),v.disable(m.DEPTH_TEST),v.activeTexture(m.TEXTURE1),v.bindTexture(m.TEXTURE_2D,f),m.drawElements(m.TRIANGLES,6,m.UNSIGNED_SHORT,0),L.positionScreen.copy(P),L.customUpdateCallback?L.customUpdateCallback(L):L.updateLensFlares(),m.uniform1i(d.renderType,2),v.enable(m.BLEND);for(var A=0,I=L.lensFlares.length;A<I;A++){var N=L.lensFlares[A];N.opacity>.001&&N.scale>.001&&(P.x=N.x,P.y=N.y,P.z=N.z,w=N.size*N.scale/g.w,E.x=w*_,E.y=w,m.uniform3f(d.screenPosition,P.x,P.y,P.z),m.uniform2f(d.scale,E.x,E.y),m.uniform1f(d.rotation,N.rotation),m.uniform1f(d.opacity,N.opacity),m.uniform3f(d.color,N.color.r,N.color.g,N.color.b),v.setBlending(N.blending,N.blendEquation,N.blendSrc,N.blendDst),t.setTexture2D(N.texture,1),m.drawElements(m.TRIANGLES,6,m.UNSIGNED_SHORT,0))}}}v.enable(m.CULL_FACE),v.enable(m.DEPTH_TEST),v.buffers.depth.setMask(!0),t.resetGLState()}}}n.d(e,"a",function(){return i});var r=n(184),o=n(4),a=n(0)},function(t,e,n){"use strict";function i(t,e){function n(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),e=new Uint16Array([0,1,2,0,2,3]);l=p.createBuffer(),u=p.createBuffer(),p.bindBuffer(p.ARRAY_BUFFER,l),p.bufferData(p.ARRAY_BUFFER,t,p.STATIC_DRAW),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,u),p.bufferData(p.ELEMENT_ARRAY_BUFFER,e,p.STATIC_DRAW),h=i(),c={position:p.getAttribLocation(h,"position"),uv:p.getAttribLocation(h,"uv")},d={uvOffset:p.getUniformLocation(h,"uvOffset"),uvScale:p.getUniformLocation(h,"uvScale"),rotation:p.getUniformLocation(h,"rotation"),scale:p.getUniformLocation(h,"scale"),color:p.getUniformLocation(h,"color"),map:p.getUniformLocation(h,"map"),opacity:p.getUniformLocation(h,"opacity"),modelViewMatrix:p.getUniformLocation(h,"modelViewMatrix"),projectionMatrix:p.getUniformLocation(h,"projectionMatrix"),fogType:p.getUniformLocation(h,"fogType"),fogDensity:p.getUniformLocation(h,"fogDensity"),fogNear:p.getUniformLocation(h,"fogNear"),fogFar:p.getUniformLocation(h,"fogFar"),fogColor:p.getUniformLocation(h,"fogColor"),alphaTest:p.getUniformLocation(h,"alphaTest")};var n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");n.width=8,n.height=8;var o=n.getContext("2d");o.fillStyle="white",o.fillRect(0,0,8,8),f=new r.a(n),f.needsUpdate=!0}function i(){var e=p.createProgram(),n=p.createShader(p.VERTEX_SHADER),i=p.createShader(p.FRAGMENT_SHADER);return p.shaderSource(n,["precision "+t.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),p.shaderSource(i,["precision "+t.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),p.compileShader(n),p.compileShader(i),p.attachShader(e,n),p.attachShader(e,i),p.linkProgram(e),e}function s(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}var l,u,h,c,d,f,p=t.context,m=t.state,v=new o.a,g=new a.a,y=new o.a;this.render=function(i,r){if(0!==e.length){void 0===h&&n(),p.useProgram(h),m.initAttributes(),m.enableAttribute(c.position),m.enableAttribute(c.uv),m.disableUnusedAttributes(),m.disable(p.CULL_FACE),m.enable(p.BLEND),p.bindBuffer(p.ARRAY_BUFFER,l),p.vertexAttribPointer(c.position,2,p.FLOAT,!1,16,0),p.vertexAttribPointer(c.uv,2,p.FLOAT,!1,16,8),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,u),p.uniformMatrix4fv(d.projectionMatrix,!1,r.projectionMatrix.elements),m.activeTexture(p.TEXTURE0),p.uniform1i(d.map,0);var o=0,a=0,_=i.fog;_?(p.uniform3f(d.fogColor,_.color.r,_.color.g,_.color.b),_.isFog?(p.uniform1f(d.fogNear,_.near),p.uniform1f(d.fogFar,_.far),p.uniform1i(d.fogType,1),o=1,a=1):_.isFogExp2&&(p.uniform1f(d.fogDensity,_.density),p.uniform1i(d.fogType,2),o=2,a=2)):(p.uniform1i(d.fogType,0),o=0,a=0);for(var x=0,b=e.length;x<b;x++){var w=e[x];w.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,w.matrixWorld),w.z=-w.modelViewMatrix.elements[14]}e.sort(s);for(var E=[],x=0,b=e.length;x<b;x++){var w=e[x],P=w.material;if(!1!==P.visible){p.uniform1f(d.alphaTest,P.alphaTest),p.uniformMatrix4fv(d.modelViewMatrix,!1,w.modelViewMatrix.elements),w.matrixWorld.decompose(v,g,y),E[0]=y.x,E[1]=y.y;var M=0;i.fog&&P.fog&&(M=a),o!==M&&(p.uniform1i(d.fogType,M),o=M),null!==P.map?(p.uniform2f(d.uvOffset,P.map.offset.x,P.map.offset.y),p.uniform2f(d.uvScale,P.map.repeat.x,P.map.repeat.y)):(p.uniform2f(d.uvOffset,0,0),p.uniform2f(d.uvScale,1,1)),p.uniform1f(d.opacity,P.opacity),p.uniform3f(d.color,P.color.r,P.color.g,P.color.b),p.uniform1f(d.rotation,P.rotation),p.uniform2fv(d.scale,E),m.setBlending(P.blending,P.blendEquation,P.blendSrc,P.blendDst),m.buffers.depth.setTest(P.depthTest),m.buffers.depth.setMask(P.depthWrite),P.map?t.setTexture2D(P.map,0):t.setTexture2D(f,0),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0)}}m.enable(p.CULL_FACE),t.resetGLState()}}}n.d(e,"a",function(){return i});var r=n(15),o=n(0),a=n(14)},function(t,e,n){"use strict";function i(){r.a.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}n.d(e,"a",function(){return i});var r=n(6);i.prototype=Object.assign(Object.create(r.a.prototype),{constructor:i,copy:function(t,e){return r.a.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=r.a.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}})},function(t,e,n){"use strict";function i(t,e,n,i,a,s,l,u,h,c){t=void 0!==t?t:[],e=void 0!==e?e:o._19,r.a.call(this,t,e,n,i,a,s,l,u,h,c),this.flipY=!1}n.d(e,"a",function(){return i});var r=n(15),o=n(1);i.prototype=Object.create(r.a.prototype),i.prototype.constructor=i,i.prototype.isCubeTexture=!0,Object.defineProperty(i.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}})},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n}]);